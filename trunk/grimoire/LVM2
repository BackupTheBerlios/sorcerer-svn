   VERSION=( "2.01.00" "2.00.33" "2.00.32" "2.00.31" )
  CATEGORY="disk"
 ATTRIBUTE="console"
    SOURCE="LVM2.$VERSION.tgz"
  HOMEPAGE="http://sources.redhat.com/lvm2"
       URL="ftp://sources.redhat.com/pub/lvm2"
       REQ="device-mapper"
  ESTIMATE="277"
      DESC="LVM2 is the userspace toolset that provide logical volume management."

build()  {
patch_source()  {
patch  -p1  <<  EOF
diff -r -U2 LVM2.2.00.32/lib/device/dev-io.c LVM2.2.00.32/lib/device/dev-io.c
--- LVM2.2.00.32/lib/device/dev-io.c	2004-12-21 13:23:16.000000000 -0700
+++ LVM2.2.00.32/lib/device/dev-io.c	2004-12-21 13:23:16.000000000 -0700
@@ -32,5 +32,10 @@
 #  undef WNOHANG		/* Avoid redefinition */
 #  undef WUNTRACED		/* Avoid redefinition */
+#  ifndef pgoff_t
+#    define pgoff_t unsigned long
+#  endif
+#  undef stack
 #  include <linux/fs.h>		/* For block ioctl definitions */
+#  define stack log_debug("<backtrace>")
 #  define BLKSIZE_SHIFT SECTOR_SHIFT
 #  ifndef BLKGETSIZE64		/* fs.h out-of-date */
EOF
}

local  LVER
LVER=$( installed_version  $( get_provider linux-kernel ) )
case  $LVER  in
  2.6.10)  patch_source  ;;
esac

default_build
}
