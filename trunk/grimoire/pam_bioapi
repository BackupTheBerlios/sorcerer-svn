   version stable 0.2.1
   require Linux-PAM tfmess_bioapi_bsp
  category security
 attribute console new
    source http://www.qrivy.net/~michael/blua/pam_bioapi/pam_bioapi-$VERSION.tar.bz2
      info home http://www.qrivy.net/~michael/blua/pam_bioapi/
      desc 'pam_bioapi provides PAM module for biometric authentication.
That way you can give you laptop the finger to login.
pam_bioapi currently only works for local user authentication,
the type that can be performed by login, gdm/kdm/xdm, xscreensaver,
su, and sudo.'

build(){

 install_serial(){
  SERIAL=`BioAPITest | sed -ne "/Fingerprint/{n;n;s/^.*: \(.\{9\}\)\(.\{4\}\)\(.\{4\}\)\(.\{4\}\)\(.*\)/\1-\2-\3-\4-\5/gp}"`
  mkdir -p $DESTDIR/etc/bioapi/pam/$SERIAL
  echo "Now run /usr/bin/upek-NonGUI_Sample and enroll <username>.bir and copy it to /etc/bioapi/pam/$SERIAL"
 }

 if   [[ $HOSTTYPE == x86_64 ]] && ! [[ $CFLAGS =~ -m32 ]]
 then opts --libdir=/usr/lib64
 else opts --libdir=/usr/lib
 fi

 default_build &&
 install_serial
}
