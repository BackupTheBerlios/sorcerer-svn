# New version available at:
# http://alioth.debian.org/frs/download.php/3315/lilo-23.0.tar.gz
# Will wait and see before trying it.

case $HOSTTYPE in
 x86_64)
 conflicts Dev86 ;;
esac

    stable 22.8
   require LVM2 bin86 nasm
  category administration/bootloader
 attribute console x86
    source http://home.san.rr.com/johninsd/pub/linux/lilo/ \
           http://www.ibiblio.org/pub/Linux/system/boot/lilo/ \
           lilo-$VERSION.src.tar.gz
  homepage http://home.san.rr.com/johninsd/pub/linux/lilo/
  homepage http://lilo.alioth.debian.org/
   protect /etc/lilo/head
   protect /etc/lilo/tail
  volatile /etc/lilo.conf

#  exclude /etc/lilo.conf
#  exclude /etc/lilo.conf.fast
#  exclude /etc/lilo.conf.head
#  exclude /etc/lilo.conf.tail
  estimate 200
      desc 'linux boot loader for x86 computers'

build(){
 configs_install(){
  mkdir   -pm 600 $DESTDIR/{etc/lilo,usr/sbin}
  install -m  600 $SCRIPT_DIR/head $DESTDIR/etc/lilo/
  install -m  600 $SCRIPT_DIR/tail $DESTDIR/etc/lilo/
  install -m  700 $SCRIPT_DIR/lilo $DESTDIR/usr/sbin/
  ln      -s lilo/conf $DESTDIR/etc/lilo.conf
 }

 LC_ALL=C make     all ROOT= OPT="$CFLAGS" LDFLAGS="$LDFLAGS" &&
 LC_ALL=C make install ROOT=$DESTDIR MAN_DIR=/usr/man &&
 configs_install
}

post_install(){
if [ -f /etc/lilo.conf.head ]; then mv /etc/lilo.conf.head /etc/lilo/head; fi
if [ -f /etc/lilo.conf.tail ]; then mv /etc/lilo.conf.tail /etc/lilo/tail; fi
if [ -f /etc/lilo.conf.fast ]; then rm /etc/lilo.conf.fast; fi
}

current(){
case $VERSION in
 22.8) LC_ALL=C grep -q /etc/lilo/head $INSTALL_LOGS/lilo ;;
esac
}
