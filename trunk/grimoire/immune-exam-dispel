# Copyright Kyle Sallee 2012
# All rights reserved.
# For use with the distribution sorcerer only!

version_year_week

with role    immune-system
with trait   solo stale
with info    good 20121130
with info    home http://sorcerer.silverice.org/
with info    cite "removes obsolte softare

This performs a weekly check for software
which is installed and yet lacks a spell definition.
When a spell definition is no longer provided
then this spell will automatically dispel the software."

build(){ :; }

post_install(){
 default_post_install

 local s g v

 g=$( augur gone )

 if [ -n  "$g" ]; then
  for s in $g; do
   v="$(< "$VERSION_INDEX/$s" )"
   event "$s" "$v" "Miss Self"
   echo  "$s" | pipe_queue "$SAVE_QUEUE"
   echo  "$s" | pipe_queue "$REAP_QUEUE"
  done
  dispel
 fi
}
