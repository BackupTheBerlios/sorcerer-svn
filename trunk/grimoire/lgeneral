# Not yet tested since switching to DESTDIR
# build() might require additional changes
# installation a bit complicated for DESTDIR

# version 1.2.2 tries to write directly to
# /usr/share/lgeneral/convdata/strength.bmp during installation

with version stable 1.2.3 1.2.2 1.2.1 1.2.1 1.2
with base    SDL_mixer
with role    game
with trait   x11
with trait   broke
with source  $SOURCEFORGE_URL lgeneral/lgeneral/lgeneral-$VERSION.tar.gz
with source  $SOURCEFORGE_URL lgeneral/lgeneral-data/pg-data.tar.gz
with info    omit 20120816
with info    last 20120420
with info    home 'http://lgames.sourceforge.net/index.php?project=LGeneral'
with info    cite 'port of Panzer General, a turn based strategy game

lgeneral is a turn-based strategy engine heavily inspired by Panzer General.
You play single scenarios or whole campaigns
turn by turn against a human player or the AI.
Entrenchment, rugged defense, defensive fire,
surprise contacts, surrender, unit supply,
weather influence, reinforcements and other
implementations contribute to the
tactical and strategic depth of the game.'

build(){
 install_data(){
  export SDL_VIDEODRIVER=dummy
  mkdir  -pvm 755               $DESTDIR/usr/share/lgeneral/convdata
  mkdir  -pvm 755               $DESTDIR/usr/share/games/lgeneral/{nations,gfx/{flags,units},units}
  ./lgc-pg/lgc-pg -s pg-data -d $DESTDIR/usr/share/games/lgeneral
 }

 ./configure \
 --prefix=/usr &&
 make &&
 make install DESTDIR=$DESTDIR &&
      install_data
}
