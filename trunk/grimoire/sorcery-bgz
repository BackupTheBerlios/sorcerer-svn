    stable 20081018
   require util-linux
  optional gzip  '' '' for fast but inefficient compression
  optional bzip2 '' '' for slower but more efficient compression
  optional p7zip '' '' for slowest but most efficient compression
  category utility
 attribute archive_off console
  homepage http://sorcerer.silverice.org/
      desc 'sorcery-bgz provides background compression of tarballs

Boxes with limited space for /var/cache
may benefit from compressing tarballs within
/var/cache/{archive,ccache,sources}
with a more efficient compression method
Background recompression may happen at nice level 19
while the load average is less than 2.'

build(){
 chk(){ grep -qx $1 $OPT_ON_LOGS/sorcery-bgz && Z=$2; }
 chk p7zip 7za   ||
 chk bzip2 bzip2 ||
 chk gzip  gzip

 sed -i "s:OPTS=.*:OPTS=$Z:" $SCRIPT_DIR/init.d.on/bgz
 prepare_install
 mkdir  -pvm 755 /usr/{/libexec/sorcery,sbin}
 install -vm 700 $SCRIPT_DIR/bgz.wrap /usr/sbin/bgz
 install -vm 600 $SCRIPT_DIR/bgz      /usr/libexec/sorcery
}
