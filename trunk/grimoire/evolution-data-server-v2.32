# openldap support required for communicating with exchange servers
# 2.32.0 failed compilation
# during ia32 multilib compilation:
# checking for iconv in -liconv... no
# checking for iconv... yes
# checking for gnu_get_libc_version... yes
# checking if iconv() handles UTF-8... no
# configure: error: You need to install a working iconv implementation, such as ftp://ftp.gnu.org/pub/gnu/libiconv

# evolution-data-server might be doing something incorrect to test.


   version stable 2.32.2 2.32.1 2.32.0 2.30.3
   version unstable 2.91.92 2.91.91

case $VERSION in
 2.32.0)
      opts --enable-calendar=no ;;
esac

   require alsa-lib avahi heimdal intltool libgdata-v0.6 libgnomeui libgweather-v2.30 libical libsoup nss openldap xcb-util
#  require alsa-lib avahi firefox heimdal intltool libgnomeui libgweather-v2.30 libical libsoup openldap xcb-util
      opts --with-openldap=yes --disable-gtk-doc
# optional gtk-doc --enable-gtk-doc --disable-gtk-doc
  category network/email
 attribute gnome library
    source $GNOME_URL sources/evolution-data-server/${VERSION:0:4}/evolution-data-server-$VERSION.tar.bz2
  homepage http://gnome.org/projects/evolution/stable.shtml
      desc 'libraries needed by evolution'

build(){
 # export pkg-config info instead of using configure switch --with-nspr-includes
 # export   CFLAGS+=" $( pkg-config --cflags nspr )"
 # export CXXFLAGS+=" $( pkg-config --cflags nspr )"
 #export  LDFLAGS+=" $( pkg-config --libs   nspr )"

 export   CFLAGS+=" -UGTK_DISABLE_DEPRECATED -UGDK_PIXBUF_DISABLE_DEPRECATED"
 export CXXFLAGS+=" -UGTK_DISABLE_DEPRECATED -UGDK_PIXBUF_DISABLE_DEPRECATED"

 sed -i 's:-L$libdb_prefix/lib::' configure
 default_build
}
