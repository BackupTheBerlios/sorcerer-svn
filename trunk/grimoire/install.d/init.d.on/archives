#!/bin/bash

### BEGIN INIT INFO
# Provides: archives
# Required-Start: find_ir
# Should-Start: udev loadkeys
# Required-Stop:
# Default-Start: S
# Default-Stop:
# Short-Description: archives makes the initramfs more usable.
### END INIT INFO

. /lib/lsb/init-functions

start(){
 load(){
  cd /
  7za x -so $FROM/coreutils-*.tar.7z  2>/dev/null | tar -xf -
  7za x -so $FROM/file-*.tar.7z       2>/dev/null | tar -xf -
  7za x -so $FROM/msyslog-*.tar.7z    2>/dev/null | tar -xf -
  7za x -so $FROM/parted-*.tar.7z     2>/dev/null | tar -xf -
  7za x -so $FROM/util-linux-*.tar.7z 2>/dev/null | tar -xf -
 }

 local FROM=/media/IR/var/cache/archive
 [ -d $FROM ] &&
 if   log_warning_msg 'archives loading'; load
 then log_success_msg 'archives loaded'
 else log_failure_msg 'archives not loaded'
 fi
}


help(){ echo "Usage: $0 {start}" 1>&2; }

case $1 in
 start) start ;;
 try-restart) ;;
 *) help ;;
esac
