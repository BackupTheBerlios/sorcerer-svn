  VERSION=( "1.0" "0.4" "0.3" )
  CATEGORY="game"
 ATTRIBUTE="x11 new"
# Fatal signal: Segmentation Fault (SDL Parachute Deployed)
# Might be broken or it might just not work on my box?
    SOURCE="sable-$VERSION-src.tgz"
       URL="http://www.stanford.edu/~mcmartin/sable/"
  HOMEPAGE="http://www.stanford.edu/~mcmartin/sable/"
       REQ="SDL_image SDL_mixer"
      OPTS="--bindir=/usr/games"
  ESTIMATE="27"
      DESC="sable is a 3d space shooter inspired by After Burner and Space Harrier."

if    is_installed  ati_firegl
then  REQ="$REQ ati_firegl"
fi

build()  {
if    is_installed  ati_firegl
then  GCC3_VER=$( installed_version gcc-v3.3 )
      export  PATH="${PATH/gcc\/current/gcc/$GCC3_VER}"
      export  CCACHE_PATH="/opt/gcc/$GCC3_VER/bin"
fi

sed   -i  "s:-O2 -Wall:$CFLAGS -I/usr/X11R6/include:"  src/Makefile
find  sfx textures  -type d  |  xargs  -l64  chmod 0755
find  sfx textures  -type f  |  xargs  -l64  chmod 0644

USGS="/usr/share/games/sable"
USDS="/usr/share/doc/sable"
sed  -i  "s:sfx/:$USGS/sfx/:"            src/sound.cpp
sed  -i  "s:textures/:$USGS/textures/:"  src/textures.cpp
sed  -i  "s:CFLAGS = :CFLAGS = $CFLAGS :
          s:LDFLAGS = :LDFLAGS = $LDFLAGS -L/usr/X11R6/lib :"  src/Makefile
make                            &&
prepare_install                 &&
mkdir  -p         $USDS  $USGS  &&
cp     -r  sfx textures  $USGS  &&
install  -m 0755  -o root  -g root  -D sable  /usr/games/sable  &&
install  -m 0644  -o root  -g root  README    $USDS
}
