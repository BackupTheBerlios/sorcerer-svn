with info    last 20121117
with version stable 1.10.6
with role    music
with trait   data
with source  stable $SOURCEFORGE_URL wesnoth/wesnoth-${VERSION:0:4}/wesnoth-$VERSION/wesnoth-$VERSION.tar.bz2
with info    home http://www.wesnoth.org/
with info    cite 'installs 5 ogg encoded songs from wesnoth

breaking_the_chains.ogg
casualties_of_war.ogg
knolls.ogg
traveling_minstrels.ogg
wanderer.ogg'

build(){
 local  mus="breaking_the_chains.ogg casualties_of_war.ogg "
       mus+="knolls.ogg traveling_minstrels.ogg wanderer.ogg"

 cd data/core/music
 local                 d="$DESTDIR"/usr/share/wesnoth/data/core/music/
 mkdir   -pvm 755    "$d" &&
 if   [ -f /usr/bin/oggdec ] &&
      [ -f /usr/bin/oggenc ]
 then
  # connecting oggdec and oggenc with a pipe produces static.
  for file in $mus; do
(  oggdec -Q -R       ${file}
   rm                 ${file}
   oggenc -Q -r -q -1 ${file%.ogg}.raw
) &
  done
  wait
 fi

 install -vm 644 -t "$d" $mus
}
