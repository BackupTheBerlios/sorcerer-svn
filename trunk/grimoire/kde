[  -z  $VERSION  ]  &&
   VERSION=( "3.5.2" "3.5.1" "3.5.0" "3.4.3" "3.4.2" "3.4.1" "3.4.0" "3.3.2" "3.3.1" "3.3.0" "3.2.3" )
  CATEGORY="profile"
 ATTRIBUTE="kde"
  HOMEPAGE="http://www.kde.org"
       URL="$KDE_URL"
#      REQ=( "x11 qt-x11-free arts kdelibs kdebase kdegames kdegraphics kdeartwork kdepim kdeutils kdemultimedia kdenetwork kdeadmin kdetoys kdeaddons kdeedu"
       REQ=( "arts kdelibs kdebase kdegames kdegraphics kdeartwork kdepim kdeutils kdemultimedia kdenetwork kdeadmin kdetoys kdeaddons kdeedu"
             "kdewebdev:::for web page/site development tools"
             "kdevelop:::for creating and development of software projects"
             "kdesdk:::for applications and tools used by KDE developers"
             "kdebindings:::for DCOP and kdejava bindings"
             "kdeaccessibility:::for kmag, kmousetool, and kmouth" )
   PROTECT="/usr/share/config"
  ESTIMATE="5"
      DESC="kde provides the K desktop environment.
It combines ease of use, contemporary
functionality and outstanding graphical design.
KDE is a completely new desktop, incorporating
a large suite of applications.
While KDE includes a window manager, file manager,
panel, control center and many other components
that one would expect to be part of a contemporary
desktop environment, the true strength of this
exceptional environment lies in the
interoperability of its components."

kde_build()  {
# ppanula: tested with kde 3.5.1, OK
sed -i "s:CFLAGS=\"-O2 \$CFLAGS\":CFLAGS=\"${CFLAGS}\":
        s:CXXFLAGS=\"-O2 \$CXXFLAGS\":CXXFLAGS=\"${CXXFLAGS}\":" configure
  ./configure          \
  --prefix=/usr        \
  --sysconfdir=/etc    \
  --localstatedir=/var \
  --with-xinerama      \
  --disable-debug      \
  --enable-final       \
  $OPTS                &&
  make                 &&
  prepare_install      &&
  make    install
}

bindings_build() {
  cd        dcoppython/lib
  unexpand  pydcop.py   >  pydcop.py.new
  mv        pydcop.py.new  pydcop.py
  cd  -
  kde_build
}

install_pamd() {
  mkdir  -p  /etc/pam.d
cat  >  /etc/pam.d/kde  <<  EOF
auth		required	pam_unix.so
auth		optional	pam_group.so
account		requisite	pam_time.so
account		required	pam_unix.so
password	required	pam_unix.so shadow md5 nullok
session		required	pam_unix.so
EOF

  echo  "auth		required	pam_unix.so"  \
        >  /etc/pam.d/kscreensaver
  chmod  0644  /etc/pam.d/kde  /etc/pam.d/kscreensaver
}

build()  {
  case  $SPELL  in
    kdebindings)  bindings_build  ;;
        kdebase)  kde_build  &&
                  install_pamd    ;;
            kde)  default_build   ;;
              *)  kde_build;
  esac
}

case  $SPELL  in
        kde)  :  ;;
  kde-i18n*)  unset  REQ
              CATEGORY="i18n"
              SOURCE="stable/${VERSION}/src/kde-i18n/$SPELL-$VERSION.tar.bz2"
            # SOURCE="stable/${VERSION:0:3}/src/kde-i18n/$SPELL-$VERSION.tar.bz2"
              DESC="$SPELL provides translated KDE messages."
              ;;
          *)  unset  REQ
              SOURCE="stable/${VERSION}/src/$SPELL-$VERSION.tar.bz2"
            # SOURCE="stable/${VERSION:0:3}/src/$SPELL-$VERSION.tar.bz2"
              ;;
esac
