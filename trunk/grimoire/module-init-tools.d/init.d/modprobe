#!/bin/bash

### BEGIN INIT INFO
# Provides: modprobe
# Required-Start:
# Should-Start:
# Required-Stop:  
# Default-Start: S
# Default-Stop:
# Short-Description: modprobe loads modules during boot
# Description: modprobe loads modules specified in /etc/modules during boot
### END INIT INFO

. /lib/lsb/init-functions

start()  {
  if    [  -f  /etc/modules    ]   &&
        [  -x  /sbin/modprobe  ]
  then
    log_warning_msg  "Modules about to load"
#   depmod  -Aa
    while  read  MODULE ARGS;  do
      case  $MODULE in
        \#*|"")  continue  ;;
      esac
      modprobe  -v  $MODULE  $ARGS
    done  < /etc/modules
    log_success_msg  "Modules loaded"
  fi
}

help()  {
  echo "Usage: $0 {start}" 1>&2
}

case  $1  in
  start)  start  ;;
      *)  help   ;;
esac
