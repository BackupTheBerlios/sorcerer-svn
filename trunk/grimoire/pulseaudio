with version   stable 2.1 2.0 1.1
#with version unstable 2.0
case $VERSION in
 2.0) with also --disable-udev ;;
esac
with base    audiofile avahi json-c libXtst libsamplerate libtool libvorbis speex
#with base    audiofile avahi json-c libXtst libatomic_ops libsamplerate libtool libvorbis speex
##with base    audiofile avahi libXtst libatomic_ops liboil libsamplerate libtool speex
with elect   GConf      --enable-gconf --disable-gconf for GConf support
#with elect   GConf-dbus --enable-gconf --disable-gconf for GConf support
with elect   alsa-lib   --enable-alsa  --disable-alsa  for output using ALSA
with elect   avahi      ''             --disable-avahi for avahi support
with elect   bluez ''             --disable-bluez for bluetooth support
with elect   jackit     --enable-jack  --disable-jack  for jackit audio server mixing support
#with elect   libcap     --with-caps    --without-caps  for POSIX capabilities support
with elect   lirc       --enable-lirc  --disable-lirc  for infrared control support
with elect   polkit     ''             ''              for PolicyKit support
with also    --disable-static --disable-systemd
with role    audio/mixer
with trait   console library lto_off multilib-concurrent server x11
# pulseaudio version 2.0 makefiles are not proper for makej compilation
#trait makej
with source    stable http://freedesktop.org/software/pulseaudio/releases/pulseaudio-$VERSION.tar.xz
with source  unstable http://freedesktop.org/software/pulseaudio/releases/pulseaudio-$VERSION.tar.xz
with info    last 20120917
with info    home http://pulseaudio.org/
with info    vurl http://pulseaudio.org/
with info    cite 'software audio mixer
It is intended to be an improved drop-in replacement
for the Enlightened Sound Daemon (esound or esd).
In addition to the features esound provides,
pulseaudio has an extensible plugin architecture,
support for more than one sink per source, etc...'

# build(){
#  sed -i 's:hardcode_into_libs=yes:hardcode_into_libs=no:' configure
#  default_build
# }

# build_new was not necessary nor tried after the sed statement
# on configure was discontinued.
# pulseaudio libraries must have a rpath to /usr/lib{,64}/pulseaudio/

build_new(){
 add_rpath(){
  if   [[ $HOSTTYPE == x86_64 ]] && ! [[ $CFLAGS =~ -m32 ]]
  then export LDFLAGS+=" -rpath,/usr/lib64/pulseaudio"
  else export LDFLAGS+=" -rpath,/usr/lib/pulseaudio"
  fi
 }
 case $VERSION in
  2.0) add_rpath ;;
 esac
 default_build
}

current(){
 case $VERSION in
  2.0) if   [       -f /usr/lib64/libpulse.so ]
       then objdump -x /usr/lib64/libpulse.so | grep -q RPATH
       elif [       -f /usr/lib/libpulse.so   ]
       then objdump -x /usr/lib/libpulse.so   | grep -q RPATH
       fi ;;
 esac
}
