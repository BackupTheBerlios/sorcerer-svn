with info    good 20140120
with info    last 20110704

case $TECHNIC in
 uqm) 
with version stable 0.7.0
with base    MesaLib SDL_image audiofile libmikmod libvorbis uqm-content
with elect   uqm-3domusic '' '' for excellent but large music files
with elect   uqm-remix    '' '' for remixed music instead of original music
with elect   uqm-voice    '' '' for excellent but large voice files
with source  stable $SOURCEFORGE_URL sc2/UQM/${VERSION:0:3}/uqm-$VERSION-source.tgz ;;
   *)
with trait   x11
 pre_build(){ :; } ;;
esac
with role    game
with trait   makej optimize x11
with info    home http://sc2.sourceforge.net
with info    cite 'port of the 3DO version of the game StarControl 2'

build(){
 install_source(){
  mkdir -pvm 755 content
  echo |
 ./build.sh uqm depend  &&
 ./build.sh uqm         &&
 ./build.sh uqm install &&
  install -vm 755 -d "$DESTDIR"/usr/share/uqm/content/ &&
  echo "$VERSION"  > "$DESTDIR"/usr/share/uqm/content/version
 }


 install_data(){
  local d="$DESTDIR"/usr/share/uqm/content/packages
  install -vm 755 -d "$d" &&
  install -vm 644 -t "$d" -o root -g root "$SOURCE"
 }


 install_addons(){
  # d="$DESTDIR"/usr/share/uqm/content/packages/addons/uqmremix
  d="$DESTDIR/usr/share/uqm/content/addons/$1"; shift
  install -vm 755 -d "$d"
  while [[ -n $1 ]]; do
   if   [[ -f $1 ]]
   then install -vm 644 -t "$d/" "$1"; shift
   else echo "Missing $1" 1>&2; return 1
   fi
  done
 }

 case $TECHNIC in
  uqm)          install_source ;;
  uqm-remix)    install_addons uqmremix "${SOURCE[@]}" ;;
  uqm-voice)    install_addons 3dovoice "${SOURCE[@]}" ;;
  uqm-3domusic) install_addons 3domusic "${SOURCE[@]}" ;;
  *)            install_data ;;
 esac
}
