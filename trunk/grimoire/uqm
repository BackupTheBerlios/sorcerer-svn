   VERSION=( "0.3" "0.2" "0.1" )
  CATEGORY="game"
 ATTRIBUTE="x11"
    SOURCE="sc2/uqm-${VERSION}-source.tgz"
       URL="$SOURCEFORGE_URL"
  HOMEPAGE="http://sc2.sourceforge.net"
       REQ="SDL_image uqm-content"
    OPT[0]="uqm-3domusic:::for excellent but large music files"
    OPT[1]="uqm-voice:::for excellent but large voice files"
  ESTIMATE="302"
 FRESHMEAT="uqm"
     SHORT="uqm is a port of the 3DO version of the game StarControl 2."


install_source()  {
  cat  > config.state  <<  EOF
CHOICE_debug_VALUE='nodebug'
CHOICE_graphics_VALUE='opengl'
CHOICE_sound_VALUE='mixsdl'
INPUT_install_prefix_VALUE='/usr'
INPUT_install_bindir_VALUE='\$prefix/games'
INPUT_install_libdir_VALUE='\$prefix/share'
EOF

  mkdir  -p  content
  echo  |  ./build.sh  uqm  depend   &&
           ./build.sh  uqm           &&
  prepare_install                    &&
           ./build.sh  uqm  install  &&
  ln  /usr/share/uqm/uqm  /usr/libexec/uqm
}


install_data()  {
  CONTENT=$(  guess_filename  $SOURCE  )
  PACKAGE=/usr/share/uqm/content/packages
  if    [  -n  "$CONTENT"  ];  then
    prepare_install            &&
    set      -x                &&
    mkdir    -p      $PACKAGE  &&
    install  -m 0644  -o root  -g  root  $CONTENT   $PACKAGE  &&
    set      +x
  else
    echo  "$SOURCE not found"
    false
  fi
}


install_remix()  {
  CONTENT1=$(  guess_filename  ${SOURCE[0]}  )
  CONTENT2=$(  guess_filename  ${SOURCE[1]}  )
  PACKAGE=/usr/share/uqm/content/packages/addon/uqmremix
  if    [  -n  "$CONTENT1"  ]  &&
        [  -n  "$CONTENT2"  ]
  then
    prepare_install            &&
    set      -x                &&
    mkdir    -p      $PACKAGE  &&
    install  -m 0644  -o root  -g  root  $CONTENT1   $PACKAGE  &&
    install  -m 0644  -o root  -g  root  $CONTENT2   $PACKAGE  &&
    set      +x
  else
    echo  "$SOURCE not found"
    false
  fi
}


build()  {
  case  $SPELL  in
    uqm)        install_source  ;;
    uqm-remix)  install_remix   ;;
    *)          install_data    ;;
  esac
}


if    ! [  "$SPELL"  ==  "uqm"  ];  then
  unset  REQ  OPT
  ESTIMATE="5"
  pre_build()  {  :;  }
  if     !  [  "$SPELL"  ==  "uqm-remix"  ]
  then   SOURCE="sc2/uqm-${VERSION}-${SPELL:4}.zip"
  fi
fi
