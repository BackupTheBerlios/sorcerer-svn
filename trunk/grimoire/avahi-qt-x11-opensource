# multilib-fail because qt-everywhere-opensource is also multilib-fail

# Avahi 0.6.27 still requires gobject-introspection version 0.6.14

# avahi correctly uses pkgconfig files to locate install locations for:
# qt-everywhere-opensource
# avahi-autoipd if started should be started from a template
# provided by networks rather than a separate init script
# since the purpose of avahi-autoipd is to automatically assign
# an IP address to a network interface.
# 0.6.21 may have acquired a requirement on libcap

   version stable 0.6.30 0.6.29 0.6.28 0.6.27 0.6.25
case $VERSION in
 0.6.28)
      opts --disable-manpages ;;
esac
   require avahi qt-everywhere-opensource 
      opts --disable-gtk --disable-gtk3 --disable-qt3 --with-distro=none --disable-mono --disable-python --disable-static --enable-compat-libdns_sd
      opts --prefix=/usr
  category utility
 attribute kde4 library makej multilib-dual
#attribute multilib-concurrent
    source http://avahi.org/download/avahi-$VERSION.tar.gz
      info home http://avahi.org/
      info docs 'http://avahi.org/wiki/Avah4users#Documentation'
      desc 'qt-everywhere-opensource bindings for avahi'

build(){
 if     [[ $HOSTTYPE == x86_64 ]]; then
  if    [[ $CFLAGS   =~   -m32 ]]
  then  export PKG_CONFIG_PATH=/opt/32bit/usr/lib/pkgconfig; OPTS+=' --prefix=/opt/32bit/usr'
  else  export PKG_CONFIG_PATH=/usr/lib64/pkgconfig;    OPTS+=' --prefix=/usr --libdir=/usr/lib64'
  fi
 else   export PKG_CONFIG_PATH=/usr/lib/pkgconfig;      OPTS+=' --prefix=/usr'
 fi

 default_build
}
