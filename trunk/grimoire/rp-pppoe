#rp-pppoe currently require net-tools to detect the connection
#remove this dependency when ip version will be available
#MALET Jean-Luc

# What did the above comment mean?
# Should the requirement on net-tools be replaced by iproute2 ?

   version stable 3.10
   require ppp net-tools
  category network
 attribute console
    source http://www.roaringpenguin.com/files/download/rp-pppoe-$VERSION.tar.gz
      info good 20120703
      info last 20081022
      info vurl http://www.roaringpenguin.com/penguin/openSourceProducts/rpPppoe
      info home http://www.roaringpenguin.com/pppoe/
      desc 'PPP over Ethernet client/server suite
rp-pppoe, Roaring Penguin, is a PPPoE client and server
suite for Linux, NetBSD, Solaris, and Mac OS X Beta.
It is fully RFC-compliant and supports cookies, relay-IDs,
and multiple simultaneous PPPoE discovery phases.
It is cleanly coded and fairly efficient,
and supports kernel-mode PPPoE on Linux 2.4.x.'

build(){
 strip_destdir(){
  local  LC_ALL
  export LC_ALL=C

  find $DESTDIR -type f     |
  xargs --max-lines=64 file |
  grep ', not stripped'     |
  cut -d : -f1              |
  xargs --max-lines=64 strip --strip-unneeded
 }

 install_extra(){
  mkdir -p $DESTDIR/usr/share/applnk/Internet
  mkdir -p $DESTDIR/usr/share/gnome/apps/Internet
  cp $SCRIPT_DIR/tkpppoe.kdelnk  $DESTDIR/usr/share/applnk/Internet
  cp $SCRIPT_DIR/tkpppoe.desktop $DESTDIR/usr/share/gnome/apps/Internet
 }

 sed -i 's/read a/a=0/' scripts/adsl-setup.in
 cd src
 ./configure          \
 --prefix=/usr        \
 --sbindir=/sbin      \
 --sysconfdir=/etc    \
 --localstatedir=/var \
 $OPTS      &&
 make       &&
 cd  ../gui &&
 make       &&
 make  install DESTDIR=$DESTDIR && cd ../src &&
 make  install DESTDIR=$DESTDIR &&
 strip_destdir &&
 install_extra
}

current(){
 case $VERSION in
  3.8) [ -f /sbin/pppoe ] ;;
 esac
}
