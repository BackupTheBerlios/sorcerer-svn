   VERSION=( "2.2.5" "2.2.4" "2.2.3" "2.2.1" "2.2.0" "2.1.11" "2.1.10" "2.1.9" )
  CATEGORY="utility"
 ATTRIBUTE="console"
    SOURCE="pub/software/utils/pciutils/pciutils-$VERSION.tar.bz2"
  HOMEPAGE="ftp://ftp.kernel.org/pub/software/utils/pciutils"
       URL="$KERNEL_URL"
       REQ="zlib"
  ESTIMATE="50"
      DESC="pciutils provides setpci and lspci utils.

pciutils include:

lspci		displays detailed information about all PCI busses and
		devices in the system, replacing the original /proc/pci
		interface.

setpci		allows to read from and write to
		PCI device configuration registers.
		For example, you can adjust
		the latency timers with it."

build() {

  install_lib()  {
    mkdir     -p  -v  -m 0755         /usr/include/pci
    for                         file  in  lib/*.h
    do   install  -v  -m 0644  $file  /usr/include/pci/
    done
    case  $MACHTYPE  in
      x86_64*)  install  -v  -m 0755  lib/libpci.a  /usr/lib64  ;;
            *)  install  -v  -m 0755  lib/libpci.a  /usr/lib    ;;
    esac
  }

make             &&
prepare_install  &&
make    install  &&
        install_lib
# libpci.a is 30K, small enough that there is no shared library for it.
}


build_old() {
# export  LDFLAGS="$LDFLAGS -L/lib"
# sed  -i  "s:-O2:${CFLAGS}:
#           s:/usr/local:/usr:"  Makefile

case  $VERSION  in
  2.2.4)  patch  -p1  <  $SCRIPT_DIR/pciutils-$VERSION.patch
          sed    -i      "s:/usr/local:/usr:"  Makefile  ;;
esac

make             &&
prepare_install  &&
make    install  &&
install  -v -m 755  -d               /usr/include/pci  &&
install  -v -m 644  lib/*.h          /usr/include/pci  &&
install  -v -m 755  lib/libpci.so.2  /usr/lib          &&
ln       -v -s          libpci.so.2  /usr/lib/libpci.so
}
