# definitely requires lcms
# Have it download and compile a static version of lcms?

   inherit kde-v4
   require kdelibs-v4 lcms
  category graphic
 attribute library makej
#attribute library makej multilib-dual
#attribute library makej multilib-concurrent
#attribute broke
    source   stable $KDE_URL   stable/$VERSION/src/$SPELL-$VERSION.tar.xz
#   source   stable $SOURCEFORGE_URL lcms/lcms/$VERSION/lcms-1.19.tar.gz
    source unstable $KDE_URL unstable/$VERSION/src/$SPELL-$VERSION.tar.xz
#   source unstable $SOURCEFORGE_URL lcms/lcms/$VERSION/lcms-1.19.tar.gz
      desc 'C++ interface for LibRaw library used to decode RAW picture files'

# The build below should work for static linking lcms,
# but the 32-bit version of libkdcraw refuses to locate lcms
# while the 64-bit version compiles fine.
# Weird.

build_broke(){
 lcms_static(){
  export CFLAGS+=' -fPIC'
  cd lcms-1.19 &&
  ./configure --enable-static --disable-shared --prefix=$PWD/installed/usr &&
  make && make install &&
#  export CXXFLAGS+=" -I$PWD/installed/usr/include" &&
#  export LDFLAGS+=" -L$PWD/installed/usr/lib" &&
  export PKG_CONFIG_PATH="$PWD/installed/usr/lib/pkgconfig:$PKG_CONFIG_PATH" &&
  cd ..
 }
 lcms_static &&
 kde_build
}
