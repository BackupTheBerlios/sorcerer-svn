# currently a magic failure on the compressed gzip tarball.
# attempting to adapt sorcery to handle it.
# 4.3 reported as released on freshmeat, but not available for download on sourceforge

    stable 4.4 4.3 4.2 4.1 4.0 3.8-stable 3.7-stable 3.6 3.5-r1 3.5 3.2 3.1 3.0 2.9
   require allegro
  category game
 attribute x11
#attribute broke
    source $SOURCEFORGE_URL atanks/atanks/atanks-$VERSION/atanks-$VERSION.tar.gz
  homepage http://atanks.sourceforge.net
  estimate 40
      desc 'clone of the game scorched earth.
atanks is a multi-platform scorched earth clone similar to Worms. 
Annihilate the other tanks to earn money, then spend it on bigger 
and better shields and weapons to wipe out the opposition.
It features a wide array of weapons, destructible landscape, 
weather, parachutes, teleports and a wide range of other features.'

build(){
 sed -i 's:-DDATA_DIR=\\"\.\\":-DDATA_DIR=\\"/usr/share/games/atanks\\":' src/Makefile
 make &&
 prepare_install &&
 make    install
}

build_old(){
 install_atanks(){
  mkdir   -vp                 $UB $USA
  install -vm 755  atanks     $UB
  install -vm 644 *.{dat,txt} $USA
 }

 USA='/usr/share/atanks'
  UB='/usr/bin'

 CF="CFLAGS=$CFLAGS"
 LF="LDFLAGS=$LDFLAGS $( allegro-config  --libs )"

 rm -f atanks
 cd src &&
 sed -i 's:-DDATA_DIR=\\".\\":-DDATA_DIR=\\"/usr/share/atanks\\":' Makefile &&
 make "$CF" "$LF" DATA_DIR=$USA &&
 cd .. &&
 prepare_install &&
         install_atanks
}
