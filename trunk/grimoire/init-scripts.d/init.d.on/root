#!/bin/bash

### BEGIN INIT INFO
# Provides: root
# Required-Start: cryptsetup fsck fstab proc sys
# Should-Start: cryptmount-early cryptsetup dmsetup fstab mapper mdadm $network udev vgchange
# Required-Stop: halt cryptmount cryptsetup mdadm reboot
# Default-Start: S
# Short-Description: root mounts / or /media/root rw
### END INIT INFO

. /lib/lsb/init-functions

start(){
 run(){
  if   [ -d /opt ]; then
   mount -n -o remount,rw /
  else
   [     -d /media/root ] ||
   mkdir -p /media/root   &&
   mount    /media/root
  fi
 }

 if   log_warning_msg 'root filesystems mounting'; run
 then log_success_msg 'root filesystems mounted'
 else log_failure_msg 'root filesystem not mounted'
 fi
}

help(){ echo "Usage: $0 {start}" 1>&2; }

case $@ in
 start) start ;;
 try-restart) : ;;
 *) help ;;
esac
