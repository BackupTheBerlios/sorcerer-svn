#!/bin/dash
trap : INT QUIT TSTP
export PATH=/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sbin
umask 022

CYAN="[36m"
NORM="[0m"

if   [ "$BASH_VERSION" ]
then BE=-e
fi

info(){ echo $BE "$CYAN * $NORM$1\r" 1>&2; }

run(){
 for S in /etc/rc.d/rcS.d/*
#do info "Run $S start"; $S start; info "Ran $S start"
 do $S start
 done
 echo End sysinit
}

md(){ [ -d $1 ] || mkdir -p $1; }

I=/etc/init.d
L=$I/log.d
D=$I/dev.d

[ -f $L/sysinit ] && return

if   [ -c $D/si ] &&  echo > $D/si
then cap(){ tee $L/sysinit > $D/si; }
else cap(){ tee $L/sysinit; }
fi

md $L
md $D
mount -o size=1m,nr_inodes=8 -t tmpfs tmpfs $L
run 2>&1 | cap
