#!/bin/bash

### BEGIN INIT INFO
# Provides: modprobe
# Required-Start: proc sys modprobe-r dev-cp
# Should-Start:
# Required-Stop:  
# Default-Start: S
# Default-Stop:
# Short-Description: modprobe loads modules during boot
# Description: modprobe loads modules specified in /etc/modules during boot
### END INIT INFO

if [[ $1 == try-restart ]] || ! [[ -x /sbin/modprobe ]] || ! [[ -f /etc/modules ]]
then exit
fi

. /lib/lsb/init-functions

mp(){
 sed 's:#.*::;/^ *$/d' /etc/modules |
 while read; do modprobe $REPLY; done
}

log_warning_msg 'Modules loading'; mp
log_success_msg 'Modules loaded'
