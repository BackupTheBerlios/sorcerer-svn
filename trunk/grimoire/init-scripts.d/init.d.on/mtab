#!/bin/dash

### BEGIN INIT INFO
# Required-Start: root-rw
# Default-Start: S
# Short-Description: mtab creates /etc/mtab from /proc/mounts
### END INIT INFO

. /lib/lsb/init-functions

start(){
 run(){
  MR=/media/root
  if   [  -f  $MR/sbin/init ]
  then rm -fr $MR/etc/mtab /etc/mtab; cat /proc/mounts > $MR/etc/mtab; ln -s $MR/etc/mtab /etc/mtab
  else rm -fr              /etc/mtab; cat /proc/mounts >    /etc/mtab
  fi
 }

 log_warning_msg '/etc/mtab creating'; run
 log_success_msg '/etc/mtab created'
}

try_restart(){ :; }
parse "$@"
