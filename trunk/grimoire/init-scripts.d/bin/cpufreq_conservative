#!/bin/bash
# Use taskset to specify processor affinity for a process
# Otherwise ondemand performance might not peak or
# tends to raise and lower all processors depending on
# how a process jumps from processor to processor.
# Ondemand performance will probably be less than
# the performance governor when compiling software
# Unlike cpufreq_ondemand
# cpufreq_conservative gradually increases and decreases CPU frequency
# instead of jumping from one extreme to the other.
# Performance will suffer when using cpufreq_conservative
# on SMP boxes when less than full load.

if   (( UID == 0 )) && ! lsmod | grep -q cpufreq_conservative
then modprobe cpufreq_conservative
fi

for CPU in /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor
do echo conservative > $CPU
done
