#!/bin/bash
# Use taskset to specify processor affinity for a process
# Otherwise ondemand performance might not peak or
# tends to raise and lower all processors depending on
# how a process jumps from processor to processor.
# Ondemand performance will probably be less than
# the performance governor when compiling software
# Performance will suffer when using cpufreq_ondemand
# on SMP boxes when less than full load.

if   (( UID == 0 )) && ! lsmod | grep -q cpufreq_ondemand
then modprobe cpufreq_ondemand
fi

for CPU in /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor
do [ -f "$CPU" ] && echo ondemand > $CPU
done
