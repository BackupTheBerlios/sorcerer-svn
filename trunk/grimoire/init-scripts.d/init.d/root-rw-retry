#!/bin/bash                                                   

### BEGIN INIT INFO
# Default-Mode: 500
# Required-Start: root-rw
# Required-Stop: $local_fs                                                      
# Default-Start: S
# Short-Description: provides a second chance for mounting / read-write
### END INIT INFO

if   [ -d /home ] ||
     grep -q boot=IR /proc/cmdline ||
     grep -v rootfs  /proc/mounts  | grep -q " /media/root .*rw"
then exit
fi

. /lib/lsb/init-functions

only start
deny control

start(){
 echo > /tmp/coldplug
 /etc/init.d/dev-cp start
 /etc/init.d/modprobe-coldplug start
 /etc/init.d/root-rw start
}
