#!/bin/bash

### BEGIN INIT INFO
# Default-Mode: 500
# Required-Start: fsck
# Required-Stop: $local_fs
# Default-Start: S
# Short-Description: during boot mounts / or /media/root rw
### END INIT INFO

. /lib/lsb/init-functions

only start
deny control

start(){
 run(){
  if [ -d /home ]
  then mount -n -o remount,rw /
  else
   sed 's:#.*::' /etc/fstab.rootfs |
   tr  '\t' ' '      |
   tr  -s ' '        |
   cut -d ' ' -f2    |
   grep /media/root/ |
   while read; do mkdir -pm 755 "$REPLY"; done
   mount -T /etc/fstab.rootfs -n -a
  fi
 }

 if   log_warning_msg 'root file systems mounting read write'; run
 then log_success_msg 'root file systems mounted  read write'
 else log_failure_msg 'root file systems not mounted'
 fi
}
