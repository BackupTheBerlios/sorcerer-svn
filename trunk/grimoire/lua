    stable 5.1.4 5.1.3 5.0.3
   require ncurses readline
  category development/interpreter
 attribute console
    source http://www.lua.org/ftp/lua-$VERSION.tar.gz
  homepage http://www.lua.org/
      desc 'lua is a programming langauge.
lua is a programming language originally designed
for extending applications, but also frequently
used as a general-purpose, stand-alone language.
Lua combines simple procedural syntax (similar to Pascal)
with powerful data description constructs based
on associative arrays and extensible semantics.
Lua is dynamically typed, interpreted from bytecodes,
and has automatic memory management, making it ideal
for configuration, scripting, and rapid prototyping.
Lua is implemented as a small library of C functions,
written in ANSI C, and compiles unmodified in all known platforms.
The implementation goals are simplicity,
efficiency, portability, and low embedding cost.
It has been used on games such as Grim Fandango,
Escape from Monkey Island, and MDK2.'

build(){
 LC_ALL=C grep -rl "\-O2 -Wall" * |
 xargs -r --max-lines=256 sed -i "s:-O2 -Wall:$CFLAGS -fPIC:"
 sed -i 's:/usr/local:/usr:' etc/lua.pc
 make    linux   &&
 prepare_install &&
 make    install INSTALL_TOP=/usr &&
 ld --whole-archive -share -ldl -soname \
                liblua.so.$VERSION \
    -o /usr/lib/liblua.so.$VERSION \
       /usr/lib/liblua.a &&
 ln -s liblua.so.$VERSION /usr/lib/liblua.so.${VERSION:0:3} &&
 ln -s liblua.so.$VERSION /usr/lib/liblua.so.${VERSION:0:1} &&
 ln -s liblua.so.$VERSION /usr/lib/liblua.so &&
 mkdir  -pvm 755            /usr/lib/pkgconfig &&
 install -vm 644 etc/lua.pc /usr/lib/pkgconfig
}
