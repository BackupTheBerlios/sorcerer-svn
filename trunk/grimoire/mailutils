# 1.2 has compile errors, perhaps missing an include for a db header file?
# 2.1 and 2.0 do not compile with current gcc.
# 2.2 failed compilation

   version stable 2.2 1.1 1.0
   version latest 2.1 2.0
   version unstable 1.2 1.1
   require guile-v1.8
  optional Linux-PAM  ''                --disable-pam     for pluggable authentication
  optional db         ''                ''                can use either db or gdbm for APOP authnetication in POP3 daemon  Use Berkeley sleepycat db
  optional emacs      --enable-mh-utils ''                to provide an interface between Mailutils and Emacs using mh-e module
  optional fribidi    ''                --without-fribidi for bidirectional text support
  optional gdbm       ''                ''                use GNU database library for APOP authentication in POP3 daemon
  optional gnutls     --with-gnutls     ''                to enable TSL/SSL server-side encryption via gnutls in IMAP4/POP3 daemons
# optional gsasl      --with-gsasl      ''                use libgsasl for SASL authnetication with IMAP4d
  optional gss        --with-gssapi     ''                for gssapi/kerberos 5 authentication
  optional mysql      --with-mysql      ''                to enable authnetication using mysql
  optional postgresql --with-postgres   ''                to enable authneticaion via postgresql
  optional stunnel    ''                ''                for imaps or pops services
  optional xinetd     ''                ''                for running servers

  category network/email
 attribute console client server
#attribute console client library makej multilib-concurrent server

case $VERSION in
 2.0)
    source $GNU_URL mailutils/mailutils-$VERSION.tar.gz ;;
   *)
    source $GNU_URL mailutils/mailutils-$VERSION.tar.bz2 ;;
esac

      info home http://www.gnu.org/software/mailutils
   provide email-client pop3 pop3s imap imaps mailx
      desc 'series of useful mail clients, servers, and libraries

mailutils contains a series of useful mail clients, servers and libraries.
These are the primary mail utilities of the GNU system.
It contains a POP3 server, an IMAP4 server, and a Sieve mail filter.
It also provides a POSIX mailx client and a collection of other tools.

Using pop3d or imap4d through stunnel has not
been tested with this spell and may not work.
If it does not, please fix and report it
or use pine SSL mail servers instead.'

build(){
 local  RATH=$PATH
 local  PATH=/opt/guile/1.8/bin:$RATH
 export PATH

 if   [[ $HOSTTYPE == x86_64 ]] && ! [[ $CFLAGS =~ -m32 ]]
 then export LDFLAGS+=' -L/usr/lib64/mysql'
 else export LDFLAGS+=' -L/usr/lib/mysql'
 fi

#   if grep -qx db   $OPT_ON_LOGS/mailutils; then OPTS+=' --with-db2'
# elif grep -qx gdbm $OPT_ON_LOGS/mailutils; then OPTS+=' --with-gdbm'
# fi

   if grep -qx db   $OPT_ON_LOGS/mailutils; then opts --with-berkeley-db
 elif grep -qx gdbm $OPT_ON_LOGS/mailutils; then opts --with-gdbm
 fi
 default_build &&
 ln -fs mail $DESTDIR/usr/bin/mailx
}
