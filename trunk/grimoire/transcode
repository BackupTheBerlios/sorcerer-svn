# transcode 1.0.5 does not compile with gcc version 4.3.0

# ImageMagick is not properly detected in transcode version 1.0.6
#  optional ImageMagick --enable-imagemagick --disable-imagemagick for ImageMagick dependent module

    stable 1.1.3 1.1.2 1.1.1 1.1.0 1.0.7 1.0.6 1.0.6rc1 1.0.5
   require ffmpeg libXaw libmpeg2 libpng tiff
  optional a52dec      --enable-a52         --disable-a52         for decoding and encoding ATSC A/52 streams
  optional avifile     --enable-avifile     --disable-avifile     for reading and writing compressed AVI files
  optional freetype    --enable-freetype2   --disable-freetype2   for nice looking fonts
  optional lame        --enable-lame        --disable-lame        for encoding mpeg3s
  optional libdvdread  --enable-libdvdread  --disable-libdvdread  for DVD navigation support
  optional libogg      --enable-ogg         --disable-ogg         for importing ogg audio files
  optional libvorbis   --enable-vorbis      --disable-vorbis      for importing vorbis audio files
  optional libtheora   --enable-theora      --disable-theora      for importing theora audio
  optional libdv       --enable-libdv       --disable-libdv       for libdv dependent modules
  optional lzo         --enable-lzo         --disable-lzo         for lzo dependent modules
  optional libxml2     --enable-libxml2     --disable-libxml2     for libxml2 dependent modules
  optional SDL         --enable-sdl         --disable-sdl         for GUI via SDL
  optional jpeg        --enable-libjpeg     --disable-libjpeg     for jpeg dependent modules
  category video
 attribute x11
    source http://download.berlios.de/tcforge/transcode-$VERSION.tar.bz2
      vurl http://developer.berlios.de/project/showfiles.php?group_id=10094
#   source http://fromani.exit1.org/transcode-$VERSION.tar.bz2
#     vurl http://fromani.exit1.org/
# homepage http://www.transcoding.org/cgi-bin/transcode/
  homepage http://tcforge.berlios.de/

# mjpegtools not currently compiling
#            'mjpegtools:--enable-mjpegtools:--disable-mjpegtools:for dependent modules'

# libfame 0.9.1 not usable with transcode 1.0.0 because
# /usr/lib/libfame.so: undefined reference to `_mmx_one'
#            'libfame:--enable-libfame:--disable-libfame:for a fast mpeg encoder'

# libmpeg3 1.5.4 has link errors
#            'libmpeg3:--enable-libmpeg3:--disable-libmpeg3:for libmpeg3 dependent modules'

# transcode 1.0.0 not compatibile with libquicktime 0.9.7
#            'libquicktime:--enable-libquicktime --with-libquicktime-includes=/usr/include/lqt:--disable-libquicktime:for quicktime dependent modules'


#optional nasm '' '' for nasm dependent modules (bbmpeg)'
#optional XviD '' '' for using the mpeg 4 video codec'
#optional openquicktime:--with-openqt '' for quicktime dependent modules' )
#  'MPlayer '' '' for post processing filter plugin'
# libtheora is still under initial development.
#  'libtheora '' '' for use of theora codec'

#  libmpeg3 1.5.1 doesn't compile
#  'libmpeg3 '' '' for libmpeg3 dependent modules'

case $VERSION in
 1.0.5) use_gcc gcc-v4.2 ;;
esac

  estimate 5000
      desc 'tool for translating audio/video input formats
transcode is a text console video-stream processing tool.
It supports elementary video and audio frame transformations.
Some example modules are included to enable import
of MPEG-1/2, Digital Video, and other formats.
It also includes export modules for writing to AVI files
with DivX, OpenDivX, XviD, Digital Video or other codecs.
Direct DVD transcoding is also supported.
A set of tools is available to extract and decode
the sources into raw video/audio streams for import
and to enable post-processing of AVI files.'

build(){
 case $VERSION in
  1.0.6rc1) grep -rl   ffmpeg/avcodec.h * | xargs -r --max-lines=64 \
            sed  -i 's:ffmpeg/avcodec.h:libavcodec/avcodec.h:'
            sed -i 's:-lMagick:-lMagick++:g' configure ;;
  1.0.5) sed -i 's:-lMagick:-lMagick++:g' configure
#         sed -i '/typedef signed long __s32;/d
#                 /typedef unsigned long __u32;/d' import/nuv/RTjpegN.h 
  ;;
 esac
 default_build
}
