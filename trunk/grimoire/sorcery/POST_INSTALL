clean_provide_logs()  {
  grep  -r  ""  $PROVIDE_LOGS  |
  basenames                    |
  tr  ':'  ' '                 |
  while  read  LEFT  RIGHT;  do
    if    [  "$LEFT"  ==       "$RIGHT"  ]
    then  rm  -f  $PROVIDE_LOGS/$RIGHT
    fi
  done
  grep   -rl  ","  $PROVIDE_LOGS  |  xargs  -l64   rm  -f
}


clean_opt_logs()  {
  find  $OPT_ON_LOGS  $OPT_OFF_LOGS  -follow  -type f  -empty  |
  xargs  -l64  rm  -f
}


switch_delta() {
  if    enabled  "xdelta"  ${FEATURE[*]};  then
    sed  -i  "s:xdelta:sdelta:"  $OPT_ON_LOGS/sorcery  $LOCAL_CONFIG
    unlock_cast
    cast  sdelta
  fi
}



ARCH=$( uname -m )

if    [  -x  $SENTINEL-$ARCH  ]
then  cp     $SENTINEL-$ARCH  $SENTINEL
fi

clean_provide_logs
clean_opt_logs
switch_delta
generate_index
