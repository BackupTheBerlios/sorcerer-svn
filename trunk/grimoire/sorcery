    stable photon-20100322-0 photon-20100212-0 photon-20100205-0 photon-20100204-0 photon-20100202-0 photon-20100128-1 photon-20100122-1 photon-20100121-0 photon-20100118-0 photon-20100116-0
   require bash bzip2 curl dialog diffutils file findutils gcc grep grimoire gzip init-scripts less make mktemp p7zip patch procps rpmunpack sorcery-sentinel tar which xz
  optional ccache            '' '' for faster compilation when updating installed software
  optional sdelta3           '' '' for downloading tiny source tarball patches
  optional sorcery-alien     '' '' for monthly tracking of installed alien files
  optional sorcery-backup    '' '' for monthly filesystem backup
  optional sorcery-bootblaze '' '' for faster booting and login
  optional sorcery-bxz       '' '' for background compression of tarballs
  optional sorcery-clean     '' '' for removal of old tarballs and old logs
  optional sorcery-defrag    '' '' for monthly file defragment
  optional sorcery-immune    '' '' for an immune system
  optional sorcery-md5sum    '' '' for weekly md5sum check of installed files
  category utility
 attribute archive_off solo sorcery
  homepage http://sorcerer.silverice.org/
    source http://sorcerer.silverice.org/download/sorcery/sorcery-$VERSION.tar.bz2

# Should /var/cache and /var/spool be excluded?
# They used to be but that caused missing directories for cups and hal

   exclude /dev
   exclude /etc/sorcery/local.config
   exclude /home
   exclude /proc
   exclude /root
   exclude /tmp
   exclude /usr/src/sorcery
   exclude /var/lock
   exclude /var/log/sorcery/snap
   exclude /var/run
   exclude /var/state
   exclude /var/tmp
   exclude $VOG_DIR
   protect /etc/sorcery/config
   protect /etc/sorcery/dialogrc
   protect /usr/libexec/sorcery/augur
   protect /usr/libexec/sorcery/cast
   protect /usr/libexec/sorcery/dispel
   protect /usr/libexec/sorcery/leech
   protect /usr/libexec/sorcery/share
   protect /usr/libexec/sorcery/sorcery
   protect /usr/sbin/augur
   protect /usr/sbin/cast
   protect /usr/sbin/dispel
   protect /usr/sbin/leech
   protect /usr/sbin/sorcery
   protect /var/cache
   protect /var/spool
      desc 'sorcery contains source management tools.
augur   - provides detailed information about the box
cast    - installs spells
dispel  - removes installed spells
leech   - downloads sources for spells
sorcery - menu driven source manager'

build(){
 [[ -x   install ]] &&
 prepare_install    &&
 ./install $VERSION
}


post_install(){

 discard_old_index(){
  merge_grimoires
  generate_index   
 }

 fix_nspr_provide(){
  if [ -f   $PROVIDE_LOGS/nspr ] &&
     read < $PROVIDE_LOGS/nspr   && [[ $REPLY == nss ]]
  then rm   $PROVIDE_LOGS/nspr
  fi
 }

 . /etc/sorcery/config

 [[ -d  /lib.old ]] &&
 rm -fr /lib.old

 discard_old_index
 fix_nspr_provide
 default_post_install
}
