# Notes about problems and solutions.

# if jackd can not be started by qjackctl
# re-configure it to begin without real-time priority.

# If .xsession-errors  has errors about io-slave protocol file not being found
# then as the user:
# $ rm -f ~/.kde/share/config/ksycoca
# $ rm -r /var/tmp/kdecache-$USERNAME/ksyscoca
# $ kbuildsycoca4

# The missing icon pictures for Home Trash and so forth
# is because they are leftover from KDE 3.x in ~/Desktop
# Removing them is safe.

if [ -z "$VERSION" ]; then
    stable 4.0.5 4.0.4 4.0.3 4.0.2 4.0.1 4.0.0
 secure 4.0.5 4.0.4 4.0.3 4.0.2 4.0.1 4.0.0
fi

 attribute kde4
  homepage http://www.kde.org
       url $KDE_URL
      opts -DCMAKE_INSTALL_PREFIX:PATH=/opt/kde4
      opts -DCMAKE_INSTALL_RPATH:PATH=/opt/kde4/lib:/opt/kde4/lib64
      opts -DCMAKE_SKIP_BUILD_RPATH:BOOL=TRUE
      opts -DCMAKE_BUILD_WITH_INSTALL_RPATH:BOOL=TRUE
      opts -DCMAKE_INSTALL_RPATH_USE_LINK_PATH:BOOL=TRUE
      opts -DCMAKE_BUILD_TYPE=Release

case $SPELL in
    kde-v4)
  category profile
   require kdeartwork-v4 kdebase-v4 kdebase-runtime-v4 kdebase-workspace-v4
  optional kdeaccessibility-v4 '' '' for enhanced usability
  optional kdebindings-v4      '' '' for DCOP and kdejava bindings
  optional kdeadmin-v4         '' '' for system administration programs
  optional kdeedu-v4           '' '' for educational programs
  optional kdegames-v4         '' '' for games
  optional kdegraphics-v4      '' '' for image viewing programs
  optional kdenetwork-v4       '' '' for networking utilities
  optional kdemultimedia-v4    '' '' for audio/visual programs
  optional kde-path-v4         '' '' for including /opt/kde4/bin in the PATH
  optional kdesdk-v4           '' '' for applications and tools used by KDE developers
  optional kdetoys-v4          '' '' for amusing programs
  optional kdeutils-v4         '' '' for desktop tools
  optional kdewebdev-v4        '' '' for web page/site development tools
  optional kaider              '' '' for computer-aided translation system
  optional kcoloredit          '' '' for a color editor
  optional kfax                '' '' for a G3/G4 fax viewing program
  optional kgraphviewer        '' '' for displaying graphviz .dot graphs
  optional kiconedit           '' '' for an icon editor
  optional kmldonkey           '' '' for a kde frontend to mldonkey
  optional kphotoalbum         '' '' for a program to index and find photographs
  optional ktorrent            '' '' for a BitTorrent application
  optional rsibreak            '' '' for a rest reminder to avoid strain
  optional qjackctl            '' '' for starting jackit audio server
  optional scim-bridge-qt4     '' '' to input in Japanese, Chineese, Korean

# extragear-plasma last release was 4.0.2? no 4.0.3 release?
#            'extragear-plasma:::for additional plasma apps/themes'
#            'kpovmodeler:::broken'
#            'ligature:::broken'
  estimate 5
      desc 'kde-v4 provides the K version 4.x desktop environment.
It combines ease of use, contemporary
functionality and outstanding graphical design.
KDE is a completely new desktop, incorporating
a large suite of applications.
While KDE includes a window manager, file manager,
panel, control center and many other components
that one would expect to be part of a contemporary
desktop environment, the true strength of this
exceptional environment lies in the
interoperability of its components.' ;;
 kde-l10n*) category documentation/i18n
            source stable/${VERSION}/src/kde-l10n/$SPELL-$VERSION.tar.bz2
            desc "$SPELL provides translated KDE messages." ;;
         *) source stable/${VERSION}/src/${SPELL%-v4}-$VERSION.tar.bz2
esac


kde_build(){
 SCX=1
 while [    -n                                 "${SOURCE[$SCX]}" ]
 do    patch-p0 < $SOURCE_CACHE/$SPELL/$VERSION/${SOURCE[$SCX]##*/}
       (( SCX++ ))
 done

 mkdir build     &&
 cd    build     &&
 cmake $OPTS ..  &&
 make            &&
 prepare_install &&
 make    install
}

build(){
 case $SPELL in
  kde-v4) default_build ;;
       *) kde_build ;;
 esac
}
