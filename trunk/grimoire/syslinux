# 3.72 has build errors
# 3.71 has build errors
# 3.70 has build errors
# 3.73 not tested
# 3.83 not tested
# 3.84 not tested
# 4.02 failed compilation

   version stable 4.04 4.03 4.01
   version pre 4.10-pre14
   require nasm perl
  optional mtools '' '' for creating msdos filesystems
  category administration/bootloader
 attribute console makej
    source $KERNEL_URL pub/linux/utils/boot/syslinux/syslinux-$VERSION.tar.bz2
      info last  20110613
      info home  http://syslinux.zytor.com/wiki/index.php/The_Syslinux_Project
      desc 'bootloader for Linux that works on FAT and ISO9660 filesystems'

build(){
 case $VERSION in
  4.04) unset LDFLAGS ;;
  4.03) unset LDFLAGS ;;
  4.01) unset LDFLAGS ;;
 esac

# The following sed statement allows syslinux to compile on x86_64
# sed -i 's:dos/syslinux.com::
#         s:dos::
#         s:com32::
#         s:memdisk/memdisk::
#         s:memdisk::
#         s:win32/syslinux.exe::
#         s:win32::
#         s:/sbin:/usr/sbin:
#         /INSTALL_AUX_OPT/d
#         /-C  install/d' Makefile

 sed -i '/INSTALL_AUX_OPT/d
         s:win32/syslinux.exe::' Makefile

 make &&
 make install INSTALLROOT=$DESTDIR DESTDIR=$DESTDIR
}
