       url 'http://www1.mplayerhq.hu/MPlayer/
            http://www2.mplayerhq.hu/MPlayer/
            http://ftp3.mplayerhq.hu/MPlayer/
            http://ftp5.mplayerhq.hu/MPlayer/
             ftp://ftp1.mplayerhq.hu/MPlayer/
             ftp://ftp2.mplayerhq.hu/MPlayer/
             ftp://ftp3.mplayerhq.hu/MPlayer/
             ftp://ftp5.mplayerhq.hu/MPlayer/'

if [[ $SPELL == MPlayer ]]; then
    stable 1.0rc2 1.0rc1
    secure 1.0rc2

# mplayer 1.0rc2 will not compile with x264 snapshot-20081001-2245
case $VERSION in
 1.0rc2)
      opts --disable-x264 ;;
esac
   require gtk+ a52dec libXv libXxf86dga libdvdread giflib lzo popt unzip w32codec
  optional MPlayer-Skin '' '' to install skins for GUI
  optional MPlayer-font '' '' to install fonts
  optional SDL --enable-sdl --disable-sdl to use SDL audio/video output
  optional XviD '' --disable-xvid for encoding movies to XviD format
  optional aalib --enable-aa --disable-aa for ascii art video output rendering
  optional alsa-lib '' --disable-alsa for alsa sound support
  optional cdparanoia '' --disable-cdparanoia for playing/reading audio CDs
  optional esound '' --disable-esd for sound output through esound
  optional faac '' --disable-faac for faac codec support
  optional faad2 --enable-faad-external '' for aac decoding support
  optional freetype '' --disable-freetype for anti-aliased osd/subs support
  optional fribidi '' --disable-fribidi for bidirectional unicode text
  optional jackit '' --disable-jack for jackit audio mixer output support
  optional ladspa_sdk '' --disable-ladspa for audio processor plugin
  optional libcdio '' --disable-libcdio for controlling the CD/DVD device
  optional libdv '' --disable-libdv a software codec for digital video camcorders
  optional libmad '' --disable-mad for playing mpeg audio formats
  optional libtheora '' --disable-theora for theora codec support
  optional libvorbis '' --disable-vorbis for ogg vorbis audio codec support
  optional lirc --enable-lirc --disable-lirc to enable LIRC remote control support
  optional musepack '' --disable-musepack for musepack audio encoder
  optional nas '' --disable-nas for nas audio mixer support
  optional openal '' --disable-openal for audio output through openal libraries
  optional samba --enable-smb --disable-smb for samba SMB input support
  optional speex '' --disable-speex for speex audio codec support
  optional svgalib '' --disable-svga for output through svgalib
  optional x264 '' --disable-x264 for H.264 codec support
  optional xmms --enable-xmms '' to build with XMMS input plugin support

  switch --enable-joystick '' for joystick support


 use_gcc gcc-v4.2          # for 1.0rc2
    opts --disable-ivtv    # for 1.0rc2

    source releases/MPlayer-$VERSION.tar.bz2
       url http://www.mplayerhq.hu/MPlayer/patches/
    source demux_audio_fix_20080129.diff
    source demux_mov_fix_20080129.diff
    source url_fix_20080120.diff
    source stream_cddb_fix_20080120.diff
 freshmeat mplayer
fi

  category video/dvd video/player
 attribute x11
  homepage http://www.mplayerhq.hu
  estimate 3000
      desc 'MPlayer is a movie and animation player.
MPlayer is a movie and animation player that supports a wide
range of file formats, including ASF, Quicktime, and Vivo.
It has many MMX/SSE/3Dnow optimized native audio and video
codecs, but allows using XAnim binary codec plugins, and
Win32 codec DLLs.
It has basic VCD/DVD playback functionality, including DVD
subtitles, but supports many text-based subtitle formats too.
For video output, nearly every existing interface is supported.
It is also able to convert any supported files to raw/divx/mpeg4
AVI (pcm/mp3 audio), and even video grabbing from V4L devices.'

case ${SPELL:8} in
 Skin-*) 
    stable 1.0
    source skins/${SPELL:13}-$VERSION.tar.bz2
   provide MPlayer-Skin
      desc "$SPELL provides a Skin for MPlayer's GUI."
  attribute data
   estimate 5 ;;
 font-*)
    stable 1.0
    source releases/fonts/${SPELL:8}.tar.bz2
  EPROVIDE="MPlayer-font"
      desc "$SPELL provides a default font for MPlayer's GUI."
  attribute data
   estimate 5 ;;
esac


build(){
 install_mplayer(){
  install_conf(){
   mkdir -p doc
   mv   etc doc
   cd       doc/etc

   sed -i "s:include =:# include =:; s:# vo=:vo=:; s:# ao=:ao=:" example.conf
   mkdir -p /etc/mplayer

   for FILE in *.conf
   do  install -m 0644 -o root -g root $FILE /etc/mplayer
   done
  }

  patch -p0 < ${SOURCE[1]}
  patch -p0 < ${SOURCE[2]}
  patch -p0 < ${SOURCE[3]}
  patch -p0 < ${SOURCE[4]}

  unset CFLAGS CXXFLAGS

  echo                            |
  ./configure                     \
  --prefix=/usr                   \
  --enable-gui                    \
  --confdir=/etc/mplayer          \
  --enable-menu                   \
  --enable-largefiles             \
  --win32codecsdir=/usr/lib/win32 \
  --realcodecsdir=/usr/lib/win32  \
  --xanimcodecsdir=/usr/lib/win32 \
  --codecsdir=/usr/lib/win32      \
  $OPTS                           &&
  make                            &&
  prepare_install                 &&
  make    install prefix=/usr     &&
  install_conf
}

 install_skin(){
  BASE=$( basename $BUILD_DIR )
  SKIN="/usr/share/mplayer/skins/$BASE"
  chmod a+r *       &&
  prepare_install   &&
  mkdir -p    $SKIN &&
  cp    -Rv * $SKIN &&
  if ! [ -h        /usr/share/mplayer/skins/default ]
  then ln -s $BASE /usr/share/mplayer/skins/default
  fi
 }

 install_font(){
  FONT="/usr/share/mplayer/fonts"
  chmod a+r *       &&
  prepare_install   &&
  mkdir -p    $FONT &&
  cp    -Rv * $FONT
 }


 case ${SPELL:8} in
  Skin-*) install_skin    ;;
  font-*) install_font    ;;
       *) install_mplayer ;;
 esac
}


current(){
 case $VERSION in
  1.0rc2) grep -qsx 'patching file stream/stream_cddb.c' $COMPILE_LOGS/MPlayer ;;
 esac
}
