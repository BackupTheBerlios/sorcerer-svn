   VERSION=( "3.0.22" "3.0.21c" "3.0.21b" "3.0.21a" "3.0.21" "3.0.20b" "3.0.20a" "3.0.20" )
      SAFE=( "3.0.22" )
    IGNORE="txt\|atest\|pre"
# 3.0.20b has compile errors"
  CATEGORY="network"
 ATTRIBUTE="server console"
    SOURCE="samba-$VERSION.tar.gz"
       URL="http://us5.samba.org/samba/ftp/
            http://us2.samba.org/samba/ftp/
            http://us3.samba.org/samba/ftp/
            http://us4.samba.org/samba/ftp/
             ftp://au1.samba.org/pub/samba/
             ftp://ca.samba.org/
             ftp://de.samba.org/samba.org/
             ftp://ftp.easynet.be/samba/
             ftp://ftp.k2.net/mirrors/samba/
             ftp://ftp.oss.eznetsols.org/samba/
             ftp://ftp.te8.com/pub/samba/
             ftp://ftp.ucr.ac.cr/pub/Unix/samba/
             ftp://gd.tuwien.ac.at/infosys/servers/samba/
             ftp://giswitch.sggw.waw.pl/pub/unix/samba/
             ftp://it.samba.org/pub/samba/
             ftp://mirror.kn.vutbr.cz/pub/MIRRORS/samba/
             ftp://pl.samba.org/pub/unix/net/samba/
             ftp://ru.samba.org/pub/samba/
             ftp://se.samba.org/pub/samba/
            http://sambafr.idealx.org/samba/ftp/
            http://us1.samba.org/samba/ftp/"
  HOMEPAGE="http://www.samba.org/"
       REQ=( "e2fsprogs ncurses popt readline"
             "Linux-PAM:--with-pam --with-pam_smbpass:--without-pam:for pluggable authentication"
             "cups::--disable-cups:for printing support"
             "heimdal:::for kerberos support"
             "openldap:--with-ldap --with-ldapsam:--without-ldap:for connecting with ldap servers"
             "openssl:::for encrypted communication"
             "xinetd:::for running samba web administration tool" )
  ESTIMATE="737"
      DESC="samba provides seamless file and print services to SMB/CIFS clients.
samba provides Windows NT and LAN manager-style
file and print services to SMB clients such as Windows."

build() {
  if    spell_installed  Linux-PAM
  then  WITH_PAM="--with-pam  --with-pam_smbpass"
  fi

  case  $VERSION  in
    3.0.20)   sed  -i  "/DONT_USE_CPLUSPLUS_RESERVED_NAMES/d"  source/include/includes.h  ;;
    3.0.20a)  sed  -i  "/DONT_USE_CPLUSPLUS_RESERVED_NAMES/d"  source/include/includes.h  ;;
  esac

  cd  source
  ./configure           \
  --prefix=/usr         \
  --sysconfdir=/etc     \
  --localstatedir=/var  \
  --with-smbmount       \
  --with-fhs            \
  $WITH_PAM             \
  $OPTS                 &&
  make                  &&
  prepare_install       &&
  mkdir  -p  /etc/samba        &&
  mkdir  -p  /usr/share/samba  &&
  mkdir  -p  /var/log/samba    &&
  make    install              &&
  rm     -rf /usr/private      &&
  if  [  -f  /usr/lib/samba/libsmbclient.so  ]   &&
    ! [  -f  /usr/lib/libsmbclient.so        ];  then
    ln   -s     samba/libsmbclient.so  /usr/lib/libsmbclient.so
    ln   -s     samba/libsmbclient.so  /usr/lib/libsmbclient.so.0
   fi
}
