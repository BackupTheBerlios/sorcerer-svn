# 3.2.1 gained compilation on avahi

  unstable 4.0.0alpha6
    stable 3.3.3 3.3.2 3.3.1 3.3.0 3.2.7 3.2.6 3.2.5 3.2.4 3.2.3 3.2.2 3.2.1 3.2.0
    secure 3.0.30
   require avahi e2fsprogs init-functions keyutils ncurses popt readline
  optional Linux-PAM '--with-pam --with-pam_smbpass' --without-pam  for pluggable authentication
  optional cups      ''                              --disable-cups for printing support
  optional dmapi     ''                              ''             for dmapi support
  optional gamin     ''                              ''             for file change notification and gamin can also be used
  optional heimdal   ''                              ''             for kerberos support
  optional libcap    ''                              ''             for POSIX capabilities support
  optional openldap  '--with-ldap --with-ldapsam'    --without-ldap for connecting with ldap servers
  optional openssl   ''                              ''             for encrypted communication
  optional xinetd    ''                              ''             for running samba web administration tool
  category network
 attribute server console
       url 'http://us5.samba.org/samba/ftp/
            http://us2.samba.org/samba/ftp/
            http://us3.samba.org/samba/ftp/
            http://us4.samba.org/samba/ftp/
             ftp://au1.samba.org/pub/samba/
             ftp://ca.samba.org/
             ftp://de.samba.org/samba.org/
             ftp://ftp.easynet.be/samba/
             ftp://ftp.k2.net/mirrors/samba/
             ftp://ftp.oss.eznetsols.org/samba/
             ftp://ftp.te8.com/pub/samba/
             ftp://ftp.ucr.ac.cr/pub/Unix/samba/
             ftp://gd.tuwien.ac.at/infosys/servers/samba/
             ftp://giswitch.sggw.waw.pl/pub/unix/samba/
             ftp://it.samba.org/pub/samba/
             ftp://mirror.kn.vutbr.cz/pub/MIRRORS/samba/
             ftp://pl.samba.org/pub/unix/net/samba/
             ftp://ru.samba.org/pub/samba/
             ftp://se.samba.org/pub/samba/
            http://sambafr.idealx.org/samba/ftp/
            http://us1.samba.org/samba/ftp/'
    source samba-$VERSION.tar.gz
  homepage http://www.samba.org/
  estimate 2800
      desc 'samba provides seamless file and print services to SMB/CIFS clients.
samba provides Windows NT and LAN manager-style
file and print services to SMB clients such as Windows.'

build(){
 case $VERSION in
  3.2.1)   sed -i '/#include <krb5\.h>/a#include <stdlib.h>' source/configure ;;
  3.0.20)  sed -i '/DONT_USE_CPLUSPLUS_RESERVED_NAMES/d' source/include/includes.h ;;
  3.0.20a) sed -i '/DONT_USE_CPLUSPLUS_RESERVED_NAMES/d' source/include/includes.h ;;
 esac

 cd source &&
 ./configure          \
 --prefix=/usr        \
 --sysconfdir=/etc    \
 --localstatedir=/var \
 --with-smbmount      \
 --with-fhs           \
 --with-shared-modules=idmap_rid \
 $OPTS &&
 make  &&
 prepare_install &&
 mkdir -p /etc/samba       &&
 mkdir -p /usr/share/samba &&
 mkdir -p /var/log/samba   &&
 make    install           &&
 rm    -rf /usr/private    &&
 if   [ -f  /usr/lib/libsmbclient.so   ] &&
    ! [ -f  /usr/lib/libsmbclient.so.0 ]
 then ln -fs         libsmbclient.so   \
            /usr/lib/libsmbclient.so.0
 fi &&
 if   [  -f  nsswitch/libnss_winbind.so ]
 then cp -av nsswitch/libnss_winbind.so /lib/
 fi
}

current(){
 case $VERSION in
  3.2.1) [ -h /usr/lib/libsmbclient.so.0 ] ;;
 esac
}
