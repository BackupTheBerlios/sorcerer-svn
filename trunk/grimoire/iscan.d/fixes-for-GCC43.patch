--- lib/imgstream.cc.orig	2005-10-11 04:53:38.000000000 +0200
+++ lib/imgstream.cc	2007-10-11 12:29:35.000000000 +0200
@@ -26,6 +26,8 @@
 //  the GNU General Public License in all respects for all of the
 //  code used other then esmod.
 
+#include <cstdlib>
+
 #include <argz.h>
 
 #include "imgstream.hh"
--- lib/jpegstream.cc.orig	2005-07-14 03:03:31.000000000 +0200
+++ lib/jpegstream.cc	2007-10-11 12:29:10.000000000 +0200
@@ -26,6 +26,8 @@
 //  the GNU General Public License in all respects for all of the
 //  code used other then esmod.
 
+#include <cstdlib>
+
 #include "jpegstream.hh"
 
 #include "gettext.h"
--- frontend/pisa_tool.h	(revision 1529)
+++ frontend/pisa_tool.h	(working copy)
@@ -35,12 +35,12 @@
 #include <config.h>
 #include "pisa_structs.h"
 
-template <class type>
-static type similarity ( const type & A,
-			 const type & a,
-			 const type & b )
+template <class Type>
+Type similarity ( const Type & A,
+		  const Type & a,
+		  const Type & b )
 {
-  type B;
+  Type B;
 
   if ( a == 0 )
     return 0;
@@ -53,22 +53,7 @@
   return B;
 }
 
-template <>
-static double similarity <double> ( const double & A,
-				    const double & a,
-				    const double & b )
-{
-  double B;
 
-  if ( a == 0 )
-    return 0;
-
-  B = ( b * A ) / a;
-
-  return B;
-}
-
-
 template <class Type>
 int pt_in_rect ( const _rect <Type> & rect, const _point <Type> & pt )
 {
--- frontend/pisa_tool.cc	(revision 1529)
+++ frontend/pisa_tool.cc	(working copy)
@@ -32,6 +32,21 @@
 #include "pisa_tool.h"
 
 
+template <>
+double similarity <double> ( const double & A,
+			     const double & a,
+			     const double & b )
+{
+  double B;
+
+  if ( a == 0 )
+    return 0;
+
+  B = ( b * A ) / a;
+
+  return B;
+}
+
 /*--------------------------------------------------------------*/
 GtkWidget * xpm2widget ( GtkWidget * widget, char ** xpm_data )
 {
