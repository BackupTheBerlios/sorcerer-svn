   VERSION=(     3.2.2 3.2.1 3.1 3.0 )
#  VERSION=( 3.4 3.2.2 3.2.1 3.1 3.0 )
# version 3.4 exists in a user's directory, but is an official release?
# 3.4 does not compile due to complications created by using
# docbook2man from docbook2X and docbook2man does not work properly.
    IGNORE='pre'
  CATEGORY='kernel'
 ATTRIBUTE='console'
    SOURCE="/pub/linux/utils/kernel/module-init-tools/module-init-tools-$VERSION.tar.bz2"
case  $VERSION  in
  3.4)
    SOURCE="/pub/linux/kernel/people/jcm/module-init-tools/module-init-tools-$VERSION.tar.gz"
  ;;
esac
       URL="$KERNEL_URL"
  HOMEPAGE='ftp://ftp.kernel.org/pub/linux/kernel/people/rusty/modules/FAQ'
       REQ='bison flex init-functions'
      OPTS='--enable-zlib'
# Odd documentation building requirements for version 3.4
# case  $VERSION  in
#   3.[0-2])  :  ;;
#   3.[4-9])  REQ+=' docbook2X docbook-sgml-4.2'  ;;
# esac
## Unfortunately, with requirements installed it still errors:
## docbook2man doc/modprobe.conf.sgml
## I/O error : Attempt to load network entity http://docbook2x.sf.net/latest/xslt/man/docbook.xsl
## warning: failed to load external entity "http://docbook2x.sf.net/latest/xslt/man/docbook.xsl"
## cannot parse http://docbook2x.sf.net/latest/xslt/man/docbook.xsl
## Unable to recognise encoding of this document at 
## /usr/lib/perl5/site_perl/5.8.8/XML/SAX/PurePerl/EncodingDetect.pm line 100.
## Document requires an element [Ln: 1, Col: 0]

## docbook2X really aught to install any xsl sheets it requires.

   EXCLUDE='/etc/modprobe.conf
            /etc/modules
            /etc/modules.conf'
  EPROVIDE='linux-module-tools'
  ESTIMATE='183'
      DESC='module-init-tools provides modules utilities for linux 2.6.x and later kernels'

build() {

remove_static()  {  rm  -f  /sbin/insmod.static;  }
conf_install()   {
  mkdir  -p  /etc/modules.d
  touch      /etc/modules  /etc/modprobe.conf
}

sed  -i  's:share/man/man:man/man:'  Makefile.in

./configure           \
--build=$BUILD        \
--prefix=/            \
--sysconfdir=/etc     \
--localstatedir=/var  \
$OPTS                 &&
make                  &&
prepare_install       &&
make    install       &&
   conf_install       &&
remove_static
}

current() {
  case  $VERSION  in
    3.2.2)  grep  -q  udev  /etc/init.d/modprobe  &&
            !  [  -f  /sbin/insmod.static  ]      ;;
  esac
}


current()  {
  case  $VERSION  in
    3.2.2)  grep  -q  'CONFIG_USE_ZLIB=1'  $COMPILE_LOGS/module-init-tools  ;;
  esac
}
