# online-desktop uses pidgin's libpurple library

   version stable 2.10.1 2.10.0 2.9.0 2.8.0
   version secure 2.10.1
   require avahi farsight2 gst-ffmpeg gst-plugins-ugly gtk+ libXScrnSaver nss startup-notification x264
  optional doxygen               ''                  ''                   for building pidgin documentation
  optional evolution-data-server ''                  --disable-gevolution for evolution plugin
  optional gnutls                --enable-gnutls=yes --enable-gnutls=no   to use gnutls preferred SSL support
  optional gtkspell              ''                  --disable-gtkspell   for automatic spell checking
  optional libao                 ''                  --disable-audio      for audio output
  optional meanwhile             ''                  --disable-meanwhile  for Lotus Notes compatibility
  optional mono                  --enable-mono       ''                   for mono .net compatibility support
  optional firefox               --enable-nss=yes    --enable-nss=no      to use mozilla libnss for SSL support
  optional tcl                   ''                  --disable-tcl        support for tcl scripting
  optional tk                    ''                  --disable-tk tcl     support for tk
# NetworkManager does not compile.
      opts --disable-nm
  category network/chat
 attribute gnome library makej multilib-dual
    source $SOURCEFORGE_URL pidgin/Pidgin/$VERSION/pidgin-$VERSION.tar.bz2
      info last 20111210
      info home http://www.pidgin.im/
 conflicts gaim
      desc 'instant messanger client for several protocols
pidgin is an instant messanger client used primarly
for the AIM protocol but has plugin support for
icq, irc, yahoo, and jabber all at once in one interface.'

build(){
 if     [[ $HOSTTYPE == x86_64        ]]; then
  if  ! [[ $CFLAGS   =~ -m32          ]]; then
   if ! [[ $OPTS     =~ --disable-tcl ]]; then opts --with-tclconfig=/usr/lib64; fi
   if ! [[ $OPTS     =~ --disable-tk  ]]; then opts --with-tkconfig=/usr/lib64; fi
  else
   if ! [[ $OPTS     =~ --disable-tcl ]]; then opts --with-tclconfig=/usr/lib; fi
   if ! [[ $OPTS     =~ --disable-tk  ]]; then opts --with-tkconfig=/usr/lib; fi
   if   [[ $CFLAGS   =~ -m32          ]]; then opts --disable-perl; fi
  fi
 fi
 export   CFLAGS+=" -I/usr/include/nss -I/usr/include/nspr"
 export CXXFLAGS+=" -I/usr/include/nss -I/usr/include/nspr"

 sed -i 's:hardcode_into_libs=yes:hardcode_into_libs=no:' configure

 if   [[ $HOSTTYPE == x86_64 ]] && ! [[ $CFLAGS =~ -m32 ]]
 then export LDFLAGS+=' -Wl,-rpath,/usr/lib64/pidgin -Wl,-rpath,/usr/lib64/purple-2 '
 else export LDFLAGS+=' -Wl,-rpath,/usr/lib/pidgin -Wl,-rpath,/usr/lib/purple-2'
 fi

 default_build
}

current(){
 case $VERSION in
  2.10.1) grep -q '/usr/lib64/pidgin:/usr/lib64/purple-2' $ELF_LOGS/pidgin ||
          grep -q '/usr/lib/pidgin:/usr/lib/purple-2'     $ELF_LOGS/pidgin ;;
 esac
}
