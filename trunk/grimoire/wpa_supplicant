   VERSION=(         0.5.7 0.5.6 0.5.5 0.5.4 0.4.9 )
#  VERSION=( 0.6.0 0.5.7 0.5.6 0.5.5 0.5.4 0.4.9 )
# 0.6.0 requires adjustment to build()
# 0.5.x are developmental
# 0.4.x are stable
  CATEGORY='network/security network/wireless'
 ATTRIBUTE='console utility new'
    SOURCE="wpa_supplicant-$VERSION.tar.gz"
       URL='http://hostap.epitest.fi/releases/'
  HOMEPAGE='http://hostap.epitest.fi/wpa_supplicant'
       REQ='openssl readline ncurses qt-x11-free'
  ESTIMATE='107'
      DESC="wpa_supplicant is a WPA/WPA2 supplicant
wpa_supplicant supports WPA and WPA2 (IEEE 802.11i/RSN).
It is suitable for both desktop/laptop
computers and embedded systems.
Supplicant is the IEEE 802.1X/WPA
component that is used in the client stations.
It implements key negotiation with a WPA
Authenticator and it controls the roaming and
IEEE 802.11 authentication/association of the wlan driver.
wpa_supplicant is designed to be a daemon program
that runs in the background and acts as the backend
component controlling the wireless connection.
It supports separate frontend programs and a text-based
frontend (wpa_cli) is included with wpa_supplicant."

export QTDIR=/usr

create_config() {
  cat > .config << EOF
CONFIG_DRIVER_HOSTAP=y
CONFIG_DRIVER_ATMEL=y
CONFIG_DRIVER_IPW=y
CONFIG_DRIVER_WEXT=y
CONFIG_DRIVER_WIRED=y
CONFIG_IEEE8021X_EAPOL=y
CONFIG_EAP_MD5=y
CONFIG_EAP_MSCHAPV2=y
CONFIG_EAP_TLS=y
CONFIG_EAP_PEAP=y
CONFIG_EAP_TTLS=y
CONFIG_EAP_GTC=y
CONFIG_EAP_OTP=y
CONFIG_EAP_LEAP=y
CONFIG_PKCS12=y
#CONFIG_SMARTCARD=y
CONFIG_CTRL_IFACE=y
CONFIG_READLINE=y
#CONFIG_BACKEND=file
EOF
}

install_examples() {
  cp   -v  *.conf  examples		&&
  cp  -av          examples  doc
}

install_man() {
  for  i  in doc/docbook/*.[0-9]
  do   install -v -m 0644  $i  /usr/share/man/man${i##*.}
  done
}

install_wpa_files() {
  install -v -d       /etc/wpa_supplicant		&&
  install -v -m 0755  wpa_{cli,passphrase,supplicant} 	/usr/bin	&&
  install -v -m 0755  wpa_gui/wpa_gui  			/usr/bin	&&
  install_examples	&&
  install_man	
}

build() {
  export  LDFLAGS="-L/lib -L/lib64 $LDFLAGS"
  create_config    &&
  make             &&
  make wpa_gui     &&
  prepare_install  &&
  install_wpa_files
}
