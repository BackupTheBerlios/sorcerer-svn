# broke due to the boost upgrade

# Version 4.0 of enblend-enfuse compiles only with legacy libpng
# and therefore compiles static libpng and links with it
# instead of using libpng installed in /usr/
 
# absolutly requires lcms
# modify spell to compile static version of lcms and link with it.

   version stable 4.0
   require boost freeglut glew lcms libxmi openexr tiff
  category graphic/utility
 attribute console makej
    source $SOURCEFORGE_URL enblend/enblend-enfuse/enblend-enfuse-$VERSION/enblend-enfuse-$VERSION.tar.gz
    source $SOURCEFORGE_URL libpng/libpng12/1.2.50/libpng-1.2.50.tar.xz
      info good 20120725
      info last 20091213
      info home http://enblend.sourceforge.net/
      desc 'tool for compositing images
Given a set of images that overlap in some irregular way,
Enblend overlays them in such a way that the seam between the images
is invisible or at least very difficult to see.
Enblend does not line up the images for you.
Use a tool like Hugin to do that.'

build(){
 obsolete_libpng(){
  cd libpng-1.2.50 &&
  ./configure --prefix=$PWD/install --enable-static=yes --enable-shared=no &&
  make install &&
  export  LDFLAGS+=" -L$PWD/install/lib" &&
  export   CFLAGS+=" -I$PWD/install/include" &&
  export CXXFLAGS+=" -I$PWD/install/include" &&
  cd ..
 }

 case $VERSION in
  4.0) obsolete_libpng
       export LDFLAGS+=' -lboost_system-mt' ;;
 esac

 default_build
}
