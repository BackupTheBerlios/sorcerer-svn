# 1.2.0 has compile errors
# This game segfaults when a match is launched.
# 1.2.0 released 20060129
# will remain broke forever?

    stable 1.2.0
   require SDL gltext
  category game
 attribute x11
 attribute broke
    source $SOURCEFORGE_URL hponline/Hot%20Potato%20Online/Version%20$VERSION/HotPotatoOnlineSources-v$VERSION.tar.gz
      home http://www.hotpotatoonline.com
      docs http://hponline.sourceforge.net/faq.php
  estimate 50
      desc 'fast paced areana sport game
Players try to explode the opposition using a short-fused potato bomb.
The generated environment can be used to bounce, corner, and surprise foes.
Up to 4 players can confront each other in detailed customized matches.
It is similar to dodgeball with a grenade.'

build(){
  install_potato(){
    mkdir    -p $DESTDIR/usr/{bin,share/games/potato}
    install  -vm 755 HotPotato $DESTDIR/usr/bin
    find  .  -type f | escape_qs | xargs --max-lines=64 chmod 0644
    find  .  -type d | escape_qs | xargs --max-lines=64 chmod 0755
    rm       -f *.cpp *.d *.h *.o Makefile HotPotato
    cp       -av *               $DESTDIR/usr/share/games/potato
    echo     -e "#!/bin/bash\ncd /usr/share/games/potato\n/usr/bin/HotPotato" \
             >   $DESTDIR/usr/bin/run-potato
    chmod    755 $DESTDIR/usr/bin/run-potato
  }

 sed -i "s:-O2:$CXXFLAGS:
         s:-lGL :-L/usr/X11R6/lib -lGL :" Makefile
 make &&
 install_potato
}
