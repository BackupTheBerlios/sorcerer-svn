#!/bin/bash
# Copyright 2000 through 2011 by Kyle Sallee,
# All rights reserved.
# For use with the distribution Sorcerer only.
# alien examines parts of the filesystem
# where the installed files are expected
# to belong to installed spells.
# Then, it reports files that are found which
# no installed spell claims ownership.

. /etc/sorcery/config

export LC_ALL=C
trap : SIGHUP SIGINT SIGQUIT SIGILL SIGABRT SIGSTOP SIGTERM

renice 19      -p $$ &>/dev/null
ionice -c2 -n7 -p $$ &>/dev/null

DIRS='/bin /boot /etc /lib /sbin /usr /var /opt'; [[ -d /lib64 ]] &&
DIRS+=' /lib64'

     find $INSTALL_LOGS -type f | xargs -r --max-lines=64 cat | sed p |
pipe find $DIRS |
sed '\,^/etc/sorcery/,d
     \,^/lib/modules/,d
     \,^/usr/src/,d
     \,^/var/cache/,d' |
sort | uniq -u |
filter exclude |
filter protect |
files
