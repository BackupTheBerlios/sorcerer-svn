   VERSION=( 2.13.0.1 2.13 )
  CATEGORY='utility'
 ATTRIBUTE='console'
    SOURCE="/pub/linux/utils/util-linux-ng/v${VERSION:0:4}/util-linux-ng-$VERSION.tar.bz2"
       URL="$KERNEL_URL"
  HOMEPAGE='ftp://ftp.kernel.org/pub/linux/utils/util-linux-ng/'
# Should util-linux have an absolute requirement upon udev?
       REQ=( 'e2fsprogs gettext ncurses udev zlib'
             ':--enable-arch::to build arch'
             ':--enable-write::to build write'
             ':--localtime:--utc::Hardware clock uses localtime'
             'Linux-PAM:--with-pam:--without-pam:for pluggable authentication'
             'libselinux:--with-selinux:--without-selinux:for selinux support'
             'nfs-utils:::to mount NFS filesystems' )
# sysvinit:/usr/bin/wall
      OPTS='--disable-wall'
   PROTECT='/usr/bin/column
            /usr/bin/renice'
   EXCLUDE='/etc/fstab
            /etc/mtab'
  EPROVIDE='schedutils'
 CONFLICTS='util-linux-dev util-linux-ng'
  ESTIMATE='700'
      DESC='util-linux contains essential utilities.
util-linux-ng (based on version 2.13-pre7 of util-linux)
is a suite of essential utilities for any Linux system.

It contains the following programs:
agetty arch blockdev cal cfdisk chfn chkdupexe chsh clear col colcrt
colrm column ctrlaltdel cytune ddate dmesg elvtune fastboot fasthalt
fdformat fdisk fsck.cramfs fsck.minix getopt halt hexdump hwclock
initctl ipcrm ipcs isosize kill last line logger login look mcookie
mesg mkfs mkfs.bfs mkfs.cramfs mkfs.minix mkswap more mount namei need
passwd pg pivot_root ramsize raw rdev readprofile reboot rename renice
rescuept reset rev rootflags script setfdprm setsid setterm sfdisk
shutdown simpleinit sln swapoff swapon tunelp ul umount vidmode vipw
wall whereis write.'

build()  {
  if    echo  "$OPTS"  |  grep  -q  "\--localtime"
  then  sed  -i  "s:--utc:--localtime:"  $SCRIPT_DIR/init.d//hwclock
  else  sed  -i  "s:--localtime:--utc:"  $SCRIPT_DIR/init.d//hwclock
  fi

  OPTS="${OPTS/--utc/}"
  OPTS="${OPTS/--localtime}"

  default_build
}

# post_install can be removed in 2008
# post_install corrects a bug when configuring util-linux
# with old versions of sorcery
# -Kyle

post_install()  {
  default_post_install
  if       [  -f  /etc/init.d/proc  ]  &&
        !  [  -x  /etc/init.d/proc  ]
  then  sed   -i  '/^proc$/d;/^sys$/d'  $BOOT_OFF_LOGS/util-linux
        echo  -n  'proc\nsys'  >>        $BOOT_ON_LOGS/util-linux
        chmod 0700  /etc/init.d/{proc,sys}
        /lib/lsb/install_initd
  fi
}

current()  {
  case  $VERSION  in
    2.13.0.1)  [  -f  /etc/init.d/devpts  ]  ;;
  esac
}
