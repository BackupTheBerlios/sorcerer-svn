# Some dumb sources find /usr/lib/libreadline.a
# and assume there is no /lib/libreadline.so.*
# Not all of those dumb sources are capable of
# compiling and linking with libreadline.a
# such as lftp


   version stable 6.2.001 6.2 6.1.002
   require ncurses
      opts --exec-prefix= --enable-shared=yes
# Static libraries for a statically linked bash?
#     opts --enable-static=no
      opts --with-curses
#     opts --disable-rpath
# I wish --disable-rpath was obeyed

  category development
 attribute console library solo
#   source ftp://ftp.gnu.org/gnu/readline/readline-${VERSION:0:3}.tar.gz
    source ftp://ftp.cwru.edu/pub/bash/readline-${VERSION:0:3}.tar.gz

 case $VERSION in
    6.[1-2].*) PATCHES=${VERSION:6:1}
     for ((SCX=1; SCX <= PATCHES; SCX++))
     do source ftp://ftp.gnu.org/gnu/readline/readline-${VERSION:0:3}-patches/readline${VERSION:0:1}${VERSION:2:1}-00$SCX
     done ;;
 esac

      info last  20110427
  homepage http://cnswww.cns.cwru.edu/php/chet/readline/rltop.html
    CFLAGS='-O2'
   LDFLAGS='-Wl,-O1'
 freshmeat gnureadline
      desc 'library for editing command lines while they are being typed
The readline library provides a set of functions for use by
applications that allow users to edit command lines as they are typed.
Both Emacs and vi editing modes are available.
The Readline library includes additional functions to
maintain a list of previously-entered command lines,
to recall and perhaps reedit those lines, and perform
csh-like history expansion on previous commands.'

build(){
 # because readline is not properly not adding a rpath although instructed
 sed -i 's:enable_rpath=yes:enable_rpath=no:' aclocal.m4
 sed -i 's:-Wl,-rpath,$(libdir) ::' support/shobj-conf

 export LDFLAGS+=" -lncurses $CFLAGS"

 default_build &&
 mkdir -p $DESTDIR/etc &&
 install -m 644 -o root -g root $SCRIPT_DIR/inputrc $DESTDIR/etc
}

current(){
 case $VERSION in
  6.1.002) grep -q ncurses $ELF_LOGS/readline ;;
 esac
}
