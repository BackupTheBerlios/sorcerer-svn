    stable 6.1.002 6.1.001 6.1
#     opts --disable-rpath
# I wish --disable-rpath was obeyed

  category development
 attribute console library solo
    source ftp://ftp.gnu.org/gnu/readline/readline-${VERSION:0:3}.tar.gz
#   source ftp://ftp.cwru.edu/pub/bash/readline-${VERSION:0:3}.tar.gz

 case $VERSION in
    6.1.*) PATCHES=${VERSION:6:1}
     for ((SCX=1; SCX <= PATCHES; SCX++))
     do source ftp://ftp.gnu.org/gnu/readline/readline-${VERSION:0:3}-patches/readline${VERSION:0:1}${VERSION:2:1}-00$SCX
     done ;;
 esac

  homepage http://cnswww.cns.cwru.edu/php/chet/readline/rltop.html
    CFLAGS='-O3'
   LDFLAGS='-Wl,-O1'
 freshmeat gnureadline
  estimate 400
      desc 'library for editing command lines while they are being typed
The readline library provides a set of functions for use by
applications that allow users to edit command lines as they are typed.
Both Emacs and vi editing modes are available.
The Readline library includes additional functions to
maintain a list of previously-entered command lines,
to recall and perhaps reedit those lines, and perform
csh-like history expansion on previous commands.'

build(){
 # Other sources configure scripts check only for
 # the location of ar libraries.
 # Therefore, symbolic links to ELF libraries
 # must exist in the same directory as the ar libraries

 move_ar_libs(){
  if   [ -f $DESTDIR/lib/libreadline.a ]; then
   mkdir -p $DESTDIR/usr/lib
   mv       $DESTDIR/lib/*.a $DESTDIR/usr/lib/
  elif [ -f $DESTDIR/lib64/libreadline.a ]; then
   mkdir -p $DESTDIR/lib64
   mv       $DESTDIR/lib64/*.a $DESTDIR/usr/lib64/
  fi
 }

 ## cast automatically patches
 #CX=1
 #while [[ -n  ${SOURCE[$CX]} ]]; do
 # patch -p0 < ${SOURCE[$CX]}
 # (( CX++ ))
 #done

 if   [[ $HOSTTYPE == x86_64 ]]
 then LIBDIR=/lib64
 else LIBDIR=/lib
 fi

# because readline is not properly not adding a rpath although instructed
 sed -i 's:enable_rpath=yes:enable_rpath=no:' aclocal.m4
 sed -i 's:-Wl,-rpath,$(libdir) ::' support/shobj-conf

 ./configure      \
 --prefix=/usr    \
 --libdir=$LIBDIR \
 $OPTS            &&
#make    shared   &&
 make             &&
 make install DESTDIR=$DESTDIR &&
 move_ar_libs     &&
 mkdir -p $DESTDIR/etc &&
 install -m 644 -o root -g root $SCRIPT_DIR/inputrc $DESTDIR/etc
}
