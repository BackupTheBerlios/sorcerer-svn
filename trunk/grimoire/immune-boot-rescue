   version stable 20111212 20110907
   require uniso
  category immune-system
 attribute archive_off console
case $HOSTTYPE in
 x86_64)
    source http://sorcerer.silverice.org/download/iso9660/${VERSION:0:4}/sorcerer-x86_64-$VERSION.iso ;;
      *)
    source http://sorcerer.silverice.org/download/iso9660/${VERSION:0:4}/sorcerer-i686-SMP-$VERSION.iso ;;
esac
      info last 20111212
      info home http://sorcerer.silverice.org/
      desc "faulty initramfs protection

If recently generated initramfs become unusable for booting
then the rescue label can be booted instead.
The rescue label is created from
the linux and initramfs that are provided
on a Sorcerer Install/Rescue CD."

build(){
 mkdir -pvm 755 $SOURCE_DIR/$SPELL
 cd             $SOURCE_DIR/$SPELL
 isoinfo -l -R -i $SOURCE |
 uniso      -R -i $SOURCE
 mkdir -pvm 700 $DESTDIR/boot/rescue
 if   [ -f /etc/init.d/extlinux    ] &&
      [ -x /etc/init.d/extlinux    ] &&
      [ -f /boot/extlinux/menu.c32 ]
 then cp -aL boot/*/{System.map,initrf,linux,modules} $DESTDIR/boot/rescue/
 else echo "Supported only with extlinux, sorry." 1>&2; return 1
 fi

 [ -f $DESTDIR/boot/rescue/linux ]
}
