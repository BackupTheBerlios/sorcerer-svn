# Entry into
# <kernel> /domain/freedom
# <kernel> /media/root/domain/freedom
# permitted with authenticated using password

if [ -f /etc/tomoyo/sorcerer/userpass ] &&
   [ -s /etc/tomoyo/sorcerer/userpass ] && /bin/grep -q "^$USER" \
        /etc/tomoyo/sorcerer/userpass
then
 read -t 60 -s -p Password:
 PASS="$( /bin/md5crypt <<< "$REPLY" )"
 if /bin/grep -qx "$USER:$PASS" /etc/tomoyo/sorcerer/userpass; then
  if   [ -n "$1" ]
  then PROG="$1"; shift 1; exec $PROG "$@"
  else exec /bin/bash -l
  fi
 fi
fi
