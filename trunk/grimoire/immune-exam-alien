# Copyright Kyle Sallee 2011
# All rights reserved.
# For use with the distribution sorcerer only!

version_year_week

  category immune-system
 attribute archive_off solo stale
  homepage http://sorcerer.silverice.org/
 conflicts sorcery-alien
      desc "alien file identification

Files with unknown origin gain symbolic links in /var/cache/alien/
This exam runs automatically with a frequency no greater than weekly.

Alien files can cause problems.
Yet removing aliens might also cause problems.
Prior to removal
alien files should be moved to a directory such as /root/alien/
If removal of the alien file causes problems
then the the alien file can be restored to it's former location."


build(){
 [[     -x /usr/libexec/bash/ln ]] &&
 enable -f /usr/libexec/bash/ln ln

 mkdir -pvm 755           $DESTDIR/var/cache
 mkdir -pvm 700           $DESTDIR/var/cache/alien
 bash $SCRIPT_DIR/alien > $DESTDIR/var/cache/alien/aliens.txt
 dirnames               < $DESTDIR/var/cache/alien/aliens.txt |
 sed                 "s:^:$DESTDIR/var/cache/alien:" |
 escape_qs |
 xargs -r --max-lines=256 mkdir -p

 while read
 do ln -s "$REPLY"       "$DESTDIR/var/cache/alien/$REPLY"
 done                   < $DESTDIR/var/cache/alien/aliens.txt
}
