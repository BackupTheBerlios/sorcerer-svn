# Compiles and installs fine, but segmentation faults when run.

   version stable 0.03
   require MesaLib SDL_image SDL_net boost freetype
  category game
 attribute broke
 attribute makej x11
    source $SOURCEFORGE_URL stunt-coureur/src/stuntcoureur-$VERSION.tar.bz2
      info home  http://stunt-coureur.sourceforge.net/
      info irc   IRC: #stuntcoureur@irc.freenode.org
      info mail  bob[dot]winckelmans[at]telenet[dot]be
      desc 'Bullet Physics based racing game loosely inspired by Stunts
Pure client-server multiplayer is supported.'

build(){
 make_install(){
  mkdir  -pvm 755 $DESTDIR/usr/{bin,share}
  install -vm 755 src/stuntcoureur $DESTDIR/usr/bin/
  cd ..
  find share -type d | xargs -r --max-lines=256 chmod 755
  find share -type f | xargs -r --max-lines=256 chmod 644
  cp -av share/stuntcoureur $DESTDIR/usr/share/
  echo -e "#!/bin/bash\ncd /usr/bin\n ./stuntcoureur \"\$@\"" \
      > $DESTDIR/usr/bin/stuntc
  chmod 755 $DESTDIR/usr/bin/stuntc
 }

 case $VERSION in
  0.03) sed -i 's:leaf():path().filename().string():' src/filesystem/be_dir.cpp ;;
 esac
 default_build &&
 make_install
}
