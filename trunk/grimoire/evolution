   VERSION=( 2.22.1.1 2.22.1 2.22.0 )
    IGNORE='^2\.23\.\|data-server\|webcal\|exchange\|caldav\|jescs\|scalix'
 DBVERSION='3.1.17'
  CATEGORY='network/email'
 ATTRIBUTE='client gnome'
    SOURCE=( "sources/evolution/${VERSION:0:4}/evolution-$VERSION.tar.bz2"
             "db-$DBVERSION.tar.gz" )
       URL=( "$GNOME_URL"
             "ftp://ftp.sleepycat.com/releases/" )
#            "http://ftp.sleepycat.com/update/snapshot/" )
  HOMEPAGE='http://www.ximian.com/products/ximian_evolution'
   PROVIDE='email-client'
       REQ=( 'evolution-data-server gtkhtml gstreamer libnotify psmisc' )
#            'mozilla:--enable-nss=yes --with-nspr-includes=/usr/include/mozilla/nspr --with-nspr-libs=/usr/lib/mozilla --with-nss-includes=/usr/include/mozilla/nss --with-nss-libs=/usr/lib/mozilla::to use mozilla's nss/nspr for ssl support' )
  ESTIMATE='20000'
      DESC='evolution by Ximian is an information management solution.
evolution Ximian Evolution^(TM), is a personal
and workgroup information management solution.
The software seamlessly integrates email,
calendaring, meeting scheduling, contact management
and online task lists in a single application.'

build(){

 OPTS+=" --with-db3=$BUILD_DIR/evolution-db3"

 mkdir evolution-db3               &&
 cd db-$DBVERSION/build_unix       &&
 ../dist/configure                 \
 --prefix=$BUILD_DIR/evolution-db3 \
 --disable-dynamic &&
 make              &&
 make  install     &&

 cd  $BUILD_DIR    &&

 export LDFLAGS+=' -L/usr/lib/mozilla -Wl,-rpath,/usr/lib/mozilla -Wl,-rpath-link,/usr/lib/mozilla'
 ./configure          \
 --prefix=/usr        \
 --sysconfdir=/etc    \
 --localstatedir=/var \
 --disable-gtk-doc    \
 $OPTS                &&
 make                 &&
 prepare_install      &&
 make    install
}


# why is hicolor-icon-theme reinstalled after evolution?
post_install(){
 if   is_installed       hicolor-icon-theme
 then echo hicolor-icon-theme | pipe_queue $CAST_QUEUE com
 fi
}
