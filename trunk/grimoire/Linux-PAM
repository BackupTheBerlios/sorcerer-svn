# Sat May 12 22:00:00 UC 2012
# http://www.kernel.org/pub/linux/libs/pam/library/
# the above directory is empty.
# modern releases for Linux-PAM nowhere to be found.
# Linux-PAM might be deprecated?
# considering switching to openpam

   version stable 1.1.4 1.1.3 1.1.2 1.1.1
  optional cracklib   ''             --disable-cracklib for password checking library
  optional db         --enable-db=db --enable-db=no     for userdb support
  optional libxcrypt '' '' for blowfish encrypted passwords
# optional libxcrypt '' '' for passwords that blow fish
      opts --enable-read-both-confs
      opts --disable-nis
  sys_user auth
  category security/authentication
 attribute library makej multilib-concurrent
    source $KERNEL_URL pub/linux/libs/pam/library/Linux-PAM-$VERSION.tar.bz2
      info last 20110625
      info home http://www.kernel.org/pub/linux/libs/pam
      info vurl ftp://ftp.kernel.org/pub/linux/libs/pam/library/

# /lib and /lib64 reserved for ELFs required for booting box
# not necessarily ELFs required for login and authentication.

# If the root filesystem can not be mounted
# login must be possible from the initramfs
   protect /etc/security
 freshmeat linux-pam
 conflicts libtirpc
  eprovide PAM
      desc 'pluggable authentication mechanism

For additional Linux-PAM modules
that are not provided with Linux-PAM please see:
http://www.kernel.org/pub/linux/libs/pam/modules.html'

build(){
 adjust_unix_chkpwd(){
  chown root:auth $DESTDIR/sbin/unix_chkpwd
  chmod 2755      $DESTDIR/sbin/unix_chkpwd
 }

 if   [[ $HOSTTYPE == x86_64 ]] && ! [[ $CFLAGS =~ -m32 ]]
 then opts --libdir=/lib64 --enable-securedir=/lib64/security
 else opts --libdir=/lib   --enable-securedir=/lib/security
 fi

 export HAVE_SGML2LATEX=no
 sed -i 's: doc examples::g' Makefile.in

 sed -i '1i#define HAVE_DBM' modules/pam_userdb/pam_userdb.c
 default_build &&
 adjust_unix_chkpwd
}

post_install(){
 default_post_install
          get_provider pam_ldap |
 pipe     show_installed        |
 LC_ALL=C sort | uniq -d        |
          pipe_queue $CAST_QUEUE
}
