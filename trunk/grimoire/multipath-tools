# Remember to update the patch for the config file
# when updating to newer versions
# removing the library attribute from this until
# anything except itself requires it's ELF libraries.

   version stable 0.4.9
   require LVM2 libaio ncurses readline udev
  category disk
 attribute console makej
    source http://christophe.varoqui.free.fr/multipath-tools/multipath-tools-$VERSION.tar.bz2
  homepage http://christophe.varoqui.free.fr/
      desc 'multipathed storage environment (FC, SAN,...)
The multipath term simply means that
a host can access a LU by multiple paths,
the path being a route from one host HBA port
to one storage controller port.'

build(){
case $VERSION in
 0.4.8) patch -p1 < $SCRIPT_DIR/kpartx.rules.diff 
        patch -p1 < $SCRIPT_DIR/pid.patch  ;;
esac

make &&
make install DESTDIR=$DESTDIR &&
mkdir -p    $DESTDIR/etc &&
install -vm 644 -o root -g root multipath.conf.annotated $DESTDIR/etc/multipath.conf
}

current(){
 case $VERSION in
  0.4.9) ! grep -q PIDF /etc/init.d/multipathd ;;
 esac
}
