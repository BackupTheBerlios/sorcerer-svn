  stable 0.93.2 0.93.1 0.93 0.92.1
  secure        0.93.1      0.92.1
    IGNORE='rc\|sharp\|RC'
  CATEGORY='network/email security/anti-virus'
 ATTRIBUTE='console'
    SOURCE="clamav/clamav-$VERSION.tar.gz"
       URL="$SOURCEFORGE_URL"
  HOMEPAGE='http://www.clamav.net'
       REQ='bzip2 curl gmp'
      OPTS='--enable-static=no'
  ESTIMATE='900'
      DESC='clamav is an anti-virus toolkit. 
The main purpose of this software is the
integration with mail servers (attachment scanning).
The package provides a flexible and scalable multi-threaded daemon,
a command line scanner, and a tool for automatic updating via Internet.
The programs are based on a shared library distributed with the
Clam AntiVirus package, which you can use with your own software.
Most importantly, the virus database is kept up to date.'


pre_remove(){
              GetFreshClamPid=$( pidof freshclam )
 if [    -n "$GetFreshClamPid" ]; then
                 FreshClamCmdline="$( tr '\0' '\t' < /proc/$GetFreshClamPid/cmdline )"
    kill -15 $GetFreshClamPid
 fi

              GetClamPid=$( pidof clamd )
 if [    -n "$GetClamPid" ]; then
                 ClamdCmdline="$( tr '\0' '\t' < /proc/$GetClamPid/cmdline )"
    kill -15 $GetClamPid
 fi
 
 echo "START_FRESHCLAM=\"$FreshClamCmdline\" 
       START_CLAMD=\"$ClamdCmdline\"" > $SPELL_CONFIG
}


build(){
 mkdir    -p -m 755 /var/empty
 groupadd -K GID_MIN=256 -K GID_MAX=511    clamav                      2>/dev/null
 useradd  -K UID_MIN=256 -K UID_MAX=511 -g clamav -d /var/empty clamav 2>/dev/null

 sed  -i  "s:^Example:# Example:"  etc/*.conf
 default_build
}


post_install(){
 ${START_FRESHCLAM:-:}
 ${START_CLAMD:-:}
 true
}
