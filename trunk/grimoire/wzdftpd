# 0.8.0 and 0.7.2 have a compatibility problem with current PAM?
# 0.8.3 has a perl module which does not install properly.
# 0.8.2 has install errors

   version stable 0.8.3 0.8.2 0.8.1 0.8.0 0.7.2 0.7.1 0.7.0
   version secure 0.8.3
  optional mysql      ''               --without-mysql   for mysql authentication
  optional postgresql ''               --without-pgsql   for postgresql authentication
  optional gnutls     --enable-gnutls  --disable-gnutls  for gnutls ssl
  optional openssl    --enable-openssl --disable-openssl for openssl ssl
  optional perl       --enable-perl    --disable-perl    for perl module support
  optional tcl        ''               --without-tcl     for tcl scripting support
  switch            --enable-ipv6    ''                for experimental IPv6 support
  switch            --enable-utf8    ''                for experimental UTF8 support
  category network/ftp
 attribute server console new
 attribute broke
    source $SOURCEFORGE_URL wzdftpd/wzdftpd-sources/wzdftpd-0.8/wzdftpd-$VERSION.tar.gz
      info home http://wzdftpd.sourceforge.net
  eprovide ftpd
      opts --without-pam
#
# Installing wzdftpd.pm
# make[3]: Entering directory `/usr/src/sorcery/wzdftpd/wzdftpd-0.8.3/libwzd-perl/ext'
# Use of uninitialized value in -d at /usr/lib/perl5/5.8.8/File/Path.pm line 159.
# fileparse(): need a valid pathname at /usr/lib/perl5/5.8.8/File/Path.pm line 160
# make[3]: *** [pure_vendor_install] Error 2
#
case  $VERSION  in
  0.8.3)  OPTS+=' --disable-perl'  ;;
esac
#  Well the above case statement still does not avoid the problem.
# wzdftpd is junk?  Does it ever compile and work as expected?

#            "Linux-PAM:--with-pam:--without-pam:for PAM authentication"
# Linux-PAM support is broke with wzdftpd
      desc 'wzdftpd is modular ftp server.
It supports IPv6, multi-threading, and external scripts.'

build() {
finish_install() {
  install -m 700 -d        $DESTDIR/var/log/wzdftpd
  install -m 700 /dev/null $DESTDIR/etc/wzdftpd/users
  install -m 600           $DESTDIR/etc/wzdftpd/wzd.cfg.sample \
                           $DESTDIR/etc/wzdftpd/wzd.cfg
}

[ -x bootstrap ] &&
   ./bootstrap

# sed  -i  "s:#pid_file = /usr/share/wzdftpd/wzdftpd.pid:pid_file = /var/run/wzdftpd.pid:"  src/wzd.cfg.sample
./configure \
--prefix=/usr \
--sysconfdir=/etc/wzdftpd \
--localstatedir=/var \
$OPTS &&
make &&
make install DESTDIR=$DESTDIR &&
finish_install
}
