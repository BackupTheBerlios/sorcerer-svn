#!/bin/bash

### BEGIN INIT INFO
# Default-Mode: 510
# Required-Start: $local_fs $network run
# Required-Stop: $local_fs $network
# Default-Start: 3 4 5
# Default-Stop: 0 1 2 6
# Short-Description: freshclam updates the clamav definition
### END INIT INFO

. /lib/lsb/init-functions

#PIDF=/var/run/freshclam.pid
SERV=/usr/bin/freshclam
 LOG=/var/log/freshclam
NAME=freshclam
OPTS="-d -c 4 --log $LOG"

start(){
 run(){
  if ! [ -d            $LOG ]; then
   echo  -n      >     $LOG
   chown clamav:clamav $LOG
   chmod 600           $LOG
  fi
  start_daemon -p $PIDF $SERV $OPTS
 }

 if   log_warning_msg "$NAME starting"
 then log_success_msg "$NAME started"
 else log_failure_msg "$NAME not started"; status
 fi  
}

parse "$@"
