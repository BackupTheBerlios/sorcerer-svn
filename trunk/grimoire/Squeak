# No useful programs to run, no mouse picture at startup?
# Squeak 3.9-8 appears useless and/or buggy.
# Perhaps I installed it wrong
# Compile error

    stable 3.9-8 3.7-7
   require MesaLib
  category development/interpreter
 attribute x11
 attribute broke
    source http://ftp.squeak.org/${VERSION:0:3}/unix-linux/Squeak-$VERSION.src.tar.gz
    source http://ftp.squeak.org/${VERSION:0:3}/Squeak${VERSION}.zip
  eprovide Squeak-full Squeak-basic
  homepage http://squeak.org
  estimate 1000
      desc 'Squeak is a SmallTalk Development system.
Squeak is an OpenSource and super-portable implementation of a 
multi-media capable Smalltalk-80 
based object-oriented programming environment.
It is written entirely in Smalltalk and has a 
high-performance VM, created by compiling the 
Smalltalk VM code into efficient and portable C code.
It now uses the Self language Morphic User Interface 
but still provides the original MVC GUI as well.
To run squeak first copy the Image file from /usr/share/squeak 
to your home directory and call the file squeak.image'

build(){
 image_install(){
  cd ../Squeak${VERSION}
  mkdir -p          $DESTDIR/usr/lib/squeak/$VERSION/
  install -vm 644 * $DESTDIR/usr/lib/squeak/$VERSION/
 }

 ini_install(){
  mkdir   -  $DESTDIR/usr/{bin,libexec/squeak}
  mv      -v $DESTDIR/usr/bin/squeak $DESTDIR/usr/libexec/squeak
  install -vm 755 $SCRIPT_DIR/inisqueak $DESTDIR/usr/bin
  install -vm 755 $SCRIPT_DIR/inisqueak $DESTDIR/usr/bin/squeak
 }


[ -d platforms ] &&
mkdir bld &&
cd    bld &&
../platforms/unix/config/configure \
--prefix=/usr &&
#make &&
make    install "DESTDIR=$DESTDIR" &&
  image_install &&
    ini_install
}
