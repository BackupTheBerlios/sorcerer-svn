# akode requires flac 1.1.1 or newer
# libsndfile version 1.0.17 requires flac 1.1.2
# libsndfile version 1.0.17 requires flac 1.1.2 and not flac 1.2.1
# and will not compile with flac 1.1.3
# stable 1.1.4 1.1.3 1.1.2 1.1.0 1.0.4 1.0.3
# stable 1.1.3 1.1.2 1.1.0 1.0.4 1.0.3
# stable 1.1.0 1.1.2 1.0.4 1.0.3
# flac 1.1.1 has compile error
# flac 1.1.2 installs a broken xmms plugin
# libsndfile 1.0.17 is does not compile with flac 1.1.4
# flac 1.2.1 compiled and installed fine

  stable         1.1.2 1.1.0 1.0.4 1.0.3
    IGNORE='^1\.1\.[1-3]\|flac\|123\|win\|beta\|sparc\|ppc\|linux'
  CATEGORY='audio/codec audio/editor'
 ATTRIBUTE='library'
    SOURCE="flac/flac-$VERSION.tar.gz"
       URL="$SOURCEFORGE_URL"
  HOMEPAGE='http://flac.sourceforge.net'
       REQ=( ''
             'id3lib:::to read id3 tags'
             'libogg:::to enable ogg stream support'
             'nasm:--enable-asm-optimizations::for MMX support'
             'xmms:::to build xmms support' )
      OPTS='--enable-static=no'
  ESTIMATE='2600'
      DESC='flac is an open-source, patent-free lossless audio codec.
flac is comprised of 1) libFLAC, a library which implements
reference encoders and decoders, licensed under the GNU Lesser
General Public Licence (LGPL); 2) flac, a command-line program for
encoding and decoding files, licensed under the GNU General Public
License (GPL); 3) metaflac, a command-line program for editing
FLAC metadata, licensed under the GPL; 4) player plugins for XMMS
and Winamp, licensed under the GPL; and 5) documentation, licensed
under the GNU Free Documentation License.'


build(){
 if   grep    flags /proc/cpuinfo |
      grep -q sse
 then OPTS+=' --enable-sse'
 else OPTS+=' --disable-sse'
 fi

 if   grep    flags /proc/cpuinfo |
      grep -q 3dnow
 then OPTS+=' --enable-3dnow'
 else OPTS+=' --disable-3dnow'
 fi

 default_build &&
 case  $VERSION  in
  1.1.2) rm -f /usr/lib/xmms/Input/libxmms-flac.* ;;
 esac
# Do not play flac files with xmms since the plugin of 1.1.2
# causes xmms to crash.  Yes, I know.
# However, flac has been held at 1.0.4 as long as possible.
}
