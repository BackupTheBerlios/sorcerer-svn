   stable 1.3.7 1.3.6 1.3.5
   secure 1.3.7 1.3.6 1.3.5
    IGNORE='svn\|b\|rc'
  CATEGORY='printer'
 ATTRIBUTE='console'
    SOURCE=( "cups/$VERSION/cups-$VERSION-source.tar.bz2"
             "cups/cups-drivers-all-0.3.6.tar.gz" )
  HOMEPAGE='http://www.cups.org'
      VURL='http://www.cups.org/software.php'
       URL=( "http://ftp.easysw.com/pub/
              ftp://ftp.funet.fi/pub/mirrors/ftp.easysw.com/pub/
              ftp://ftp.mpg.goe.ni.schule.de/pub/internet/printing/
              ftp://ftp.ntua.gr/pub/gnu/"
             "$SOURCEFORGE_URL" )
# espgs is needed but can't be placed as a requirement or
# it causes a circuliar requirement loop
       REQ=( 'acl libpng openslp tiff'
             'Linux-PAM:--enable-pam:--disable-pam:for pluggable authentication support'
             'dbus:--enable-dbus:--disable-dbus:for dbus support'
             'heimdal:::for kerberos 5 support'
             'openldap:--enable-ldap:--disable-ldap:for ldap support' )
#            'openssl:--enable-ssl:--disable-ssl:for secure socket connections' )
      OPTS='--without-rcdir'
   EXCLUDE='/etc/cups/certs'
   PROTECT='/etc/printcap'
  EPROVIDE='lpr'
  ESTIMATE='12000'
      DESC='cups provides a portable printing layer.'
   
build(){

 check_for_smb_backend(){
  if spell_installed samba; then  
   echo "Setting smb backend for cups"
   if   ! [ -e                   /usr/lib/cups/backend/smb ]
   then ln  -s /usr/bin/smbspool /usr/lib/cups/backend/smb
   fi
  fi
 }

 if spell_installed Linux-PAM; then OPTS+=' --enable-pam'; fi
 if spell_installed openssl;   then OPTS+=' --enable-ssl'; fi

 OPTS+=' --libdir=/usr/lib'
 case $HOSTTYPE in
  x86_64) OPTS+=64 ;;
 esac

 default_build            &&
 cp    -vR  usr/* /usr    &&
 cp    -vR  var/* /var    &&
 cd         var/cups/conf &&
 mkdir -p   /etc/cups     &&
 cp    -v * /etc/cups     &&
 check_for_smb_backend
}
