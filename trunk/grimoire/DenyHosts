# Will this install properly without a build() ?
# Requires DESTDIR compliant build()

   version stable 2.6 2.5 2.4b
   version secure 2.6
   require Python init-functions openssh tcp_wrappers
 attribute console
 attribute broke
  category security
    source $SOURCEFORGE_URL denyhosts/denyhosts/$VERSION/DenyHosts-$VERSION.tar.gz
      info last 20081207
      info home http://www.denyhosts.net
      info docs http://denyhosts.sourceforge.net/faq.html
      desc 'Python script to help detect and block ssh server attacks.
If you have ever looked at your ssh log you may be alarmed
to see how many hackers attempted to gain access to your server.
Hopefully, none of them were successful
(but then again, how would you know?).
Would not it be better to automatically prevent that
attacker from continuing to gain entry into your system? 
DenyHosts attempts to address the above... and more.'


# do not use build_old since it requires sentinel
build_old(){

 IDIR=/usr/share/denyhosts
 CFILE=denyhosts.cfg

 cat > denyhosts << EOF
#!/bin/bash
export HOSTNAME=\$( hostname )
$IDIR/denyhosts.py  -c /etc/$CFILE \$@
EOF

 sed  -i  "s:bin/denyhosts.py:sbin/denyhosts.py:"  daemon-control-dist
 sed  -i  "s:/usr/share/denyhosts/denyhosts.cfg:/etc/${CFILE}:"  daemon-control-dist  
 sed  -i  "s:^LOCK_FILE:#LOCK_FILE:
           s:^#LOCK_FILE = /var/run:LOCK_FILE = /var/run:"	$CFILE-dist

 prepare_install                          				&&
 install  -m 755 -o 0 -g 0 -d -v             $IDIR/DenyHosts		&&
 install  -m 644 -o 0 -g 0 -v  DenyHosts/*   $IDIR/DenyHosts		&& 
 install  -m 755 -o 0 -g 0 -v  denyhosts.py  $IDIR			&&
 install  -m 644 -o 0 -g 0 -v  setup.py      $IDIR			&&
 install  -m 755 -o 0 -g 0 -v  daemon-control-dist  $IDIR/denyhostsd	&&
 install  -m 755 -o 0 -g 0 -v  denyhosts     /usr/sbin			&&
 install  -m 644 -o 0 -g 0 -v  $CFILE-dist   /etc/$CFILE
}
