# Not obeying instructions to disregard installed java
# which is too new for libreoffice to use.

with version stable 3.6.3 3.6.2 3.6.1
with base    perl--Archive-Zip
with also    --with-java=no --disable-gnome-vfs --disable-gtk --without-java
#     with also --with-java=no --disable-fetch-external
with role    utility/office utility/editor
with trait   archive_off huge noheal no_patcher x11 kde4
if [[ $HOSTTYPE == x86_64 ]]; then
with source  http://download.documentfoundation.org/libreoffice/stable/$VERSION/deb/x86_64/LibO_${VERSION}_Linux_x86-64_install-deb_en-US.tar.gz
else
with source  http://download.documentfoundation.org/libreoffice/stable/$VERSION/deb/x86/LibO_${VERSION}_Linux_x86_install-deb_en-US.tar.gz
fi
case $VERSION in
 3.6.3)
with source  $SOURCEFORGE_URL libpng/libpng12/1.2.50/libpng-1.2.50.tar.xz ;;
 3.6.2)
with source  $SOURCEFORGE_URL libpng/libpng12/1.2.50/libpng-1.2.50.tar.xz ;;
 3.6.1)
with source  $SOURCEFORGE_URL libpng/libpng12/1.2.50/libpng-1.2.50.tar.xz ;;
esac

#    source http://download.documentfoundation.org/libreoffice/src/${VERSION:0:5}/libreoffice-core-$VERSION.tar.xz
#    source http://download.documentfoundation.org/libreoffice/src/${VERSION:0:5}/libreoffice-binfilter-$VERSION.tar.xz
#    source http://download.documentfoundation.org/libreoffice/src/${VERSION:0:5}/libreoffice-dictionaries-$VERSION.tar.xz
#    source http://download.documentfoundation.org/libreoffice/src/${VERSION:0:5}/libreoffice-help-$VERSION.tar.xz
#    source http://download.documentfoundation.org/libreoffice/src/${VERSION:0:5}/libreoffice-translations-$VERSION.tar.xz
with info    last 20121026
with info    docs http://www.libreoffice.org/get-help/documentation/
with info    faq  http://www.libreoffice.org/get-help/faq/
with info    home http://www.libreoffice.org/
with info    mail http://www.libreoffice.org/get-help/mailing-lists/
with info    vurl http://www.libreoffice.org/download/
with info    cite 'fork of openoffice'

build(){
 obsolete_libpng(){
  cd libpng-1.2.50
  ./configure  \
   --prefix=$PWD/installed \
   --libdir=/opt/libreoffice${VERSION:0:3}/program \
   --enable-shared --disable-static &&
  make &&
  make install "DESTDIR=$DESTDIR" &&
  cd ..
 }

 case $VERSION in
  3.6.3) obsolete_libpng ;;
  3.6.2) obsolete_libpng ;;
  3.6.1) obsolete_libpng ;;
 esac

 [ -d DEBS ] &&
 cd   DEBS   &&
 mkdir -pvm 755 $DESTDIR &&
 find * -type f -name \*.deb |
 while read
 do    ar x $REPLY data.tar.gz; tar -C $DESTDIR -xvf data.tar.gz || return 1
 done
}
