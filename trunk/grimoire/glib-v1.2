# evms requires static glib-v1.2 installed
#     opts --enable-static=no

    stable 1.2.10
   require pkgconfig
  category development
 attribute library
    source ftp://ftp.gtk.org/pub/gtk/v1.2/glib-$VERSION.tar.gz
      home http://www.gtk.org/
      docs http://www.gtk.org/documentation.html
  estimate 300
      desc 'library of useful C routines for trees, hashes, and lists'

build(){
patch << EOF
diff -r -U2 glib-1.2.10/glib.h glib-1.2.10/glib.h
--- glib-1.2.10/glib.h	2001-02-26 20:44:38.000000000 -0700
+++ glib-1.2.10/glib.h	2001-02-26 20:44:38.000000000 -0700
@@ -273,5 +273,5 @@
  * macros, so we can refer to them as strings unconditionally.
  */
-#ifdef	__GNUC__
+#if	defined(__GNUC__) && (__GNUC__ == 3  && __GNUC_MINOR__ < 4)
 #define	G_GNUC_FUNCTION		__FUNCTION__
 #define	G_GNUC_PRETTY_FUNCTION	__PRETTY_FUNCTION__
EOF


 case $HOSTTYPE in
  x86_64) sed -i '209i  | x86-* | x86_64-* \\'           config.sub
          sed -i 's:i\[34567\]86):i\[34567\]86|x86_64):' config.sub ;;
 esac

# sed -i 's:-L@libdir@::' glib-config.in

 export LDFLAGS+=" $CFLAGS"
 default_build
}
