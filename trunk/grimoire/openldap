# 2.4.17 gained an optional on icu4c although I am not entirely certain why
# since openldap is not c++

# groff is requiered as the spell create soelim tool
# however groff is normally installed on a Sorcerer box
# Adding groff as a requirement to openldap creates a recursive requirement loop
# espgs ghostscript psutils groff openldap cups

# according to the vurl the stable release is 2.4.16 on Wed Oct  7 18:34:46 UTC 2009


    stable 2.4.21 2.4.19 2.4.17 2.4.16 2.4.14 2.4.13 2.4.12
    secure 2.4.16 2.3.43
  unstable 2.4.22 2.4.21 2.4.20
    latest 2.4.22 2.4.21 2.4.20
   require cyrus-sasl db icu4c libtool
  optional heimdal --with-kerberos --without-kerberos for kerberos support
  category utility
 attribute console
      vurl http://www.openldap.org/software/download/
       url 'ftp://ftp.openldap.org/pub/OpenLDAP/
            ftp://gd.tuwien.ac.at/infosys/network/OpenLDAP/
            ftp://ftp.ucr.ac.cr/pub/Unix/openldap/
            ftp://ftp.ntua.gr/mirror/OpenLDAP/
            ftp://ftp.dti.ad.jp/pub/net/OpenLDAP/
            ftp://ftp.u-aizu.ac.jp/pub/net/openldap/
            ftp://ftp.nl.uu.net/pub/unix/db/openldap/
            ftp://ftp.plug.pt/pub/OpenLDAP/
            ftp://ftp.si.uniovi.es/mirror/OpenLDAP/
            ftp://sunsite.cnlab-switch.ch/mirror/OpenLDAP/
            ftp://ftp.net.lut.ac.uk/openldap/
            ftp://ftp.plig.org/pub/OpenLDAP/
            http://www.openldap.org/software/download/OpenLDAP/'
    source openldap-release/openldap-$VERSION.tgz
  homepage http://www.openldap.org/
      opts --enable-shell --enable-dynamic --enable-modules=yes --enable-static=no
  estimate 2400
      desc 'fully featured open source LDAP software suite
openldap is a fully featured open source LDAP software suite.
OpenLDAP Software provides a complete LDAP implementation including
server, clients, C SDK, and associated tools.'

#             --enable-bdb          \
#             --with-bdb-module=dynamic  \
#             --enable-dnssrv       \
#             --with-dnssrv-module=dynamic
# can build dynamic modules advantageous
# for binary based distros, but probably not sorcerer.

build(){
case $VERSION in
 2.4.21) sed -i 's:ol_DB_LIB=$:ol_DB_LIB=-ldb-5:'        configure
         sed -i 's:ol_cv_lib_db=no:ol_cv_lib_db=-ldb-5:' configure ;;
esac
# ol_cv_db_none=yes \
ol_cv_berkeley_db_version=yes \
default_build
}


post_install(){
 default_post_install
          get_provider  pam_ldap |
 pipe     get_provider  nss_ldap |
 pipe     show_installed         |
 LC_ALL=C sort                   |
          uniq  -d               |
          pipe_queue $CAST_QUEUE com
}
