# update setleds when updating kbd

#            'linuxdoc-tools:::for building HTML documentation' )
# linuxdoc-toolswit elect   requirement creates problems on the I/R
# linuxdoc-tools requires openjade and openjade requires gcc-v3.4

# 1.15.3 failed compilation

# kbd hosted on ftp.kernel.org is older than 1.15.x
# where is this project hosted now?

with info    good 20130314
with info    last 20110515
with version   stable 1.15.2
with version unstable 1.15.3
with base    automake init-functions libtool perl
# kbd source ignores --bindir=/bin
#     with also --bindir=/bin
with role    font utility/keyboard
with trait   console lto makej
#   source ftp://ftp.kernel.org/pub/linux/utils/kbd/kbd-$VERSION.tar.bz2
#with source    stable http://sources.silverice.org/kbd/$VERSION/kbd-$VERSION.tar.bz2
#with source  unstable http://sources.silverice.org/kbd/$VERSION/kbd-$VERSION.tar.bz2
with source     stable http://kbd-project.org/download/kbd-$VERSION.tar.gz
with source   unstable http://kbd-project.org/download/kbd-$VERSION.tar.gz
with info    home http://kbd-project.org
with info    cite 'keytable files and keyboard utilities
Configuration file is /etc/keymap.conf'

build(){
 adjust_install(){
  mkdir -pvm 755 "$DESTDIR/bin"
  mv     -v "$DESTDIR"/usr/bin/{chvt,deallocvt,loadkeys,openvt} "$DESTDIR"/bin
 }

 default_build &&
 adjust_install
}

current(){
 case $VERSION in
  1.15.2) LC_ALL=C grep -q udevsettle /etc/init.d/loadkeys &&
          [ -f /bin/openvt ] ;;
  1.15.3) [ -f /bin/openvt ] ;;
 esac
}
