#            'linuxdoc-tools:::for building HTML documentation' )
# linuxdoc-tools optional requirement creates problems on the I/R
# linuxdoc-tools requires openjade and openjade requires gcc-v3.4

# 1.15.3 failed compilation

   version stable 1.15.2
   version unstable 1.15.3
   require automake flex init-functions libtool perl
# kbd source ignores --bindir=/bin
#     opts --bindir=/bin
  category font utility/keyboard
 attribute console
    source ftp://ftp.kernel.org/pub/linux/utils/kbd/kbd-$VERSION.tar.bz2
      info last  20110515
      info home  ftp://ftp.kernel.org/pub/linux/utils/kbd/
 conflicts console-tools console-data
      desc 'keytable files and keyboard utilities
Configuration file is /etc/keymap.conf'

configure(){
 get(){
  menu_list(){ sed "1iask	$2
                    s:$:	$2:" < $SCRIPT_DIR/$3; }

  WHAT=$( dialog --stdout                        \
                 --timeout  ${PROMPT_DELAY:-120} \
                 --title "$2 Menu"               \
                 --default-item "$4"             \
                 --menu  ""  0 0 0               \
                 $( menu_list "$@" )
        )  &&
  if [ -n      "$WHAT" ]
  then echo "$1=$WHAT" >> $SPELL_CONFIG
  fi
 }

 if   [ -d /boot/isolinux ]
 then KEYMAP=ask
 fi

 if [ -z "$KEYMAP" ]; then get "KEYMAP" "Keymap" "keymaps.txt" "us"; fi
#if [ -z "$FONT"   ]; then get "FONT"   "Font"   "fonts.txt"   "default8x16"; fi
}

build(){
 rm  -f /etc/keymap.conf
 [   -n  "$KEYMAP" ] &&
 sed -i "s:KEYMAP=[^$]*$:KEYMAP=$KEYMAP:" $SCRIPT_DIR/init.d.on/loadkeys

 default_build &&
 mkdir -p                     $DESTDIR/bin &&
 mv $DESTDIR/usr/bin/loadkeys $DESTDIR/bin/
}

current(){
 case $VERSION in
  1.15.2) [ -f /bin/loadkeys ] ;;
 esac
}
