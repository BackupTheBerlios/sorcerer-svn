# might be unusable on x86_64
# Please direct complaints and inquiries concerning blender
# to the blender email lis rather than Sorcerer.
# I do not know how, why, nor where the ELF 32-bit shared object files
# come from that appear in 
# /opt/blender/2.62/python/lib/python3.2/lib-dynload/
# best guess is that blender downloads and installs them from
# pre-compiled binary packages while blender compiles.
# Very sneaky if so.

# Not linking properly during last test on x86_64
# trying to link with libraries in /usr/lib
# yet the compile log gives no indication why.

   version stable 2.62 2.61 2.60a 2.60

# case $VERSION in
#  2.57)
#       opts WITH_BF_FFMPEG=False ;;
# esac

   require MesaLib Python3 SDL ffmpeg fftw lame libpng libsamplerate libspnav libtheora libvorbis openal openexr openssl pth scons speex sqlite subversion tiff tk x264
  optional openjpeg

#   require Python3  alsa-lib freealut freetype jpeg libvorbis firefox scons
#  optional yasm '' '' for fast x264 encoding
  category graphic/editor video/editor
 attribute x11
 attribute broke
    source http://download.blender.org/source/blender-$VERSION.tar.gz
      vurl http://www.blender.org/download/get-blender
      info last 20120220
      info home http://www.blender.org/
      info docs http://www.blender.org/education-help/
      desc 'a 3d modeling environement
Blender is a fully integrated 3D graphics creation suite allowing
modeling, animation, rendering, post-production, real-time interactive
3D, and game creation and playback with cross-platform compatibility.'

build(){
 fix_nasm_inc(){
  cd extern/xvidcore/src/
  find . -type d -exec cp -v nasm.inc '{}' \;
  cd ../../..
 }

 case $VERSION in
 2.49b) fix_nasm_inc ;;
 esac

 export  LDFLAGS+=' -lalut'
#scons -Q $OPTS &&
 scons &&
 scons install BF_INSTALLDIR=$DESTDIR/opt/blender
}
