# Update expect when updating tcl

with version stable 8.5.13 8.5.12 8.5.11
with also    --disable-rpath
with role    development/interpreter
with trait   console library makej multilib-dual
with source  $SOURCEFORGE_URL tcl/Tcl/$VERSION/tcl$VERSION-src.tar.gz
with info    last 20121112
with info    home http://www.tcl.tk/
with info    freecode tcltk
with info    cite 'multi-platform scripting environment
tcl provides a portable scripting environment for
Unix, Windows, and Macintosh that supports string
processing and pattern matching, native file system
access, shell-like control over other programs,
TCP/IP networking, timers, and event-driven I/O.
Tcl has traditional programming constructs like
variables, loops, procedures, namespaces, error
handling, script packages, and dynamic loading of DLLs.'

build(){

 if   [[ $HOSTTYPE == x86_64 ]] && ! [[ $CFLAGS =~ -m32 ]]
 then with also --libdir=/usr/lib64
 else with also --libdir=/usr/lib
 fi

 make_shared_lib(){ ld --whole-archive -share -o $1.so $1.a; }

 cd unix &&
 ./configure \
 --prefix=/usr \
 --sysconfdir=/etc \
 --localstatedir=/var \
 --enable-shared \
 --enable-threads \
 $OPTS &&
 make &&
 make install DESTDIR=$DESTDIR &&
 ln -sf tclsh${VERSION:0:3} $DESTDIR/usr/bin/tclsh
}
