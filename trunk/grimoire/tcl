# Update expect when updating tcl

   version stable 8.5.10 8.5.9 8.5.8 8.5.7
      opts --disable-rpath
  category development/interpreter
 attribute console library makej multilib-dual
    source $SOURCEFORGE_URL tcl/Tcl/$VERSION/tcl$VERSION-src.tar.gz
      info last  20110625
  homepage http://www.tcl.tk/
 freshmeat tcltk
      desc 'multi-platform scripting environment
tcl provides a portable scripting environment for
Unix, Windows, and Macintosh that supports string
processing and pattern matching, native file system
access, shell-like control over other programs,
TCP/IP networking, timers, and event-driven I/O.
Tcl has traditional programming constructs like
variables, loops, procedures, namespaces, error
handling, script packages, and dynamic loading of DLLs.'

build(){

 if   [[ $HOSTTYPE == x86_64 ]] && ! [[ $CFLAGS =~ -m32 ]]
 then opts --libdir=/usr/lib64
 else opts --libdir=/usr/lib
 fi

 make_shared_lib(){ ld --whole-archive -share -o $1.so $1.a; }

 cd unix &&
 ./configure \
 --prefix=/usr \
 --sysconfdir=/etc \
 --localstatedir=/var \
 --enable-shared \
 --enable-threads \
 $OPTS &&
 make &&
 make install DESTDIR=$DESTDIR &&
 ln -sf tclsh${VERSION:0:3} $DESTDIR/usr/bin/tclsh
}
