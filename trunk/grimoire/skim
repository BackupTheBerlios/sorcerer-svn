# skim uses bundled scons, but that does not work.

# Tested on 20080112 and it failed compilation

# the bundled scons with scim does not locate or use gcc or g++
# during compilation and therefore attempts to execute commands
# to gcc or g++ without invoking gcc or g++
# Consequently, it produces a shell error instead.
# With the new scons I can use a script to recover from the unfortunate error.
# scons is a horrible substitute for make!!!

    stable 1.4.5
   require kdelibs-v3 scim scons
  category input
 attribute kde3 new broke
       url $SOURCEFORGE_URL
    source scim/skim-$VERSION.tar.bz2
  homepage http://www.scim-im.org/
  estimate 500
      desc 'skim is an input method based upon scim-lib'

disable libtool_fix

build(){
 case $VERSION in
  1.4.5) echo -e "#!/bin/bash\nset -x\ng++ -o \"\$@\"" > o
         chmod a+x o
         export PATH="$PWD:$PATH"
         sed -i '/unset/d'  configure ;;
 esac

./configure  \
 prefix=/usr \
 qtincludes=/usr/include/qt &&
 scons &&
 prepare_install &&
 scons   install
}


build_old()  {
  ./configure      \
  prefix=/usr      \
  qtincludes=/usr/include/qt  \
  $OPTS            &&
  ./scons          &&
  prepare_install  &&
  ./scons install
}
