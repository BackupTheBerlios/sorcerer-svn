inherit kde
  CATEGORY="audio/cd audio/mixer"
#   SOURCE="stable/latest/src/kdemultimedia-$VERSION.tar.bz2"
# seems like kdemultimedia requires an older version of libtunepimp than current
       REQ=( "kdelibs"
             "audiofile:--with-audiofile:--without-audiofile:for support audiofile" 
             "akode:::for additional audio codec and output support for arts"
             "cdparanoia:--with-cdparanoia:--without-cdparanoia:to burn CDs"
             "flac:--with-flac:--without-flac:for the flac lossless audio codec" 
             "gst-plugins-base:--with-gstreamer:--without-gstreamer:for GStreamer support"
             "lame:--with-lame:--without-lame:to encode mp3s"
             "libtheora:--with-theora:--without-theora:for support Ogg Theora" 
             "libtunepimp:::for tunepimp"
             "libvorbis:--with-vorbis:--without-vorbis:for the ogg vorbis audio codec"
             "speex:::for a voice codec"
             "taglib:--with-taglib:--without-taglib:for reading and editing metadata of audio files"
             "xine-lib:--with-xine:--without-xine:to use xine for rendering of mpeg-2 and DVDs"
             ":--with-kscd-cdda:--without-kscd-cdda:for CDDA support in kscd, select cdparanoia also" )
#            "arts:--with-arts:--without-arts:for sound support" 

# --with-musicbrainz is not working
#            "musicbrainz:--with-musicbrainz:--without-musicbrainz:for MusicBrainz and automatic song recognition support"
  ESTIMATE="6200"
      DESC="kdemultimeda contains applications like a CD player and mixer."

build()  {
  case  $VERSION  in
    3.3.2)  sed  -i  "\,#include <linux/cdrom.h>,i#undef   __STRICT_ANSI__\n#include <linux/types.h>" mpeglib/lib/input/cdromAccess_Linux.cpp  ;;
    3.4.*)  case $HOSTTYPE in
             x86_64) 
                 sed  -i  "35d"     mpeglib/lib/input/cdromAccess.cpp
                 sed  -i  "31,33d"  mpeglib/lib/input/cdromAccess.cpp
                 ;;
            esac
            ;;
  esac

  kde_build
}
