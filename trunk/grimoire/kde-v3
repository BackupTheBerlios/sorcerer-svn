[ -z "$VERSION" ] &&
    stable 3.5.9 3.5.8
 attribute kde3
  homepage http://www.kde.org
       url "$KDE_URL"
     OPTS+=' --prefix=/opt/kde3 --with-qt-dir=/opt/kde3 --disable-debug --enable-pch --with-xinerama'
# --enable-final removed.
# With kdepim version 3.5.9 a compile error occurs 


case $SPELL in
    kde-v3) 
  category profile
   require kdeaddons-v3
  optional kdebindings-v3  '' '' for DCOP and kdejava bindings
  optional kdevelop-v3     '' '' for creating and development of software projects
  optional kde-path-v3     '' '' for including /opt/kde3/bin in the PATH
  optional kdesdk-v3       '' '' for applications and tools used by KDE developers
  optional kdewebdev-v3    '' '' for web page/site development tools
  optional scim-bridge-qt3 '' '' to input in Japanese, Chineese, Korean

  estimate 5
      desc 'kde-v3 provides the KDE version 3.x desktop environment.' ;;
 kde-i18n*) category documentation/i18n
              source stable/${VERSION}/src/kde-i18n/$SPELL-$VERSION.tar.bz2
                desc "$SPELL provides translated KDE messages." ;;
         *)   source stable/${VERSION}/src/${SPELL%-v3}-$VERSION.tar.bz2 ;;
esac



kde_build(){
 SCX=1
 while [     -n                                 "${SOURCE[$SCX]}"  ]
 do    patch -p0 < $SOURCE_CACHE/$SPELL/$VERSION/${SOURCE[$SCX]##*/}
       (( SCX++ ))
 done

# ppanula: tested with kde 3.5.1, OK
# sed -i "s:CFLAGS=\"-O2 \$CFLAGS\":CFLAGS=\"${CFLAGS}\":
#         s:CXXFLAGS=\"-O2 \$CXXFLAGS\":CXXFLAGS=\"${CXXFLAGS}\":" configure

 default_build
}

build(){
 bindings_build(){
  cd       dcoppython/lib
  unexpand pydcop.py  >  pydcop.py.new
  mv       pydcop.py.new pydcop.py
  cd -
  kde_build
 }

 case $SPELL in
  kdebindings) bindings_build ;;
       kde-v3) default_build ;;
            *) kde_build ;;
 esac
}
