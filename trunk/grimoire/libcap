# Perhaps linux capabilities are no longer supported?
# libcap version 2.19 on uClibc installed libraries
# to / instead of /lib, how strange.

# Versions 2.14 and less require indent
   version stable 2.20 2.19
      info last  20110119
#  require indent
   require attr
  category kernel
 attribute console library
    source $KERNEL_URL /pub/linux/libs/security/linux-privs/libcap2/libcap-$VERSION.tar.bz2
      info home  http://ftp.kernel.org/pub/linux/libs/security/linux-privs/kernel-2.4/capfaq-0.2.txt
      desc 'userspace tools for POSIX capabilities
These programs are used to limit the Inheritable
capabilities of a program to be executed or processes.
Note, this wrapper is intended to assist in overcoming
a lack of support for filesystem capability attributes
and should be used to launch other files.'

build(){
 local lib

 if   [[ $HOSTTYPE == x86_64 ]] && ! [[ $CFLAGS =~ -m32 ]]
 then lib=lib64
 else lib=lib
 fi

 make "LDFLAGS=$CFLAGS $LDFLAGS -L$PWD/libcap" \
       "CFLAGS=$CFLAGS -fPIC -I$PWD/libcap/include" &&
 make install     prefix=/usr \
              inc_prefix=/usr \
              man_prefix=/usr \
              lib_prefix=/    \
                     lib=$lib \
           RAISE_SETFCAP=no   \
                 DESTDIR=$DESTDIR &&
 rm -f $DESTDIR/lib{,64}/libcap.a
}
