# disabling examples because compilation of examples requires SDL
# and libthoera with a requirement on SDL creates a recursive requirement loop

   version   stable 1.1.1 1.1.0 1.0
   version unstable 1.2.0alpha1
   require libogg
      opts --enable-static=no --disable-examples
  category video
 attribute library lto makej multilib-concurrent
#attribute multilib-fail
    source   stable http://downloads.xiph.org/releases/theora/libtheora-$VERSION.tar.xz
    source unstable http://downloads.xiph.org/releases/theora/libtheora-$VERSION.tar.xz
      info good 20120615
      info last 20100125
      info home http://www.theora.org/
 freshmeat ot
      desc 'video codec
libtheora is Ogg Theora is Xiph.Org first publicly
released video codec, intended for use within the
Ogg project Ogg multimedia streaming system.
Theora is derived directly from On2 VP3 codec
and is a superset of VP3.'

build(){
 case $VERSION in
  1.1.1) sed -i '\,PATH="$prefix/bin:$prefix/usr/bin:$PATH",d' configure ;;
 esac

 if   [[ $HOSTTYPE == x86_64 ]] && [[ $CFLAGS =~ -m32 ]]
 then opts --host=${MACHTYPE/x86_64/i686}
 fi
 default_build
}


post_install(){
# libtheora changed the name of it's installed library
# mplayer does not properly link to it but instead attempts
# to load the library when it runs.
# that is why the ldd check fails to detect this problem.
# MPlayer aught to let the operating system load libraries
# instead of doing that itself.
 if   spell_installed MPlayer
 then echo            MPlayer | pipe_queue $CAST_QUEUE
 fi
}
