   VERSION=( 4.3.3 4.3.1 4.3.0 )
      SAFE=( 4.3.3 4.3.1 4.3.0 )
    IGNORE='rc'
  CATEGORY='graphic/library'
 ATTRIBUTE='library kde solo'
    SOURCE="qt-x11-opensource-src-$VERSION.tar.gz"
       URL='ftp://ftp.trolltech.com/qt/source/'
  HOMEPAGE='http://www.trolltech.com/developer/downloads/qt/x11'
# are the unixODBC and sqlite SQL support truly optional?
# sqlite is not optional
#       REQ=( 'dbus glib libXcursor libXinerama libXrandr libmng libpng sqlite tiff unixODBC'
       REQ=( 'dbus glib libXcursor libXinerama libXrandr libmng libpng sqlite tiff'
             'cups:-cups:-no-cups:for common unix printing support'
             'freetype:-fontconfig:-no-fontconfig:for quality font engine'
             'mysql::-no-sql-mysql:for mysql support'
             'postgresql::-no-sql-psql:for postgresql support'
             'sqlite-v2.8:::for old sqlite support'
             'unixODBC:::for connecting to windows database' )
  EPROVIDE='qt-x11-opensource-desktop'
 FRESHMEAT='qt'
  ESTIMATE='9000'
      DESC='qt-x11-opensource simplifies the task of writing and maintaining GUI applications.'

build(){
 export   CFLAGS+=' -fPIC'
 export CXXFLAGS+=' -fPIC'

 case $HOSTTYPE in
  i586) OPTS+=' -no-mmx -no-3dnow -no-sse -no-sse2' ;;
 esac

 rm  -rf  demos examples

 QT4_PREFIX=/usr/share/qt4

 case  $HOSTTYPE  in
  x86_64) LIBS=lib64 ;;
       *) LIBS=lib   ;;
 esac

 # The -R breaks compilation in 4.2.1
 # -R$BUILD_DIR/lib  \
 mkdir  lib
 echo  "yes"      |
 ./configure      \
 -v               \
 -fast            \
 -release         \
 -shared          \
 -optimized-qmake \
 -system-libmng   \
 -system-libjpeg  \
 -system-libpng   \
 -system-libtiff  \
 -system-sqlite   \
 -system-zlib     \
 -qt3support      \
 -qt-gif          \
 -xinerama        \
 -no-exceptions   \
 -nomake demos    \
 -nomake examples \
 -prefix $QT4_PREFIX  \
 -bindir /usr/bin \
 -libdir /usr/$LIBS   \
 -no-separate-debug-info \
 -headerdir /usr/include/qt4 \
 $OPTS           &&
 make            &&
 prepare_install &&
 make    install &&
 ln -s ../../include/qt4 ${QT4_PREFIX}/include &&
 ln -s ../../bin         ${QT4_PREFIX}/bin &&
 ln -s ../../$LIBS       ${QT4_PREFIX}/lib
}

# ln -s ../share/qt4/include /usr/include/qt4  &&
