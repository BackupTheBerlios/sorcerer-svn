# usually stable version is set to the version required by gcc

with version   stable 0.16.1
with version unstable 0.17.0
with base    isl
#with base    gmp polylib ppl
#with base    gmp ppl
with also    --enable-static=no --with-isl=bundled
#     with also --enable-static=no --with-isl=system
#     with also --with-ppl --enable-static=no
with role    development/compiler
with trait   library makej multilib-concurrent optimize setarch
with source    stable http://www.bastoul.net/cloog/pages/download/cloog-$VERSION.tar.gz
with source  unstable http://www.bastoul.net/cloog/pages/download/cloog-$VERSION.tar.gz
#   source ftp://gcc.gnu.org/pub/gcc/infrastructure/cloog-ppl-$VERSION.tar.gz
with info    last 20111212
with info    home http://www.cloog.org/
with info    docs http://www.bastoul.net/cloog/documentation.php
with clash   cloog-ppl cloog-parma
with info    cite 'CLooG Code Generator in the Polyhedral Model
used by gcc for Graphite loop optimizations'

build(){
 if [[ $HOSTTYPE == x86_64 ]] && ! [[ $CFLAGS =~ -m32 ]]
 then export LDFLAGS+=' -L/lib64'
 else export LDFLAGS+=' -L/lib'
 fi

 # to rid the rpath
 sed -i 's:hardcode_into_libs=yes:hardcode_into_libs=no:' configure
 sed -i 's:hardcode_absolute=yes:hardcode_absolute=no:' configure
 default_build
}

current(){
 case $VERSION in
  0.16.1) if spell_installed cloog-ppl ||
             spell_installed cloog-parma
          then
           echo cloog | pipe_queue $LOAD_QUEUE
           echo cloog | pipe_queue $MOIL_QUEUE
          fi ;;
 esac
}
