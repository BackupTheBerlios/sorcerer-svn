# Not DESTDIR compatible
# Not easy to install without reading every makefile
# Most recent source from 2003
# unmaintained and old style source
# 1.08g is newer than 1.09d
# 1.08g is newer than 1.09d

   version stable v1.08g-src
   require init-functions
  category administration/log
 attribute server broke deprecated
    source $SOURCEFORGE_URL msyslog/msyslog-1.X/1.08g/msyslog-$VERSION.tar.gz
    CFLAGS='-O2'
   LDFLAGS='-Wl,-O1'
  homepage http://sourceforge.net/projects/msyslog
  eprovide system-logger
      desc 'easy implementation syslogd with input and output modules
The modules that mantain compatibility with its precursor are
included in the standard distribution along with four modules:
om_peo (an implementation of PEO-1 and L-PEO, two algorithmic
protocols for integrity checking), om_mysql and om_pgsql
(modules that sends output to a mysql and postgresql database,
respectively) and om_regex (a module that allows output
redirection using regular expressions).
It is a near drop in replacement for sysklog, sysklogd or syslog.'

build(){
 install_etc(){
  install -m 644 $SCRIPT_DIR/syslog.conf /etc
  mkdir   -p            /etc/syslog.conf.examples
  for FILE in   src/examples/syslog.conf.*
  do install -m 444 -o root -g root \
                  $FILE /etc/syslog.conf.examples
  done

}

 export   CFLAGS+=' -fPIC'
 export CXXFLAGS+=' -fPIC'

 case $( uname -r ) in
  2.6*) sed -i "s:ksyms:kallsyms:" src/modules/im_linux.c ;;
 esac

 default_build &&
 install_etc
}

current(){
 case $VERSION in
  1.08g) [ -f /etc/init.d/msyslog-logs ] ;;
 esac
}
