with info    good 20130724
with info    last 20110703
with version stable 1.1.1
with base    SDL_image SDL_mixer SDL_ttf boost glew
case $VERSION in
 1.1.1)
with base    libpng14 ;;
esac
with role    game
with trait   optimize x11
with source  stable http://www.frogatto.com/files/frogatto-$VERSION.tar.bz2
with info    home http://www.frogatto.com/
with info    forum http://www.frogatto.com/forum/
with info    cite '2d side scrolling jump-and-run videogame

Please note: 
If connected to the Internet while playing
then Frogatto automatically uploads anonymous usage data.'

build(){
 libpng_fix(){
  if   [[ $HOSTTYPE == x86_64 ]] && ! [[ $CFLAGS =~ -m32 ]]
  then LIBPNGLIBDIR=/opt/libpng/1.4.x/lib64
  else LIBPNGLIBDIR=/opt/libpng/1.4.x/lib
  fi
  export   CFLAGS+=" -I/opt/libpng/1.4.x/include"
  export CXXFLAGS+=" -I/opt/libpng/1.4.x/include"
  export  LDFLAGS+=" -L$LIBPNGLIBDIR -Wl,-rpath,$LIBPNGLIBDIR"
  export PKG_CONFIG_PATH="$LIBPNGLIBDIR/pkgconfig:$PKG_CONFIG_PATH"
  echo "LDFLAGS=$LDFLAGS"
  echo "PKG_CONFIG_PATH=$PKG_CONFIG_PATH"
 }

 case $VERSION in
  1.1.1) libpng_fix
         sed -i "s:-L/usr/lib::" Makefile ;;
 esac

 local DIRS="data images music sounds"
 sed -i 's:ccache::' Makefile &&
 make OPT="$CXXFLAGS" &&
 mkdir  -pvm 755      "$DESTDIR"/usr/{bin,libexec,share/frogatto}/ &&
 install -vm 755 game "$DESTDIR"/usr/libexec/frogatto &&
 find $DIRS -type d | escape_qs | xargs --max-lines=64  chmod 755 &&
 find $DIRS -type f | escape_qs | xargs --max-lines=64  chmod 644 &&
 cp -a $DIRS "$DESTDIR"/usr/share/frogatto/ &&
 echo -e "#!/bin/bash\ncd /usr/share/frogatto\n/usr/libexec/frogatto" \
         > "$DESTDIR"/usr/bin/frogatto &&
 chmod 755 "$DESTDIR"/usr/bin/frogatto
}
