# version 1.8.x and later will support a /etc/X11/xorg.conf.d/

# 1.11.1.902 is a security update, but should we do it?
# Will NVIDIA-Linux-x86* support that new of a version of xorg-server
# and th xorg-server update mandates several other spell updates.

   version   stable 1.12.2 1.11.1.902
   version unstable 1.12.2.902
    require MesaLib bigreqsproto compositeproto evieext inputproto libXfont libXres libdmx libpciaccess libxkbfile pixman randrproto recordproto renderproto resourceproto scrnsaverproto trapproto videoproto xcmiscproto xf86dgaproto xf86driproto xf86miscproto xineramaproto xinit xkeyboard-config udev

case $MACHTYPE in
 *-gnu)
   require xterm ;;
esac
  optional openssl
      opts --with-fontdir=/usr/share/fonts/X11
#     opts --enable-config-dbus
      opts --enable-config-udev
#     opts --enable-config-hal
      opts --with-pic
  category xorg/app
 attribute X11R7 lto_off makej x11 makej optimize
# Do not give this spell attribute library makej
    source $XORG_URL xserver/xorg-server-$VERSION.tar.bz2
      info good 20120713
      info last 20120529
      desc 'X11 server'

build(){

 adjust_xorg_conf(){
  if   [[ -f         /etc/X11/xorg.conf ]] &&
       sed 's:#.*::' /etc/X11/xorg.conf |
       LC_ALL=C grep -q   RgbPath
  then sed -i 's:RgbPath:#RgbPath:' /etc/X11/xorg.conf
  fi
 }

 case $HOSTTYPE in
  x86_64) opts --with-dri-driver-path=/usr/lib64/dri; LDFLAGS+=' -ldl' ;;
       *) opts --with-dri-driver-path=/usr/lib/dri ;;
 esac

 default_build
}

post_install(){
 recast(){
  if   spell_installed "$1"
  then echo            "$1" | pipe_queue "$CAST_QUEUE"
  fi
 }

 default_post_install
 augur installed xorg/driver | pipe_queue "$CAST_QUEUE"
 recast NVIDIA-Linux-x86
}
