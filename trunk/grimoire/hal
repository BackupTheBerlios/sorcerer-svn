   VERSION=( 0.5.11 0.5.10 0.5.9.1 )
   IGNORE='info\|rc'
  CATEGORY='system'
 ATTRIBUTE='console'
    SOURCE="hal-$VERSION.tar.gz"
  HOMEPAGE='http://www.freedesktop.org/wiki/Software/hal'
       URL='http://hal.freedesktop.org/releases/'
       REQ=( 'hal-info dbus-glib libselinux pciutils perl--XML-Parser udev'
             'libusb:::for usb support'
             'gtk-doc:--enable-gtk-doc:--disable-gtk-doc:for DocBook documentation' )

#            'libselinux:--enable-selinux:--disable-selinux:for SELinux support'
# gnome-python needed for hal-device-manager but it creates a loop due to its
# dependence on gnome-vfs which requires hal
#             'gnome-python:::for hal-device-manager' 
      OPTS='--with-hwdata=/usr/share/
            --with-pid-file=/var/run/haldaemon.pid
            --disable-policy-kit
            --enable-static=no'
# --disable-policy-kit is OK for now, read 
# http://www.mail-archive.com/desktop-devel-list@gnome.org/msg06861.html
 FRESHMEAT='halayer'
  ESTIMATE='1500'
      DESC='hal, hardware abstraction layer, implements the hal.
HAL (Hardware Abstraction Layer) is a specification
and an implementation of a hardware abstraction layer.
It encompasses a shared library for use in applications, a daemon,
a hotplug tool, command line tools, and a set of stock device info files.'

build(){
mkdir    -p -m 0755 /var/empty
groupadd -K GID_MIN=256 -K GID_MAX=512    haldaemon                         2>/dev/null
useradd  -K UID_MIN=256 -K UID_MAX=512 -g haldaemon -d /var/empty haldaemon 2>/dev/null
default_build
}

current(){
# Required for rolling back dbus to 2006 stable release.
 local LIBR REPLY
 case $VERSION in
  0.5.9.1)
   read < $VERSION_LOGS/dbus
   if   [ "$REPLY" == "1.0.2" ]
   then grep  -q  '^dbus	1.0.2' $SNAP_LOGS/hal
   fi &&
   grep  -q  'dbus run $syslog'  /etc/init.d/hald  ;;
 esac
}
