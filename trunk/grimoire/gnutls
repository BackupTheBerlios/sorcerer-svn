# libgnutls-config removed used pkg-config instead to check for gnutls
# 3.0.0 failed compilation
# 3.x series is xz compressed
# info page generation can fail when multilib-concurrent
# 3.0.7 is alo a security fix for when 3.0.x becomes usable

# 3.1.0 failed compilation

with version   stable 3.1.6 3.1.5 3.1.4
with base    guile libcfg+ libgcrypt libtasn1 ncurses nettle p11-kit pkgconfig readline zlib
with elect   gcc-g++
with elect   lzo2 --with-lzo
with also    --enable-static=no --disable-rpath
with role    security/encryption
with trait   library multilib-dual setarch
#trait multilib-concurrent
#trait makej
# Evert sent a compile log that suggested a problem can occur
# when compiling with makej
with source    stable ftp://ftp.gnutls.org/gcrypt/gnutls/v${VERSION:0:3}/gnutls-$VERSION.tar.xz
with source  unstable ftp://ftp.gnutls.org/gcrypt/gnutls/v${VERSION:0:3}/gnutls-$VERSION.tar.xz
#with source    stable $GNU_URL gnutls/gnutls-$VERSION.tar.xz
#with source  unstable $GNU_URL gnutls/gnutls-$VERSION.tar.xz
with info    last 20130102
with info    home http://www.gnutls.org/
#with info    home http://www.gnu.org/software/gnutls/
#with info    docs http://www.gnu.org/software/gnutls/documentation.html
#with info    mail http://www.gnu.org/software/gnutls/lists.html
with info    cite 'library for SSL
gnutls is the GNU Transport Layer Security Library
is a library which implements a secure layer over
a reliable transport layer such as TCP/IP.
It implements the TLS 1.0 and SSL 3.0 protocols'

build(){
 sed -i 's:hardcode_into_libs=yes:hardcode_into_libs=no:' configure
 default_build &&
 sed -i 's:, zlib::; s:-lgmp:-lgmp -lz:' $DESTDIR/usr/lib*/pkgconfig/gnutls.pc
}
