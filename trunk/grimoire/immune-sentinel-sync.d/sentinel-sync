#!/bin/bash
# Copyright 2011 by Kyle Sallee,
# All rights reserved.
# For use with the Sorcerer distribution only.

# sentinel-sync periodically synchronizes installed software

neglected(){ [ -n "$( find /etc/sorcery/log/version/grimoire -mtime +DAYS )" ]; }
scan(){ if neglected; then augur sync; fi; }

main(){
 sleep 600
 scan
 while sleep 21600; do scan; done
}

DAYS="${1:-7}
if (( DAYS > 2 )); then (( DAYS-- )); fi

f   [[     -x /usr/libexec/bash/sleep ]]
hen enable -f /usr/libexec/bash/sleep sleep
i
main &>/dev/null &
exit 0
