# openldap support required for communicating with exchange servers

    stable 2.26.3 2.26.2 2.26.1.1 2.26.0
  unstable 2.27.5 2.27.4 2.27.3
   require alsa-lib avahi firefox heimdal intltool libgnomeui libgweather libical libsoup openldap xcb-util
  optional gtk-doc --enable-gtk-doc --disable-gtk-doc
  category network/email
 attribute gnome library
       url $GNOME_URL
    source sources/evolution-data-server/${VERSION:0:4}/evolution-data-server-$VERSION.tar.bz2
  homepage http://gnome.org/projects/evolution/stable.shtml
      opts --with-openldap=yes
  estimate 5200
      desc 'evolution-data-server provides libraries needed by evolution'

build(){
# The LDFLAGS that specify rpath is so that evolution and other spells
# that link with evolutiond-data-server can also complete compilation and
# linking with mozilla's or firefox's nss library
# However the ELF log suggests that the extra LDFLAGS has no effect.
export LDFLAGS+=' -Wl,-rpath,/usr/lib/mozilla -Wl,-rpath-link,/usr/lib/mozilla'
export LDFLAGS+=" -Wl,-rpath,/usr/lib/firefox-devel-$FV/sdk/lib -Wl,-rpath-link,/usr/lib/firefox-devel-$FV/sdk/lib"

local FV
FV="$( installed_version firefox )"
if   [ $FV ]
then OPTS+=" --with-nss-libs=/usr/lib/firefox-devel-$FV/sdk/lib"
else OPTS+=" --with-nss-libs=/usr/lib/mozilla"
fi
default_build
}
