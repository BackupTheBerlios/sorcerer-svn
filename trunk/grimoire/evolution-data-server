# openldap support required for communicating with exchange servers
# 2.32.0 failed compilation
# during ia32 multilib compilation:
# checking for iconv in -liconv... no
# checking for iconv... yes
# checking for gnu_get_libc_version... yes
# checking if iconv() handles UTF-8... no
# configure: error: You need to install a working iconv implementation, such as ftp://ftp.gnu.org/pub/gnu/libiconv

# evolution-data-server might be doing something incorrect to test.

# version 3.0.2 failed compilation
# version 3.2.0 failed compilation
# version 3.1.92 failed compilation.
# version 3.2.0 is refusing to compile multilib

   version   stable 3.2.3 3.2.2 3.2.1 3.2.0 3.0.3 3.0.1 3.0.0
   version unstable 3.3.92 3.3.91
   require gnome-online-accounts libgdata libgweather libical nss nspr
      opts --with-openldap=yes --disable-gtk-doc
# optional gtk-doc --enable-gtk-doc --disable-gtk-doc
  category network/email
 attribute gnome library makej multilib-concurrent
    source $GNOME_URL sources/evolution-data-server/${VERSION:0:3}/evolution-data-server-$VERSION.tar.xz
      info last 20120116
      info home http://gnome.org/projects/evolution/stable.shtml
      desc 'libraries needed by evolution'

build(){

build_old(){
 # export pkg-config info instead of using configure switch --with-nspr-includes
 # export   CFLAGS+=" $( pkg-config --cflags nspr )"
 # export CXXFLAGS+=" $( pkg-config --cflags nspr )"
 #export  LDFLAGS+=" $( pkg-config --libs   nspr )"

 export   CFLAGS+=" -UGTK_DISABLE_DEPRECATED -UGDK_PIXBUF_DISABLE_DEPRECATED"
 export CXXFLAGS+=" -UGTK_DISABLE_DEPRECATED -UGDK_PIXBUF_DISABLE_DEPRECATED"

 sed -i 's:-L$libdb_prefix/lib::' configure
 default_build
}

 case $VERSION in
  3.2.0) export LDFLAGS+=' -lsqlite3' ;;
 esac

 sed -i 's:hardcode_into_libs=yes:hardcode_into_libs=no:' configure
 sed -i 's:-L$libdb_prefix/lib::' configure
 default_build
}
