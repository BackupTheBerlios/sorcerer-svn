# qemu version 0.9.1 can become unresponsive and can lock up.
    stable       0.9.0
  unstable 0.9.1 0.9.0
   require SDL
  optional alsa-lib --enable-alsa  '' for audio output through alsa drivers
  switch          --enable-adlib '' for adlib and midi emulation support
  category development/emulator
 attribute x11
    source http://fabrice.bellard.free.fr/qemu/qemu-$VERSION.tar.gz
      vurl http://fabrice.bellard.free.fr/qemu/download.html
  homepage http://fabrice.bellard.free.fr/qemu/
      opts --disable-gcc-check
case $VERSION in
 0.9.1) use_gcc gcc-v3.4 ;;
 0.9.0) use_gcc gcc-v3.4 ;;
esac
  estimate 1200
      desc 'qemu is a computer emulator.'

disable ccache

build(){
 grep  -rl                       '\-g -fno-strict-aliasing'  *  |
 xargs -r --max-lines=64 sed -i 's:-g -fno-strict-aliasing:-fno-strict-aliasing:'

 case $HOSTTYPE in
  x86_64) : ;;
       *) grep  -lr        '\-Wall -O2' * |
          xargs -r sed -i 's:-Wall -O2:-O2 -march=i586:' ;;
 esac

 unset  CFLAGS
 unset  CXXFLAGS

 ./configure     \
 --prefix=/usr   \
 $OPTS           &&
 make            &&
 prepare_install &&
 make    install
}
