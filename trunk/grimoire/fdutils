    stable 5.5 5.4
   require e2fsprogs teTeX
  optional texinfo '' '' for documentation
  category disk
 attribute console
    source fdutils-$VERSION.tar.gz
       url http://fdutils.linux.lu/
      vurl http://fdutils.linux.lu/download.html
  homepage http://fdutils.linux.lu/
  estimate 136
      desc 'fdutils contains floppy disk formatting utilities.

superformat	formats high capacity disks of (up to 1992k for high
		density disks or up to 3984k for extra density disks)
fdmount		automatically mounts/unmounts disks when they
		are inserted/removed.
xdfcopy		formats, reads and writes OS/2 XDF disks.
MAKEFLOPPIES	creates the floppy devices in /dev
getfdprm	prints the current disk geometry (number of sectors,
		track and heads etc)
setfdprm	sets the current disk geometry
fdrawcmd	sends raw commands to the floppy driver
floppycontrol	configure the floppy driver'


build(){
 sed_source(){
  grep  -rl '#include <linux/fd.h>' * |
  while read
  do    sed -i '\,#include <linux/fd.h>,i#include <linux/compiler.h>' $REPLY
  done
  sed -i 's:#include <linux/ext2_fs.h>:#include <ext2fs/ext2fs.h>:' src/fdmount.c
 }

 header_patch(){
  case $VERSION in
   5.[4-5]) sed_source ;;
  esac
 }


 header_patch

 if ! spell_installed texinfo; then
  sed -i 's/comp-doc//'    Makefile.in
  sed -i 's/install-doc//' Makefile.in
 fi

 default_build
}
