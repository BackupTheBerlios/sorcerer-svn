inherit  linux
  stable 2.6.23.14 2.6.22.1 2.6.19.2
  secure 2.6.23.14 2.6.22.1 2.6.19.2
  RVERSION=( 1.3.7 1.3.5 1.3.4 )
  CATEGORY='kernel'
 ATTRIBUTE='console'
    SOURCE=( "pub/linux/kernel/v${VERSION:0:3}/linux-$VERSION.tar.bz2"
             "code/${RVERSION}/rsbac-common-$RVERSION.tar.bz2"
             "patches/${RVERSION}/${VERSION}/patch-linux-${VERSION}-rsbac-$RVERSION.diff.bz2" )
#            "bugfixes/$RVERSION/rsbac-bugfix-$RVERSION-1.diff"
       URL=( "$KERNEL_URL"
             "http://download.rsbac.org/" )
  HOMEPAGE='http://www.rsbac.org'
       REQ=( 'lilo'
             'module-init-tools:::for tools for modular kernel' )
  EPROVIDE='linux-kernel'
  ESTIMATE='2800'
      DESC='linux-rsbac provides RSBAC enhanced 2.6.x stable kernels.

Please read
http://www.rsbac.org/documentation/instadm.php
before installing this or you may lock youself out.

The following is a paraphrase of the most important information.

For the first boot configure the kernel to enable softmode.
Then, boot using the kernel parameter
rsbac_softmode

When booting with AUTH model use kernel parameter
rsbac_auth_enable_login
or you will not be able to login.'

apply_linux_patch(){
 unpack "${SOURCE[1]}"
 SCX=2
 while [ -n "${SOURCE[$SCX]}" ]; do
  decompress $SOURCE_CACHE/linux-rsbac/$VERSION/${SOURCE[$SCX]##*/} |
  patch -p1
  (( SCX++ ))
 done
 sed -i 's:-rsbac::' Makefile
}
