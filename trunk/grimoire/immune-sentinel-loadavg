# Copyright Kyle Sallee 2012
# All rights reserved.
# For use with the distribution sorcerer only!

# This might not work properly yet

   version stable 20120117
  category immune-system
 attribute archive_off daemon
 attribute broke
      info home http://sorcerer.silverice.org/
      desc "enhanced cast limiter

sorcery's cast program attempts to utilize all available cores
except when the min feature is enabled.
However, the amount of utilization and when it happens
can not be entirely anticipated.
Consequently, this sentinel monitors the loadavg when cast runs.
If the loadavg is excessive for the amount of processing units
then the spell that most recently began casting is temporarily frozen.
Excessive utilization is defined as
more than 2 loadavg per core or CPU."

build(){
 mkdir  -pvm 755                              $DESTDIR/usr/sbin
 install -vm 700 $SCRIPT_DIR/sentinel-loadavg $DESTDIR/usr/sbin
}
