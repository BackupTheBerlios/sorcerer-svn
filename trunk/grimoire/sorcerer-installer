# install spell is for the Sorcerer distribution only
# Copyright 2007 through 2012 by Kyle Sallee, all rights reserved.

with version stable 20121206 20120421 20111212
with base    Linux-HOWTOs LVM2 alsa-utils bash-completion bind btrfs-progs cdrtools core cpufrequtils cryptsetup dhcp dhcpcd dmidecode fhs hdparm inetutils intltool iptables isapnptools jfsutils kbd linux lsof lsscsi lynx mdadm ms-sys-static multipath-tools nano ntp openssh parted pciutils pcmciautils ppp protocols qemu-quick-console rp-pppoe rsync sdelta3 sdparm services sg3_utils smartmontools sorcery-documentation sshfs-fuse syslinux-static traceroute unzip usbutils v86d wireless_tools wpa_supplicant zile
with base    immune
with base    immune-auto-network
with base    immune-boot-blaze
with base    immune-boot-first
#with base    immune-boot-kick
with base    immune-clean-ccache
with base    immune-clean-event
with base    immune-clean-failed
with base    immune-clean-source
with base    immune-exam-alien
with base    immune-exam-dispel
with base    immune-exam-integrity
with base    immune-exam-transition
with base    immune-help-guide
with base    immune-help-login
#with base    immune-sentinel-elf
with base    immune-sentinel-memory
with base    immune-sentinel-resume
with base    immune-sentinel-sync

##  ndiswrapper and nmap are currently broke
#with base    ndiswrapper nmap

## firmware
with base    alsa-firmware firmware
## firmware
#with base    ar9170 atmel-firmware carl9170 iwlwifi-100-ucode iwlwifi-1000-ucode iwlwifi-3945-ucode iwlwifi-4965-ucode iwlwifi-5000-ucode iwlwifi-5150-ucode iwlwifi-6000-ucode iwlwifi-6005-ucode iwlwifi-6030-ucode iwlwifi-6050-ucode prism54-firmware ralink-firmware zd1201 zd1211

[[ $MACHTYPE =~ gnu ]] &&
with base    dump lftp lshw man ntp xfsdump

# Some other useful additions
with base    grimoire lm_sensors metalog nmap

with role    administration/bootloader
with trait   console solo
with info    cite 'the menu driven installer for Sorcerer'

build(){
 mkdir  -pvm 755 $DESTDIR/sbin
 install -vm 700 $SCRIPT_DIR/sinstall $DESTDIR/sbin/
 install -vm 700 $SCRIPT_DIR/dt       $DESTDIR/sbin/
 install -vm 700 $SCRIPT_DIR/sat      $DESTDIR/sbin/
}

post_install(){
 view_index av |
 sed -n "$( sed "s:^:/^:;s:$:\t/p:" $SCRIPT_DIR/sources.txt )" |
 sed    "s:^:$SOURCE_CACHE/:;s:\t:/:" |
 sed p |
 pipe find  "$SOURCE_CACHE" -maxdepth 2 -mindepth 2 -type d |
 LC_ALL=C sort | uniq -u |
 xargs -r --max-lines=256 rm -rf
 find "$SOURCE_CACHE" -mindepth 1 -type d -empty|xargs -r --max-lines=256 rmdir
 find "$SOURCE_CACHE" -mindepth 1 -type d -empty|xargs -r --max-lines=256 rmdir
 leech $(< $SCRIPT_DIR/sources.txt )
 default_post_install
}

current(){ echo sorcerer-installer | pipe_queue "$DISPEL_QUEUE"; }
