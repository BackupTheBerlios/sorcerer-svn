# install spell is for the Sorcerer distribution only
# Copyright 2007 through 2011 by Kyle Sallee, all rights reserved.

   version stable 20110705 20110501
   require LVM2 alsa-utils bash-completion bind btrfs-tools cdrtools core cpufrequtils cryptsetup dhcp dhcpcd dmidecode eject favor hdparm inetutils intltool iptables isapnptools jfsutils kbd kexec-tools linux lsof lsscsi lynx mdadm minicom ms-sys multipath-tools nano ntfsprogs ntp ocfs2-tools openssh parted pciutils pcmciautils ppp protocols rp-pppoe reiserfsprogs rsync sdelta3 sdparm services sg3_utils smartmontools sshfs-fuse suspend-utils syslinux traceroute unzip usbutils v86d vim wget wireless-regdb wireless_tools wpa_supplicant zile

   require immune-auto-network
   require immune-boot-blaze
   require immune-boot-sentient
   require immune-exam-alien
   require immune-exam-clean
   require immune-exam-integrity
   require immune-help-guide
   require immune-sentinel-elf
   require immune-sentinel-memory
   require immune-sentinel-resume
   require immune-sentinel-space
   require immune-sentinel-sync

##  ndiswrapper and nmap are currently broke
#  require ndiswrapper nmap

## firmware
   require alsa-firmware linux-firmware
## firmware
#  require ar9170 atmel-firmware carl9170 iwlwifi-100-ucode iwlwifi-1000-ucode iwlwifi-3945-ucode iwlwifi-4965-ucode iwlwifi-5000-ucode iwlwifi-5150-ucode iwlwifi-6000-ucode iwlwifi-6005-ucode iwlwifi-6030-ucode iwlwifi-6050-ucode prism54-firmware ralink-firmware zd1201 zd1211

[[ $MACHTYPE =~ gnu ]] &&
   require dump lftp lshw man ntp xfsdump

# Some other useful additions
   require ed grimoire lm_sensors metalog nmap procinfo-ng 

  category administration/bootloader
 attribute console solo
 conflicts install
      desc 'the menu driven installer for Sorcerer'

build(){
 mkdir  -pvm 755 $DESTDIR/sbin
 install -vm 700 $SCRIPT_DIR/sinstall $DESTDIR/sbin/
 install -vm 700 $SCRIPT_DIR/dt       $DESTDIR/sbin/
}

post_install(){
 view_index av |
 sed -n "$( sed "s:^:/^:;s:$:\t/p:" $SCRIPT_DIR/sources.txt )" |
 sed    "s:^:$SOURCE_CACHE/:;s:\t:/:" |
 sed p |
 pipe find $SOURCE_CACHE -maxdepth 2 -mindepth 2 -type d |
 LC_ALL=C sort | uniq -u |
 xargs -r --max-lines=256 rm -rf
 find $SOURCE_CACHE -maxdepth 1 -mindepth 1 -type d -empty |
 xargs -r --max-lines=256 rmdir
 leech $(< $SCRIPT_DIR/sources.txt )
 default_post_install
}

current(){ echo sorcerer-installer | pipe_queue "$DISPEL_QUEUE"; }
