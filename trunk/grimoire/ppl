# requires libgmpxx from gmp which is gmp compiled with gcc-g++ support enabled
# ppl 0.11 compiles, however
# cloog-ppl 0.15.9 does not compile with ppl 0.11 installed

# requirement on gcc-g++ creates circuliar requirement loop

# ppl version 1.0 not supported by gcc version 4.7.1

   version stable 0.12.1 0.11.2 0.10.2
   version latest 1.0
   require gmp
      opts --enable-static=no --disable-rpath --disable-debugging
  category development/compiler
 attribute hidden library multilib-dual optimize
#attribute makej multilib-concurrent
    source stable \
           http://bugseng.com/products/ \
            ftp://ftp.cs.unipr.it/pub/ppl/releases/$VERSION/ \
           ppl-$VERSION.tar.xz
    source latest \
           http://bugseng.com/products/ \
            ftp://ftp.cs.unipr.it/pub/ppl/releases/$VERSION/ \
           ppl-$VERSION.tar.xz

#   source http://www.cs.unipr.it/ppl/Download/ftp/releases/$VERSION/ppl-$VERSION.tar.bz2
      info good 20120630
      info last 20120628
      info home http://bugseng.com/products/ppl/
      info docs http://bugseng.com/products/ppl/documentation
      info mail http://bugseng.com/products/ppl/mailing-lists
#     info home http://www.cs.unipr.it/ppl/
      info vurl http://bugseng.com/products/ppl/download
      desc 'Parma Polyhedra Library
used by gcc for Graphite loop optimizations'

build(){ (
 if    [[ $CFLAGS =~ -m32 ]]; then
  export   CFLAGS+=' -I/usr/include32'
  export CXXFLAGS+=' -I/usr/include32'
 fi

 # to rid the rpath
 # yet not entirely successful
 aclocal; automake -acf; libtoolize -cf; autoreconf -fi
 sed -i 's:hardcode_into_libs=yes:hardcode_into_libs=no:' configure
 sed -i 's:hardcode_automatic=yes:hardcode_automatic=no:' configure
 sed -i 's:hardcode_automatic_CXX=yes:hardcode_automatic_CXX=no:' configure

 export ac_preproc_ok=yes
 default_build
) }
