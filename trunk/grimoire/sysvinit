   VERSION=( "2.86" "2.85" "2.84" )
  CATEGORY="utility"
 ATTRIBUTE="console core"
    SOURCE="sysvinit-$VERSION.tar.gz"
       URL="ftp://ftp.cistron.nl/pub/people/miquels/sysvinit"
  HOMEPAGE="ftp://ftp.cistron.nl/pub/people/miquels/sysvinit"
       REQ="init-functions"
   PROTECT="/etc/init.d/bootmisc"
  ESTIMATE="35"
      DESC="sysvinit is the parent process of all process.
Its primary role is to create processes from
a script stored in the file /etc/inittab.
This package also contains well known and used utilities like:
reboot, shutdown, killall, poweroff, tellinit, sulogin, wall, etc."

build() {
install_init() {
  mkdir   -p                                   /etc/init.d
  install -m 0600  $SCRIPT_DIR/inittab         /etc
  install -m 0700  $SCRIPT_DIR/prc             /etc/init.d
  install -m 0700  $SCRIPT_DIR/rcS             /etc/init.d
  install -m 0700  $SCRIPT_DIR/init.d/halt     /etc/init.d
  install -m 0700  $SCRIPT_DIR/init.d/kill     /etc/init.d
  install -m 0700  $SCRIPT_DIR/init.d/reboot   /etc/init.d
}

  if    !  grep  -q  "init.d/prc"   /etc/inittab  ||
        !  grep  -q  "si::sysinit"  /etc/inittab
  then
    cp              /etc/inittab  /etc/inittab.old

    echo      "sysvinit works slightly differently now on Sorcerer"
    echo      "Your current inittab will copied to /etc/inittab.old"
    echo      "/etc/inittab.old is not used, it is only for reference."
    sed   -i  "s:init.d/rc:init.d/prc:"        /etc/inittab
    grep  -q    "si::sysinit:/etc/init.d/rcS"  /etc/inittab  ||
    sed   -i  "2isi::sysinit:/etc/init.d/rcS"  /etc/inittab
    echo      "/etc/inittab modified"
  fi

  case $( arch ) in
   x86_64)
	sed  -i  's:/usr/lib/libcrypt.a:/usr/lib64/libcrypt.a:' src/Makefile
	;;
  esac 

  make  -C src                &&
  prepare_install             &&
  make  -C src  install       &&
                install_init  &&
  echo  "Please read:"        &&
  echo  "http://www.linuxbase.org/spec/refspecs/LSB_3.0.0/LSB-Core-generic/LSB-Core-generic/tocsysinit.html"
}

post_install() {
  [  -x  /usr/sbin/sorcerer.install  ]  ||  /sbin/init u
  /lib/lsb/install_initd /etc/init.d/reboot
}

current() {
  if  !  grep  -q  "linuxbase"  $COMPILE_LOGS/sysvinit
  then
    echo "sysvinit requires recast of sysvinit"  >  $CAST_QUEUE/sysvinit
    show_installed  |
    while  read  SPELL;  do
      if    [  -d  $GRIMOIRE/$SPELL.d/init.d  ]
      then  echo  "sysvinit requires recast of $SPELL"  >  $CAST_QUEUE/$SPELL
      fi
    done
  fi
  [  -f  /etc/init.d/kill  ]
}
