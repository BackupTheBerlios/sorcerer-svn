   VERSION=( "2.86" "2.85" "2.84" )
  CATEGORY="utility"
 ATTRIBUTE="console"
    SOURCE="sysvinit-$VERSION.tar.gz"
       URL="ftp://ftp.cistron.nl/pub/people/miquels/sysvinit/"
  HOMEPAGE="ftp://ftp.cistron.nl/pub/people/miquels/sysvinit/"
       REQ="init-functions"
   PROTECT="/etc/init.d/bootmisc"
  ESTIMATE="35"
      DESC="sysvinit is the parent process of all process.
Its primary role is to create processes from
a script stored in the file /etc/inittab.
This package also contains well known and used utilities like:
reboot, shutdown, killall, poweroff, tellinit, sulogin, wall, etc.
Before asking questions about how init scripts work please read:
http://www.linuxbase.org/spec/refspecs/LSB_3.0.0/LSB-Core-generic/LSB-Core-generic/tocsysinit.html"

build() {
install_init() {
  mkdir   -p                                   /etc/init.d
  install -m 0600  $SCRIPT_DIR/inittab         /etc
  install -m 0700  $SCRIPT_DIR/prc             /etc/init.d
  install -m 0700  $SCRIPT_DIR/rcS             /etc/init.d
  install -m 0700  $SCRIPT_DIR/init.d/halt     /etc/init.d
  install -m 0700  $SCRIPT_DIR/init.d/kill     /etc/init.d
  install -m 0700  $SCRIPT_DIR/init.d/reboot   /etc/init.d
  sed     -i       "s:ulimit :# ulimit :"  \
                   src/initscript.sample
  install -m 0700  src/initscript.sample       /etc
}

fix_inittab()  {
  if    !  grep  -q  "init.d/prc"   /etc/inittab  ||
        !  grep  -q  "si::sysinit"  /etc/inittab
  then
    cp              /etc/inittab  /etc/inittab.old

    echo      "sysvinit works slightly differently now on Sorcerer"
    echo      "Your current inittab will copied to /etc/inittab.old"
    echo      "/etc/inittab.old is not used, it is only for reference."
    sed   -i  "s:init.d/rc:init.d/prc:"        /etc/inittab
    grep  -q    "si::sysinit:/etc/init.d/rcS"  /etc/inittab  ||
    sed   -i  "2isi::sysinit:/etc/init.d/rcS"  /etc/inittab
    echo      "/etc/inittab modified"
  fi
}


  case $( arch ) in
   x86_64)  sed  -i  's:/usr/lib/libcrypt.a:/usr/lib64/libcrypt.a:' src/Makefile  ;;
  esac

  sed   -i "s:-O2 -fomit-frame-pointer:${CFLAGS}:" src/Makefile
  fix_inittab
  make  -C src                &&
  prepare_install             &&
  make  -C src  install       &&
                install_init
}

post_install() {
  [  -x  /usr/sbin/sorcerer.install  ]  ||  /sbin/init u
  /lib/lsb/install_initd /etc/init.d/reboot
}

current() {
  case  $VERSION  in
    2.8.6)  grep  -q  "6|0)   ssl"  /etc/init.d/prc  ;;
  esac
}
