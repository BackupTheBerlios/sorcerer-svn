# 0.6.x may have requirement on exiv2

    stable 0.6.4 0.6.3 0.5.10 0.5.7
   require bzip2 clucene-core cmake dbus exiv2 libxml2 zlib
  optional qt-everywhere-opensource '' '' for a graphical interface
  category utility/search
 attribute library
    source $SOURCEFORGE_URL strigi/strigi/strigi-$VERSION/strigi-$VERSION.tar.bz2
  homepage http://strigi.sourceforge.net/
#            'dbus:-DENABLE_DBUS:BOOL=ON:-DENABLE_DBUS:BOOL=OFF:for dbus support'
#            'log4cxx:-DENABLE_LOG4CXX:BOOL=ON:-DENABLE_LOG4CXX:BOOL=OFF:for advanced logging features'
# No tarball for log4cxx available as of 20080114
      opts -DCMAKE_INSTALL_PREFIX:PATH=/opt/kde4
      opts -DCMAKE_INSTALL_RPATH:PATH=/opt/kde4/lib:/opt/kde4/lib64
      opts -DCMAKE_SKIP_BUILD_RPATH:BOOL=TRUE
      opts -DCMAKE_BUILD_WITH_INSTALL_RPATH:BOOL=TRUE
      opts -DCMAKE_INSTALL_RPATH_USE_LINK_PATH:BOOL=TRUE
      opts -DCMAKE_BUILD_TYPE=Release
# case $HOSTTYPE in
#  x86_64) OPTS+=' -DLIB_DESTINATION=lib64' ;;
# esac
  estimate 1000
      desc 'strigi is a search engine'

build(){
 case $VERSION in
  0.5.7) sed -i '1i#include <cstdlib>' \
             tests/test_runner.cpp \
             src/luceneindexer/luceneindexer.cpp \
             tests/indextesters/indextest.cpp
         sed -i '1i#include <cstring>' \
             tests/streamanalyzer/xesam/xesam2strigitest.cpp
         ;;
 esac
 mkdir build
 cd    build
 cmake $OPTS ..  &&
 make            &&
 prepare_install &&
 make    install
}
