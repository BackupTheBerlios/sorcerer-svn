#!/bin/bash

### BEGIN INIT INFO
# Default-Mode: 700
# Required-Start: dmsetup lock sys
# Should-Start: mdadm udev multipathd vgscan
# Required-Stop: finale halt mdadm--assemble--scan mdadm--auto-detect reboot reboot-kexec
# Default-Start: S
# Default-Stop: 0 6
# Short-Description: vgchange activates logical volumes
### END INIT INFO

. /lib/lsb/init-functions

NAME=vgchange
OPTS='--ignorelockingfailure -ay'
SERV=/sbin/vgchange

start(){
 if   log_warning_msg "$NAME $OPTS"; $SERV $OPTS
 then log_success_msg "$NAME success"
 else log_failure_msg "$NAME failure"
 fi
}

stop(){
 OPTS='--ignorelockingfailure -an'
 [ -f /proc/mounts ] &&
 if   log_warning_msg "$NAME $OPTS"; $SERV $OPTS
 then log_success_msg "$NAME success"
 else log_failure_msg "$NAME failure"
 fi
}

help(){ echo "Usage: $0 {start}" 1>&2; }

case $1 in
       start) start ;;
        stop) stop  ;;
 try-restart) :     ;;
           *) help  ;;
esac
