#!/bin/bash

### BEGIN INIT INFO
# Default-Mode: 510
# Required-Start: proc sys
# Should-Start: udev
# Default-Start: 1 2 3 4 5
# Short-Description: Sets scaling_governor
# Configuration file is /etc/init.d/conf.d/cpufreq
# Define variables in configuration file.
# Available governors:
#   conservative ondemand performance powersave userspace
# Examples:
# DEFAULT="performance"
# USER="Yes"

# Modules for governors must load first.

# DEFAULT specifies the governor
# for all CPU cores to use during boot
# until the SA or user changes it.
# To switch governors type the module's name on a command line.
# Example:
# cpufreq_performance  # Maximum speed on all cores
# cpufreq_powersave    # Minimum speed on all cores

# If variable $USER is set
# then users also will be able to switch CPU frequency governors.

### END INIT INFO

. /lib/lsb/init-functions

if   [ -n "$USER" ]
then chmod 666 /sys/devices/system/cpu/cpu*/cpufreq/scaling_{governor,setspeed}
fi

if   [ -x             /bin/cpufreq_$DEFAULT ] &&
     log_warning_msg "/bin/cpufreq_$DEFAULT starting" &&
                      /bin/cpufreq_$DEFAULT
then log_success_msg "/bin/cpufreq_$DEFAULT started"
else log_failure_msg "/bin/cpufreq_$DEFAULT failed"
fi
