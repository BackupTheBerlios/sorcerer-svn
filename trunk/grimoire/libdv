# May have missing requirements of:
# libICE
# libSM
# libXt
# libXv
# nas

    stable 1.0.0
   require SDL pkgconfig popt
# optional gtk+-v1.2 '' --disable-gtk to use gtk for display
      opts --enable-static=no
  category video
 attribute x11 library
    source $SOURCEFORGE_URL libdv/libdv/$VERSION/libdv-$VERSION.tar.gz
  homepage http://libdv.sourceforge.net
  estimate 300
      desc 'Quasar DV, is a codec for DV video, used by mini-dv camcorders
libdv, the Quasar DV codec, is a software codec for DV video,
the encoding format used by most digital camcorders, typically
those that support the IEEE 1394 (FireWire or i.Link) interface.
Libdv was developed according to the official standards for DV
video: IEC 61834 and SMPTE 314M.'

build(){
 local SDL_CONFIG

 if   ! grep flags /proc/cpuinfo | grep -q mmx
 then  patch -p1 < $SCRIPT_DIR/libdv-mmx.patch
 else  patch -p1 < $SCRIPT_DIR/libdv-no-mmx.patch
 fi

 # --disable-xv \
 # --disable-gtk \
 # --disable-gtktest \

 if    [[ $HOSTTYPE == x86_64 ]]; then
  if   [[ $CFLAGS   =~ -m32   ]]
  then opts --x-libraries=/usr/lib   --host=${MACHTYPE/x86_64/i686}; export SDL_CONFIG==/usr/bin32/sdl-config
  else opts --x-libraries=/usr/lib64
  fi
 else  opts --x-libraries=/usr/lib
 fi

 sed -i 's,PATH="$prefix/bin:$prefix/usr/bin:$PATH",PATH="$PATH",' configure

 ./configure \
 --prefix=/usr \
 --enable-sdl \
 $OPTS &&
 make &&
 make install DESTDIR=$DESTDIR
}
