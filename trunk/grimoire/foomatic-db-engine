    stable 3.0.2 3.0.1 3.0.0
    secure 3.0.2
   require foomatic-filters libxml2
  optional cups              '' '' to install foomatic printer drivers for use with cups
  optional foomatic-db-hpijs '' '' for the HP HPIJS printers
  optional foomatic-db       '' '' for all printers
    ignore 'current\|rc\|^3\.0-20'
  category printer
 attribute console
    source http://www.openprinting.org/download/foomatic/foomatic-db-engine-$VERSION.tar.gz
  homepage http://www.linux-foundation.org/en/OpenPrinting/Database/Foomatic
  estimate 50
      desc 'foomatic-db-engine generates PPD files from the foomatic XML database.

foomatic-db-engine generates PPD files 
from the data in the Foomatic XML database.
It also contains scripts to directly 
generate print queues and handle jobs.'


build(){
 compiledb(){
  foomatic-compiledb

  echo 'gzip compressing ppd files'
  find ppd -type f | xargs --max-lines=1 gzip -1 -v

  CUPS_DATADIR=$( cups-config --datadir 2>/dev/null )
  CUPS_DATADIR=${CUPS_DATADIR:-/usr/share/cups}

  FPPD=/usr/share/foomatic/db/ppd
  CPPD=$CUPS_DATADIR/model

  echo  'Installing ppd files'
  cp    -av ppd $FPPD
  mkdir -vp           $CPPD
  ln    -sf     $FPPD $CPPD/foomatic
  echo  'Restart cups to select new printers.'
 }

 default_build &&
 compiledb
}
