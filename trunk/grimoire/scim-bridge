   VERSION=( 0.4.14 0.4.13 0.4.12 0.4.10 0.4.9 0.4.8 0.4.7 0.4.6 )
  CATEGORY='input'
 ATTRIBUTE='console library x11'
    SOURCE="scim/scim-bridge-$VERSION.tar.gz"
       URL="$SOURCEFORGE_URL"
  HOMEPAGE='http://www.scim-im.org/'
       REQ=( 'scim'
             'doxygen::--disable-documents:for documentation'
             'gtk+:--enable-gtk2-immodule:--disable-gtk2-immodule:to build gtk+ immodule'
             'qt-x11-opensource:--enable-qt4-immodule:--disable-qt4-immodule:to build a qt-x11-opensource immodule' )
#            'qt-x11-free:--enable-qt3-immodule:--disable-qt3-immodule:to build qt-x11-free immodule'
      OPTS='--enable-agent --disable-qt3-immodule --enable-static=no'
  ESTIMATE='600'
      DESC='scim-bridge is a wrapper for scim.
It avoids libstdc++ shared library loading problems
when using scim on programs that link with old libstdc++
such as precompiled binaries such as acroread.'

build(){
 extra_install(){
  ldconfig
  [ -x /usr/bin/gtk-query-immodules-2.0 ] &&
                gtk-query-immodules-2.0 > /etc/gtk-2.0/gtk.immodules
  mkdir   -p                              /etc/bash.d/noninteractive
  install -m 0755 $SCRIPT_DIR/scim-bridge /etc/bash.d/noninteractive
 }

 default_build &&
   extra_install
}


current(){
 case $VERSION in
  0.4.14)
   if     grep -qx qt-x11-free          $OPT_ON_LOGS/scim-bridge &&
        ! grep -qx qt-x11-opensource    $OPT_ON_LOGS/scim-bridge
   then echo       qt-x11-opensource >> $OPT_ON_LOGS/scim-bridge
   fi
   if   grep  -qx  qt-x11-opensource    $OPT_ON_LOGS/scim-bridge
   then [ -f  /usr/share/qt4/plugins/inputmethods/im-scim-bridge.so ]
   fi ;;
 esac
}
