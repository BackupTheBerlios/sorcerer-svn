   VERSION=( 5.6 5.5 5.4 )
  CATEGORY='development'
 ATTRIBUTE='console library solo'
    SOURCE="ncurses/ncurses-$VERSION.tar.gz"
  HOMEPAGE='http://www.gnu.org/software/ncurses/ncurses.html'
       URL="$GNU_URL"
       REQ='gawk'
      OPTS='--without-debug'
    CFLAGS='-O3'
   LDFLAGS='-Wl,-O1'
   PROTECT='/usr/share/terminfo'
  ESTIMATE='8760'
      DESC='ncurses displays and updates text on text-only terminals.
The ncurses (new curses) library is a free software
emulation of curses in System V Release 4.0 and more.
It uses terminfo format, supports pads and color
and multiple highlights and forms chracters and
function-key mapping, and has all the other
SYSV-curses enhancements over BSD curses.
The distribution includes the library and support
utilities, including a terminfo compiler tic,
a decompiler infocmp, clear, tput, tset,
and a termcap conversion tool captoinfo.'

build()  {
# Other sources configure scripts check only for 
# the location of ar libraries.
# Therefore, symbolic links to ELF libraries
# must exist in the same directory as the ar libraries
  move_ar_libs()  {
    mv  -v    $LIBDIR/lib{curses,form,formw,menu,menuw,ncurses++,ncurses++w,ncurses,ncursesw,panel,panelw}.a /usr$LIBDIR
    ln  -vfs  $LIBDIR/lib{curses,form,formw,menu,menuw,ncurses,ncursesw,panel,panelw}.so* /usr$LIBDIR
  }

  if    [ "$HOSTTYPE" == "x86_64" ]
  then  LIBDIR=/lib64
  else  LIBDIR=/lib
  fi

  case $VERSION in
   5.5) # Make sure shared libraries are mode 755
	sed -i "s:INSTALL_LIB=\"-m 644:INSTALL_LIB=\"-m 755:"  configure
	;;
  esac

  mkdir  -p  destdir/usr/{lib,share/tabset}

  ./configure        \
  --build=$BUILD     \
  --prefix=/usr      \
  --libdir=$LIBDIR   \
  --with-normal      \
  --with-shared      \
  --disable-termcap  \
  $OPTS              &&
  make               &&
  make    install    \
    DESTDIR=$PWD/destdir  &&
  make    clean      &&

  ./configure        \
  --build=$BUILD     \
  --prefix=/usr      \
  --libdir=$LIBDIR   \
  --with-normal      \
  --with-shared      \
  --disable-termcap  \
  --enable-widec     \
  $OPTS              &&
  make               &&
  prepare_install    &&
  cd      c++        &&
  make               &&
  prepare_install    &&  cp  -av  ../destdir/*  /  &&
  make    install    &&  cd       ..               &&
  make    install    &&
  move_ar_libs
}
