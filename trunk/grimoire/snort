# No rules provided inside the 2.6.0.
# This is not good to go following installation.
# Needs some rules and configuration file editing.
   VERSION=( "2.6.0" "2.4.4" "2.4.3" "2.4.2" "2.4.1" "2.4.0" )
    IGNORE="RC"
  CATEGORY="network security"
 ATTRIBUTE="console broken"
    SOURCE="snort-$VERSION.tar.gz"
       URL="http://www.snort.org/dl/current/"
  HOMEPAGE="http://www.snort.org/"
       REQ="libpcap pcre"
  ESTIMATE="2160"
      DESC="snort is a lightweight network intrustion detection program.
snort is a lightweight network intrusion detection system,
capable of performing real-time traffic analysis and packet
logging on IP networks.
It can perform protocol analysis, content searching/matching
and can be used to detect a variety of attacks and probes,
such as buffer overflows, stealth port scans, CGI attacks,
SMB probes, OS fingerprinting attempts, and much more.
Snort uses a flexible rule based language to describe traffic
that it should collect or pass, and a modular detection engine.
Snort has a real-time alerting capability, with alert mechanisms
for syslog, a user specified file, a UNIX socket, or WinPopup
messages to Windows clients using Samba's smbclient."

build() {
  install_etc()  {
    set    -x
    sed    -i        "s:../rules:/etc/snort/rules/:
                      s:/usr/local:/usr:"  etc/snort.conf
    mkdir  -p        {/etc,/var/log}/snort
    rm     -f        etc/Makefile*
    chown      0600  etc/*
    cp               etc/*  /etc/snort/
  }

  sed  -i  "s:/etc/snort.conf:/etc/snort/snort.conf:"  src/snort.c
  ./configure              \
  --build=$BUILD           \
  --prefix=/usr            \
  --sysconfdir=/etc/snort  \
  --localstatedir=/var     \
  --enable-dynamicplugin   \
  $OPTS                    &&
  make                     &&
  prepare_install          &&
  make    install          &&
          install_etc
}
