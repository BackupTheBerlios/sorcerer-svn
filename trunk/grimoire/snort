# No rules provided inside the 2.6.0.
# This is not good to go following installation.
# Needs some rules and configuration file editing.
   VERSION=( "2.8.0" "2.7.0.1" "2.7.0" "2.6.1.5" "2.6.1.4" "2.6.1.3" "2.6.1.2" "2.6.1" "2.6.0.2" "2.6.0.1" "2.6.0" "2.4.4" "2.4.3" "2.4.2" "2.4.1" "2.4.0" )
    IGNORE="RC\|beta\|rc"
  CATEGORY="network security"
 ATTRIBUTE="console"
    SOURCE="snort-$VERSION.tar.gz"
       URL="http://www.snort.org/dl/current/"
      VURL="http://www.snort.org/dl/"
  HOMEPAGE="http://www.snort.org/"
       REQ=( "init-functions libpcap pcre"
             "libprelude:--eanble-prelude:--disable-prelude:for prelude support" )
  ESTIMATE="1600"
      DESC="snort is a lightweight network intrustion detection program.
snort is a lightweight network intrusion detection system,
capable of performing real-time traffic analysis and packet
logging on IP networks.
It can perform protocol analysis, content searching/matching
and can be used to detect a variety of attacks and probes,
such as buffer overflows, stealth port scans, CGI attacks,
SMB probes, OS fingerprinting attempts, and much more.
Snort uses a flexible rule based language to describe traffic
that it should collect or pass, and a modular detection engine.
Snort has a real-time alerting capability, with alert mechanisms
for syslog, a user specified file, a UNIX socket, or WinPopup
messages to Windows clients using Samba's smbclient."

build() {
  install_etc()  {
    set    -x
    sed    -i        "s:../rules:/etc/snort/rules/:
                      s:/usr/local:/usr:"  etc/snort.conf
    mkdir  -p        {/etc,/var/log}/snort
    rm     -f        etc/Makefile*
    chown      0600  etc/*
    cp               etc/*  /etc/snort/
    set    +x
  }

  prelude_register()  {
    if     [  -x  /usr/bin/prelude-admin      ]  &&
        !  [  -d  /etc/prelude/profile/snort  ]
    then  prelude-admin register snort "idmef:w admin:r" localhost --uid 0 --gid 0
    fi
  }

  sed  -i  "s:/etc/snort.conf:/etc/snort/snort.conf:"  src/snort.c
  ./configure              \
  --build=$BUILD           \
  --prefix=/usr            \
  --sysconfdir=/etc/snort  \
  --localstatedir=/var     \
  --enable-dynamicplugin   \
  $OPTS                    &&
  make                     &&
  prepare_install          &&
  make    install          &&
          install_etc      &&
  prelude_register
}
