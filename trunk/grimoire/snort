   VERSION=( "2.4.2" "2.4.1" "2.4.0" "2.3.3" "2.3.2" "2.3.1" "2.3.0" "2.2.0" )
    IGNORE="RC"
  CATEGORY="network security"
 ATTRIBUTE="console old_init"
    SOURCE="snort-$VERSION.tar.gz"
       URL="http://www.snort.org/dl/current"
  HOMEPAGE="http://www.snort.org"
       REQ="libpcap pcre"
  ESTIMATE="365"
      DESC="snort is a lightweight network intrustion detection program.
snort is a lightweight network intrusion detection system,
capable of performing real-time traffic analysis and packet
logging on IP networks.
It can perform protocol analysis, content searching/matching
and can be used to detect a variety of attacks and probes,
such as buffer overflows, stealth port scans, CGI attacks,
SMB probes, OS fingerprinting attempts, and much more.
Snort uses a flexible rule based language to describe traffic
that it should collect or pass, and a modular detection engine.
Snort has a real-time alerting capability, with alert mechanisms
for syslog, a user specified file, a UNIX socket, or WinPopup
messages to Windows clients using Samba's smbclient."

build() {
  install_etc()  {
    set    -x
    sed    -i  "s:../rules:.:"   etc/snort.conf
    mkdir  -p                   /etc/snort  /var/log/snort
    cp     etc/*  rules/*       /etc/snort
    rm     -f                   /etc/snort/Makefile*
    chmod  0644                 /etc/snort/*
  }

  sed  -i  "s:/etc/snort.conf:/etc/snort/snort.conf:"  src/snort.c
  ./configure              \
  --build=$BUILD           \
  --prefix=/usr            \
  --sysconfdir=/etc/snort  \
  --localstatedir=/var     \
  $OPTS                    &&
  make                     &&
  prepare_install          &&
  make    install          &&
          install_etc
}
