# subversion can use neon or serf for making http requests.
# INSTALL file seems to recommends serf instead of neon.
# subversion hardcodes a rpath of /usr/lib and is mess of a source
# to look for a way to disable.

# subversion is multilib-fail because apr-util is also multilib-fail

   version stable 1.7.2 1.7.1 1.7.0 1.6.17
   require Imaging Python apr-util neon sqlite serf swig
#  require neon
# optional serf          --with-serf=/usr         '' for asynchronous HTTP access instead of using neon
  optional libgnome-keyring --with-gnome-keyring     '' for storing passwords in gnome keyring

# kdelibs-v4 causes recursive requirement phonon kdelibs-v4 subversion ffmpeg xine-lib
# optional kdelibs-v4    --with-kwallet=/opt/kde4 '' for storing passwords in kwallet

  optional openssl --with-ssl       ''                       for open SSL support
  optional httpd   --with-apxs      --disable-mod-activation for subversion apache httpd server module
# optional neon    --with-neon=/usr --without-neon           to allow http/https access of client

# kerberos5 and heimdal might not be supported anymore.
# optional heimdal ''               ''                       for kerberos support

# the follow causes selecting of incorrect bit libraries
#     opts --with-apr=/usr/bin --with-apr-util=/usr/bin --with-serf=/usr

      opts --disable-mod-activation --enable-static=no
  category development
 attribute console library perl-module python-module
 attribute multilib-fail
    source www.fightrice.com/mirrors/apache/subversion/subversion-$VERSION.tar.bz2
#   source http://subversion.tigris.org/downloads/subversion-$VERSION.tar.bz2
#   source http://subversion.tigris.org/downloads/subversion-deps-$VERSION.tar.bz2
      vurl 'http://subversion.tigris.org/servlets/ProjectDocumentList?folderID=260&expandFolder=74'
      info last 20111212
      info home http://subversion.apache.org/
#     info home http://subversion.tigris.org/
      desc 'version control system like cvs'

build(){
 svn-python-path(){
  PVER=$( installed_version $( get_provider Python ) )
  mkdir -p                   /usr/lib/python${PVER:0:3}/site-packages
  echo /usr/lib/svn-python > /usr/lib/python${PVER:0:3}/site-packages/subversion.pth
 }

 ./configure           \
 --prefix=/usr         \
 --sysconfdir=/etc     \
 --localstatedir=/var  \
 $OPTS                 &&
 make                  &&
 make  swig-py         &&
 make  swig-pl         &&
 make  install install-swig-py install-swig-pl DESTDIR=$DESTDIR &&
 svn-python-path
}
