# 0.62.0 has compile error
    latest 0.62.0 0.61.2
    stable 0.62.2 0.62.1 0.61.2 0.61.1 0.61.0 0.60.0
   require automake courier-authlib db docbook-xml-4.1.2 gamin gettext openjade pcre
  optional gnutls   '' ''               instead of openssl for pop3 and imaps
  optional ispell   '' --without-ispell for spell checking
  optional openldap '' ''               for ldap address book
  optional openssl  '' ''               for pop3s and imaps servers
  category network/email
 attribute client console server
       url $SOURCEFORGE_URL
    source courier/courier-$VERSION.tar.bz2
# May require client daemon support pop3 pop3s imap imaps, etc...
# added to courier.d/courier it's startup script.
  eprovide mail-transport-agent
   provide email-client pop3 pop3s imap imaps
  homepage http://www.courier-mta.org
  estimate 10600
      desc 'SMTP, IMAP, POP3, IMAPS, and POP3S servers
courier mail transfer agent (MTA) is an integrated
mail/groupware server based on open commodity protocols
such as ESMTP, IMAP, POP3, LDAP, SSL, and HTTP.
Courier provides ESMTP, IMAP, POP3, Webmail, and mailing
list services within a single consistent framework.
Individual components can be enabled or disabled at will.
Courier implements basic Web-based calendaring and scheduling
services integrated in the Webmail module.'

build(){
sed -i 's:rootcheck="$withval":rootcheck="$enableval":' configure

./configure                        \
--prefix=/usr                      \
--localstatedir=/var/state/courier \
--sysconfdir=/etc/courier          \
--disable-root-check               \
$OPTS                              &&
make                               &&
prepare_install                    &&
make    install                    &&
make    install-configure
}

post_install(){
 default_post_install
 makealiases
 makesmtpaccess
 makesmtpaccess-msa

 if    ! [ -d      /etc/skel/Maildir ]
 then  maildirmake /etc/skel/Maildir
 fi

 find /home -maxdepth 1 -mindepth 1 -type d |
 while read;  do
  if   ! [ -d        $WHO/Maildir ]
  then maildirmake   $WHO/Maildir
       chown -R $WHO $WHO/Maildir
  fi
 done

 if ! [  -f        /etc/courier/hosteddomains ]; then
  cp /etc/hostname /etc/courier/hosteddomains
                            makehosteddomains
 fi

 if [ -x /usr/bin/openssl ]; then
  if ! [ -f /usr/share/esmtpd.pem ]; then mkesmtpdcert; fi
  if ! [ -f /usr/share/pop3d.pem  ]; then mkpop3dcert;  fi
  if ! [ -f /usr/share/imapd.pem  ]; then mkimapdcert;  fi
 fi
}
