# gdm 2.22.0 is odd, not like gdm 2.20.6
# do not use 2.22.x gdm unless thoroughly tested first.
    stable 2.20.7 2.20.6 2.22.0 2.20.5 2.20.4 2.20.3 2.20.2 2.20.1 2.20.0
   require gnome-panel intltool libdmx libgnomeui libgsf librsvg libselinux gnome-doc-utils
  optional Linux-PAM    ''                        ''                     for pluggable authentication
  optional openssh      --enable-secureremote=yes ''                     for secure remote connection support
  optional tcp_wrappers --with-tcp-wrappers=yes   --with-tcp-wrappers=no to control allowed remote connections using tcp_wrappers
    ignore '^2\.21\.\|^2\.22\.0'
  category window-manager
 attribute gnome
       url $GNOME_URL
    source sources/gdm/${VERSION:0:4}/gdm-$VERSION.tar.bz2
  homepage http://www.gnome.org/projects/gdm/
      opts --enable-console-helper=no --enable-static=no
# no sorcerer support for consolehelper yet.
#            'libselinux:--with-selinux:--without-selinux:for selinux support'
  estimate 1700
 freshmeat gnomedisplaymanager
      desc 'gdm, Gnome Display Manager, is an improved xdm.
gdm the Gnome Display Manager is a re-implementation
of the well known xdm program.'

build(){
 if   spell_installed Linux-PAM; then SCHEME=pam
 elif spell_installed shadow;    then SCHEME=shadow
 else SCHEME=auto
 fi

 AUTH_SCHEME="--enable-authentication-scheme=$SCHEME"

mkdir    -pm 750 /var/gdm
groupadd -K GID_MIN=256 -K GID_MAX=511    gdm                 2>/dev/null
useradd  -K UID_MIN=256 -K UID_MAX=511 -g gdm -d /var/gdm gdm 2>/dev/null
chown    -R gdm:gdm /var/gdm

 ./configure          \
 --prefix=/usr        \
 --localstatedir=/var \
 --sysconfdir=/etc    \
 $OPTS                \
 $AUTH_SCHEME         &&
 make                 &&
 prepare_install      &&
 make    install
}
