   VERSION=( "2.18.2" "2.18.1" "2.18.0" "2.16.5" "2.16.4" )
    IGNORE="^2\.19\."
  CATEGORY="window-manager"
 ATTRIBUTE="gnome"
    SOURCE="sources/gdm/${VERSION%.*}/gdm-$VERSION.tar.bz2"
  HOMEPAGE="http://www.gnome.org/projects/gdm/"
       URL="$GNOME_URL"
       REQ=( "dbus bzip2 libdmx libgnomeui libgsf librsvg scrollkeeper gnome-doc-utils"
             "Linux-PAM:::for pluggable authentication"
             "libselinux:--with-selinux:--without-selinux:for selinux support"
             "openssh:--enable-secureremote=yes::for secure remote connection support:"
             "tcp_wrappers:--with-tcp-wrappers=yes:--with-tcp-wrappers=no:to control allowed remote connections using tcp_wrappers" )
      OPTS="--enable-console-helper=no"
# no sorcerer support for consolehelper yet.
  ESTIMATE="1940"
 FRESHMEAT="gnomedisplaymanager"
      DESC="gdm, Gnome Display Manager, is an improved xdm.
gdm the Gnome Display Manager is a re-implementation
of the well known xdm program."

build() {
  if    spell_installed  Linux-PAM;  then  SCHEME="pam"
  elif  spell_installed  shadow;     then  SCHEME="shadow"
  else  SCHEME="auto"
  fi

  AUTH_SCHEME="--enable-authentication-scheme=$SCHEME"

mkdir    -p -m 0750 /var/gdm
groupadd -K GID_MIN=256 -K GID_MAX=512    gdm                 2>/dev/null
useradd  -K UID_MIN=256 -K UID_MAX=512 -g gdm -d /var/gdm gdm 2>/dev/null
chown    -R gdm:gdm /var/gdm

  grep   -q  dbus-launch  config/Xsession.in  ||
  patch  -p1  <  $SCRIPT_DIR/gdm-2.16.1-dbus.patch

  ./configure           \
  --prefix=/usr         \
  --localstatedir=/var  \
  --sysconfdir=/etc     \
  $OPTS                 \
  $AUTH_SCHEME          &&
  make                  &&
  prepare_install       &&
  make    install
}

current()  {
  grep  -q  "\--exit-with-session"  /etc/gdm/Xsession
}
