# gdm 2.22.0 is odd, not like gdm 2.20.6
# do not use 2.22.x gdm unless thoroughly tested first.
   VERSION=( 2.20.6 2.22.0 2.20.5 2.20.4 2.20.3 2.20.2 2.20.1 2.20.0 )
    IGNORE='^2\.21\.'
  CATEGORY='window-manager'
 ATTRIBUTE='gnome'
    SOURCE="sources/gdm/${VERSION%.*}/gdm-$VERSION.tar.bz2"
  HOMEPAGE='http://www.gnome.org/projects/gdm/'
       URL="$GNOME_URL"
       REQ=( 'gnome-panel intltool libdmx libgnomeui libgsf librsvg libselinux gnome-doc-utils'
             'Linux-PAM:::for pluggable authentication'
             'openssh:--enable-secureremote=yes::for secure remote connection support:'
             'tcp_wrappers:--with-tcp-wrappers=yes:--with-tcp-wrappers=no:to control allowed remote connections using tcp_wrappers' )
      OPTS='--enable-console-helper=no --enable-static=no'
# no sorcerer support for consolehelper yet.
#            'libselinux:--with-selinux:--without-selinux:for selinux support'
  ESTIMATE='1700'
 FRESHMEAT='gnomedisplaymanager'
      DESC='gdm, Gnome Display Manager, is an improved xdm.
gdm the Gnome Display Manager is a re-implementation
of the well known xdm program.'

build(){
 if   spell_installed Linux-PAM; then SCHEME=pam
 elif spell_installed shadow;    then SCHEME=shadow
 else SCHEME=auto
 fi

 AUTH_SCHEME="--enable-authentication-scheme=$SCHEME"

mkdir    -pm 750 /var/gdm
groupadd -K GID_MIN=256 -K GID_MAX=511    gdm                 2>/dev/null
useradd  -K UID_MIN=256 -K UID_MAX=511 -g gdm -d /var/gdm gdm 2>/dev/null
chown    -R gdm:gdm /var/gdm


# Whoever added the lines below should case them with $VERSION
# When will the lines below become obsolete?
# -Kyle

 ./configure          \
 --prefix=/usr        \
 --localstatedir=/var \
 --sysconfdir=/etc    \
 $OPTS                \
 $AUTH_SCHEME         &&
 make                 &&
 prepare_install      &&
 make    install
}
