# added dialog as requirement due to potential password acquisition

    stable 1.0.6
  unstable 1.0.6-pre2
   require device-mapper dialog e2fsprogs gettext libgcrypt
  PVERSION=1.14
  category security/encryption
 attribute console
    source http://luks.endorphin.org/source/cryptsetup-$VERSION.tar.bz2
    source http://rpm5.org/files/popt/popt-$PVERSION.tar.gz
  homepage http://luks.endorphin.org/dm-crypt
      opts --sbindir=/sbin --libdir=/lib
case $HOSTTYPE in
 x86_64) OPTS+=64 ;;
esac
  estimate 300
      desc 'cryptsetup provides easily configured device level encryption.

To set up an encrypted block device see:
http://www.saout.de/tikiwiki/tiki-index.php?page=EncryptedDeviceUsingLUKS

cryptsetup is a tool for setting up encryption top of the device mapper.
Device-mapper is a new infrastructure in the Linux 2.6 kernel that
provides a generic way to create virtual layers of block devices that
can do different things on top of real block devices like striping,
concatenation, mirroring, snapshotting, etc.
dm-crypt is such a device-mapper target that provides transparent
encryption of block devices using the new Linux 2.6 cryptoapi.
The user can specify one of the symmetric ciphers,
a key (of any allowed size), an iv generation mode and then
he can create a new block device in /dev.
Writes to this device will be encrypted and reads decrypted.'

build(){
 cd popt-$PVERSION    &&
 ./configure          \
 --build=$BUILD       \
 --prefix=/usr        \
 --sysconfdir=/etc    \
 --localstatedir=/var \
 --enable-shared=no   &&
 make &&
 export LDFLAGS+=" -L$PWD/.libs" &&
 cd .. &&
 default_build
}

current(){
 case $VERSION in
  1.0.6) grep -qs by-uuid /etc/init.d/cryptsetup ;;
 esac
}
